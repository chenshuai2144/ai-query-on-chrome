# ğŸ› [BUG]umi4.xä¸‹é¢ é…ç½®å¤šç¯å¢ƒå˜é‡ æ‰“åŒ…æ¨¡å¼ä¸‹config.tså–çš„æ–‡ä»¶ä¸å¯¹

### ğŸ› bug æè¿°

<!--
è¯¦ç»†åœ°æè¿° bugï¼Œè®©å¤§å®¶éƒ½èƒ½ç†è§£
Describe the bug in detail so that everyone can understand it
-->

umi4.xä¸‹é¢ é…ç½®å¤šç¯å¢ƒå˜é‡ æ‰“åŒ…æ¨¡å¼ä¸‹config.tså–çš„æ–‡ä»¶ä¸å¯¹ã€‚npm run build:uat å–åˆ°äº†prodä¸‹é¢çš„é…ç½®ï¼ˆnpm run start:uatæ˜¯æ­£ç¡®çš„ï¼‰

### ğŸ’» å¤ç°ä»£ç  | Recurrence code

<!--
æä¾›å¯å¤ç°çš„ä»£ç ï¼Œä»“åº“ï¼Œæˆ–çº¿ä¸Šç¤ºä¾‹
Provide reproducible code, warehouse, or online examples
-->

    // package.json
     "start": "cross-env UMI_ENV=dev max dev",
      "start:dev": "cross-env REACT_APP_ENV=dev MOCK=none UMI_ENV=dev max dev",
      "start:uat": "cross-env REACT_APP_ENV=uat MOCK=none UMI_ENV=uat max dev",
      "start:prod": "cross-env REACT_APP_ENV=prod MOCK=none UMI_ENV=prod max dev",
      "build:dev": "cross-env REACT_APP_ENV=dev UMI_ENV=dev max build",
      "build:uat": "cross-env REACT_APP_ENV=uat UMI_ENV=uat max build",
      "build:prod": "cross-env REACT_APP_ENV=prod UMI_ENV=prod max build"

    // config.uat.ts
    import { defineConfig } from 'umi';

    export default defineConfig({
      define: {
        OSS_FILE_URL_PREFIX: 'OSS_FILE_URL_PREFIX',
        API_PREFIX: 'API_PREFIX',
      },
    });

### Â© ç‰ˆæœ¬ä¿¡æ¯

- Ant Design Pro ç‰ˆæœ¬: [e.g. 4.0.0] 6.0.0-beta.1
- umi ç‰ˆæœ¬ 4.x
- æµè§ˆå™¨ç¯å¢ƒ chrome
- å¼€å‘ç¯å¢ƒ [e.g. mac OS] mac and centos

### ğŸš‘ å…¶ä»–ä¿¡æ¯

<!--
å¦‚æˆªå›¾ç­‰å…¶ä»–ä¿¡æ¯å¯ä»¥è´´åœ¨è¿™é‡Œ
-->

ç¡®ä¿ uat å’Œ prod çš„ç¯å¢ƒå˜é‡ä¸ä¸€è‡´

## zhaojunpeng0425

ä¸è¦ç”¨æ­£å¸¸çš„dev,pre,prodç­‰å­—æ ·ï¼Œå¯ä»¥ä½¿ç”¨\_dev, \_test,\_preç­‰

## j511002

> ä¸è¦ç”¨æ­£å¸¸çš„dev,pre,prodç­‰å­—æ ·ï¼Œå¯ä»¥ä½¿ç”¨\_dev, \_test,\_preç­‰

å¯ä»¥ç»™ä¸€ä¸ªç¤ºä¾‹å—ï¼Ÿ

## chenshuai2144

`"start:dev": "cross-env REACT_APP_ENV=dev MOCK=none UMI_ENV=mydev max dev",`

ç„¶å // config.mydev.ts

## chentiewei

> `"start:dev": "cross-env REACT_APP_ENV=dev MOCK=none UMI_ENV=mydev max dev",`
>
> ç„¶å // config.mydev.ts

è¿™æ˜¯ä¸ºä»€ä¹ˆï¼Ÿ

## chenshuai2144

æ˜¯ umi çº¦å®šçš„ä¸€ä¸ªç¯å¢ƒå˜é‡ã€‚ç”¨æ¥è¯»å–é…ç½®æ–‡ä»¶

## chentiewei

emmm æˆ‘çš„æ„æ€æ˜¯ ä¸ºå•¥ ä¸€å®šè¦æ”¹åå­— è€Œä¸”æˆ‘ä¿®æ”¹äº†ä»¥å åœ¨ä½¿ç”¨buildçš„æ—¶å€™è¿˜æ˜¯æœ‰é—®é¢˜ã€‚

"build:dev": "cross-env REACT_APP_ENV=dev UMI_ENV=mydev max build",

æ‰“åŒ…çš„æ–‡ä»¶è¿˜æ˜¯ // config.prod.ts è€Œä¸æ˜¯æˆ‘é‡æ–°å‘½åçš„ // config.mydev.ts

## jintangWang

![image](https://user-images.githubusercontent.com/12557847/215302778-ca463ef6-9a7d-4e6a-b94b-2b720c04cc27.png)
æŒ‰ç…§ä¼˜å…ˆçº§æ¥çœ‹ï¼Œ`npm run build` ä¹‹åï¼Œä»¥ `config.prod.ts` çš„ä¼˜å…ˆçº§æœ€é«˜ï¼Œæ‰€ä»¥éœ€è¦æŠŠè¿™ä¸ªä¹Ÿæ”¹åã€‚è€Œæˆ‘ä»¬è‡ªå®šä¹‰çš„ç¯å¢ƒå˜é‡åä¼˜å…ˆçº§åœ¨ 2ï¼ˆå›¾ä¸­ç¬¬äºŒè¡Œï¼‰

## visla-perlin

è¿™è®¾è®¡çš„ä¼˜åŠ¿æ˜¯ä»€ä¹ˆï¼Ÿæ„Ÿè§‰å¸¦æ¥äº†å¾ˆå¤§çš„å›°æ‰°
