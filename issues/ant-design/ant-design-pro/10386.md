# ğŸ§[é—®é¢˜ | question] Protable reload æ— æ³•æ›´æ–°åˆ—è¡¨é¡¹ç›®

`AI Reply`

### ğŸ§ é—®é¢˜æè¿° | Problem description

ä½¿ç”¨ ref.current?.reloadï¼Œåˆ—è¡¨ä¸‹é¢çš„æ€»æ•°æˆåŠŸæ›´æ–°ï¼Œåˆ—è¡¨é¡¹ç›®æ²¡æœ‰å˜åŒ–ï¼Œ

### ğŸ’» ç¤ºä¾‹ä»£ç  | Sample code

```typescript
//export default TableList
const TableList: React.FC = () => {
    const ref = useRef<ActionType>();
    return(
        <PageContainer>
            <ProTable<API.RuleListItem>
                actionRef={ref}
                request={async (
                //   params: {
                //     pageSize?: number | undefined;
                //     current?: number | undefined;
                //     keyword?: string | undefined;
                //   },
                //   sort,
                //   filter,
                ) => {return Promise.resolve(await load_items());}
                }
            >
...

//load_items()
return ({
    success: true,
    data: tableListDataSource, //type: API.RuleListItem[]
    total: tableListDataSource.length,
  })
```

### ğŸš‘ å…¶ä»–ä¿¡æ¯ | Other information

![image](https://user-images.githubusercontent.com/101086473/203665061-765b6309-87f1-47e4-9930-1a1320de2bff.png)
reloadåtotalå¯ä»¥æ›´æ–°ï¼Œä½†dataæ²¡æœ‰å˜åŒ–

OS: Windows 11

Nodeï¼šv16.18.1

æµè§ˆå™¨ | browserï¼šEdge

## chenshuai2144

> TAutomatically replying with ChatGPT can be attempted, but it cannot be guaranteed to be completely accurate and may not fully address all issues. Please feel free to reply if you have any further questions or concerns.
> æ­¤å›å¤åŸºäº ChatGPT è‡ªåŠ¨ç”Ÿæˆï¼Œå¯ä»¥å°è¯•ä¸‹æ–¹æ¡ˆï¼Œå®˜æ–¹äººå‘˜ä¼šåœ¨ä¸€å®šæ—¶é—´åç»§ç»­ç»§ç»­å¤„ç†ã€‚

### âœ… è§£å†³æ–¹æ¡ˆ | Solution

çœ‹èµ·æ¥æ˜¯æ•°æ®æ²¡æœ‰æ›´æ–°ï¼Œæ ¹æ®ä»£ç ç¤ºä¾‹å¯ä»¥å‘ç°æ˜¯ `load_items` è¿”å›çš„æ•°æ®æ²¡æœ‰æ›´æ–°ï¼Œå¯¼è‡´åˆ—è¡¨æ•°æ®æ²¡æœ‰å˜åŒ–ã€‚å¯ä»¥å°† `load_items` æ”¹ä¸ºä¸€ä¸ªçŠ¶æ€ï¼Œç„¶ååœ¨éœ€è¦æ›´æ–°çš„æ—¶å€™ä¿®æ”¹è¯¥çŠ¶æ€å¹¶é‡æ–°æ¸²æŸ“ç»„ä»¶ã€‚

```typescript
const [tableData, setTableData] = useState<API.RuleListItem[]>([]);

const loadItems = async () => {
  const res = await load_items();
  setTableData(res.data);
  return {
    data: res.data,
    success: res.success,
    total: res.total,
  };
};

return (
    <PageContainer>
      <ProTable<API.RuleListItem>
        actionRef={ref}
        request={async () => loadItems()}
        dataSource={tableData}
        columns={columns}
      />
    </PageContainer>
);
```

å¦å¤–ï¼Œ`react` çš„ `useState` é’©å­ä¸ `Protable` çš„ `request` æ–¹æ³•æœ‰äº›å†²çªï¼Œå¯èƒ½ä¼šå¯¼è‡´æ•°æ®å¤šæ¬¡è¯·æ±‚ã€‚æ‰€ä»¥å¯ä»¥å°† `loadItems` å‡½æ•°é€šè¿‡ `useCallback` é’©å­è¿›è¡Œä¼˜åŒ–ï¼Œä½¿ç»„ä»¶ä¸­å…ˆå‰çš„çŠ¶æ€å’Œè¯¥é’©å­çš„å¼•ç”¨ä¿æŒä¸€è‡´ã€‚

```typescript
const loadItems = useCallback(async () => {
  const res = await load_items();
  setTableData(res.data);
  return {
    data: res.data,
    success: res.success,
    total: res.total,
  };
}, []);

return (
    <PageContainer>
      <ProTable<API.RuleListItem>
        actionRef={ref}
        request={() => loadItems()}
        dataSource={tableData}
        columns={columns}
      />
    </PageContainer>
);
```

å¦å¤–ï¼Œå¦‚æœä½ éœ€è¦è‡ªå®šä¹‰è¡¨æ ¼æ•°æ®å˜åŒ–çš„å›è°ƒå‡½æ•°ï¼Œå¯ä»¥ä½¿ç”¨ `onChange` å±æ€§è¿›è¡Œé…ç½®ï¼Œå‚è€ƒæ–‡æ¡£ï¼š[onChange | Protable](https://procomponents.ant.design/components/table/?category=v2-value#onChange)ã€‚
