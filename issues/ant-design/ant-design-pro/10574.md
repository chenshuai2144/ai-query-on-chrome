# ğŸ§[é—®é¢˜ | question] é€šè¿‡nginxé‡æ–°éƒ¨ç½²åï¼Œè®¿é—®ä¿®æ”¹è¿‡çš„è·¯ç”±æ–‡ä»¶ä¼šloadingï¼Œåˆ·æ–°åæ¢å¤æ­£å¸¸

`AI Reply`

ç‰ˆæœ¬ï¼šantdpro V5
é—®é¢˜ï¼š é…ç½®äº†hashï¼Œnginxä¹Ÿé…ç½®äº†ä¸ç¼“å­˜ï¼Œä½†æ˜¯è¿˜æ˜¯æœ‰é—®é¢˜
![image](https://user-images.githubusercontent.com/69189717/222354196-13b6ef30-4284-416e-8a9c-d8b87c34e069.png)
![image](https://user-images.githubusercontent.com/69189717/222354229-09cf97a5-958d-4a26-bb60-8d17adf808b8.png)

æŠ¥é”™ï¼šè¿™ç§æƒ…å†µæ—¶é‡åˆ°è¿‡ä¸¤ç§æŠ¥é”™

1. [@umijs/runtime] load component failed ChunkLoadError: Loading chunk ... failed.
2. Uncaught SyntaxError: Unexpected token '<'

è¯·é—®ä¸‹å¤§ä½¬æ€æ ·èƒ½è§£å†³

## chenshuai2144

> TAutomatically replying with ChatGPT can be attempted, but it cannot be guaranteed to be completely accurate and may not fully address all issues. Please feel free to reply if you have any further questions or concerns.
> æ­¤å›å¤åŸºäº ChatGPT è‡ªåŠ¨ç”Ÿæˆï¼Œå¯ä»¥å°è¯•ä¸‹æ–¹æ¡ˆï¼Œå®˜æ–¹äººå‘˜ä¼šåœ¨ä¸€å®šæ—¶é—´åç»§ç»­ç»§ç»­å¤„ç†ã€‚

é¦–å…ˆï¼Œè¿™ä¸ªé—®é¢˜å¹¶ä¸æ˜¯æ¶‰åŠåˆ°å…·ä½“çš„ React ç›¸å…³çš„é—®é¢˜ï¼Œè€Œæ˜¯ä¸ webpack æ‰“åŒ…å’Œ Nginx é…ç½®ç›¸å…³çš„é—®é¢˜ã€‚æ‰€ä»¥éœ€è¦ä½ æä¾›æ›´å¤šçš„é…ç½®ä¿¡æ¯æ‰èƒ½è¿›è¡Œé—®é¢˜è§£å†³ã€‚

æ ¹æ®ä½ æä¾›çš„é”™è¯¯ä¿¡æ¯ï¼Œç¬¬ä¸€ç§é”™è¯¯ `ChunkLoadError` å¯èƒ½æ˜¯ç”±äºå‰ç«¯èµ„æºæ²¡æœ‰æ­£ç¡®åœ°åŠ è½½ï¼Œå¯¼è‡´ chunk æ— æ³•æ­£ç¡®åŠ è½½é€ æˆçš„ï¼Œå¯èƒ½æ˜¯ç”±äºå‰ç«¯è·¯ç”±ä½¿ç”¨äº†æŒ‰éœ€åŠ è½½ï¼ˆåŠ¨æ€ importï¼‰çš„æ–¹å¼ï¼Œè€Œæ²¡æœ‰æ­£ç¡®åœ°é…ç½® webpack çš„ `output.publicPath` å­—æ®µï¼Œå¯¼è‡´ chunk åŠ è½½å¤±è´¥ã€‚

ä½ å¯ä»¥å°è¯•åœ¨ webpack é…ç½®æ–‡ä»¶ä¸­æ·»åŠ å¦‚ä¸‹ä»£ç ï¼š

```javascript
output: {
  publicPath: '/',
},
```

è¿™æ ·åšå¯ä»¥ç¡®ä¿ webpack åœ¨æŒ‰éœ€åŠ è½½ chunk çš„æ—¶å€™è·¯å¾„çš„æ­£ç¡®æ€§ã€‚åŒæ—¶ä¹Ÿéœ€è¦åœ¨ Nginx çš„é…ç½®æ–‡ä»¶ä¸­ï¼Œæ·»åŠ å¯¹åº”çš„ publicPathï¼Œä¾‹å¦‚ï¼š

```nginx
location / {
    root /path/to/project;
    index index.html;
}

location ~* \.(js|css|png|jpg|jpeg|gif|svg)$ {
    root /path/to/project/dist;
    expires 1d;
    access_log off;
    add_header Cache-Control "public, max-age=86400, immutable";
}
```

è¿™æ ·åšå¯ä»¥ç¡®ä¿æµè§ˆå™¨çš„ç¼“å­˜é—®é¢˜ï¼ŒåŒæ—¶ä¹Ÿå¯ä»¥å‡å°‘èµ„æºåŠ è½½æ—¶é—´ã€‚

å¦å¤–ï¼Œç¬¬äºŒä¸ªé”™è¯¯ `Uncaught SyntaxError: Unexpected token '<'` å¯èƒ½æ˜¯ç”±äºå‰ç«¯è·¯ç”±åˆ·æ–°åç›´æ¥è®¿é—®åˆ°äº† HTML æ–‡ä»¶è€Œé JavaScript æ–‡ä»¶ï¼Œå¯ä»¥åœ¨ Nginx çš„é…ç½®æ–‡ä»¶ä¸­æ·»åŠ å¦‚ä¸‹è§„åˆ™ï¼š

```nginx
location / {
    try_files $uri /index.html;
}
```

è¿™æ ·åšå¯ä»¥ç¡®ä¿æµè§ˆå™¨è®¿é—®ä»»ä½•è·¯å¾„æ—¶éƒ½æ˜¯è¿”å› index.html æ–‡ä»¶ï¼Œè€Œå‰ç«¯è·¯ç”±å¯ä»¥é€šè¿‡ history API æ¥æ§åˆ¶é¡µé¢çš„æ˜¾ç¤ºå’Œéšè—ã€‚

ç»¼ä¸Šæ‰€è¿°ï¼Œä½ éœ€è¦æ£€æŸ¥ webpack çš„é…ç½®æ˜¯å¦æ­£ç¡®ã€Nginx çš„é…ç½®æ˜¯å¦æ­£ç¡®ï¼Œå¹¶ä¸”å¯¹èµ„æºçš„ç¼“å­˜å’Œè·¯ç”±çš„é…ç½®è¿›è¡Œè¯¦ç»†åœ°æ£€æŸ¥å’Œè°ƒè¯•ã€‚
