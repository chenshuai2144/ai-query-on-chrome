# 🧐[问题 | question] ProTable的表单，怎么实现表单值改变就立即请求呢

`AI Reply`

### 🧐 问题描述 | Problem description

<!--
详细地描述问题，让大家都能理解
Describe the problem in detail so that everyone can understand it
-->

ProTable的表单，搜索中怎么实现选择类表单值改变就立即搜索呢

## YuDaChao

监听onValuesChange，手动触发formRef?.current?.submit();

## chenshuai2144

> TAutomatically replying with ChatGPT can be attempted, but it cannot be guaranteed to be completely accurate and may not fully address all issues. Please feel free to reply if you have any further questions or concerns.
> 此回复基于 ChatGPT 自动生成，可以尝试下方案，官方人员会在一定时间后继续继续处理。

### 💡 解决方案 | Solution

为了在选择类表单值改变时立即触发搜索，我们可以使用 Ant Design 中的 `Form` 组件提供的 `onValuesChange` 方法来监听表单值的改变，手动调用 `submit` 方法来触发搜索。

具体的代码实现如下：

```jsx
import React, { useRef } from "react";
import { Form, Input, Select, Button } from "antd";
import ProTable from "@ant-design/pro-table";

const { Option } = Select;

const columns = [
  {
    title: "序号",
    dataIndex: "index",
    valueType: "indexBorder",
  },
  {
    title: "名称",
    dataIndex: "name",
  },
  {
    title: "类型",
    dataIndex: "type",
  },
  {
    title: "状态",
    dataIndex: "status",
    valueEnum: {
      0: { text: "关闭", status: "Default" },
      1: { text: "运行中", status: "Processing" },
      2: { text: "已上线", status: "Success" },
      3: { text: "异常", status: "Error" },
    },
  },
];

const MyTable = () => {
  const formRef = useRef();

  const handleValuesChange = (changedValues, allValues) => {
    // 在此处手动触发搜索
    formRef?.current?.submit();
  };

  const onFinish = (values) => {
    console.log("onFinish", values);
  };

  return (
    <div>
      <Form
        ref={formRef}
        initialValues={{
          name: "",
          type: undefined,
          status: undefined,
        }}
        onFinish={onFinish}
        onValuesChange={handleValuesChange}
      >
        <Form.Item name="name" label="名称">
          <Input />
        </Form.Item>
        <Form.Item name="type" label="类型">
          <Select>
            <Option value={1}>类型1</Option>
            <Option value={2}>类型2</Option>
            <Option value={3}>类型3</Option>
          </Select>
        </Form.Item>
        <Form.Item name="status" label="状态">
          <Select>
            <Option value={0}>关闭</Option>
            <Option value={1}>运行中</Option>
            <Option value={2}>已上线</Option>
            <Option value={3}>异常</Option>
          </Select>
        </Form.Item>
        <Form.Item>
          <Button type="primary" htmlType="submit">
            搜索
          </Button>
        </Form.Item>
      </Form>
      <ProTable
        columns={columns}
        request={async (params) => {
          console.log("params", params);
          return {
            data: [
              { id: 1, name: "项目1", type: "类型1", status: 1 },
              { id: 2, name: "项目2", type: "类型2", status: 2 },
              { id: 3, name: "项目3", type: "类型3", status: 3 },
            ],
            success: true,
          };
        }}
        rowKey="id"
        search={false}
        pagination={{
          pageSize: 5,
        }}
      />
    </div>
  );
};

export default MyTable;
```

在上面的示例代码中，我们在 `Form` 组件中通过 `onValuesChange` 监听表单值的变化，然后在回调函数中手动触发 `submit` 方法来提交表单。同时，我们还通过 `request` 方法来模拟服务端数据请求，当表单提交时打印参数。用户可以根据自己的业务实现具体的数据请求。
