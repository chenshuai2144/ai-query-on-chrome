# ğŸ› [BUG]å¦‚ä½•åœ¨V5ç‰ˆæœ¬ä¸­ä½¿ç”¨è„šæ‰‹æ¶å†…ç½®lesså˜é‡?

`AI Reply`

### ğŸ› bug æè¿°

å¦‚[æ–‡æ¡£](https://pro.ant.design/zh-CN/docs/less#indexless-1)æ‰€è¿°, è¿™æ ·ä½¿ç”¨ä¼šæŠ¥å¦‚ä¸‹å¼‚å¸¸:

```
@import '~antd/es/style/themes/default.less';
^
Less resolver error:
'~antd/es/style/themes/default.less' wasn't found. Tried - D:\DeskTop\Work\xxx\src\pages\User\Login\~antd\es\style\themes\default.less,npm://~antd\es\style\themes\default.less,~antd\es\style\themes\default.less

Webpack resolver error details:
resolve '~antd/es/style/themes/default.less' in 'D:\DeskTop\Work\xxx\src\pages\User\Login'
  Parsed request is a module
  using description file: D:\DeskTop\Work\xxx\package.json (relative path: ./src/pages/User/Login)
    using description file: D:\DeskTop\Work\xxx\package.json (relative path: ./src/pages/User/Login/~antd/es/style/themes/default.less)
      no extension
        D:\DeskTop\Work\xxx\src\pages\User\Login\~antd\es\style\themes\default.less doesn't exist
      .less
        D:\DeskTop\Work\xxx\src\pages\User\Login\~antd\es\style\themes\default.less.less doesn't exist
      .css
        D:\DeskTop\Work\xxx\src\pages\User\Login\~antd\es\style\themes\default.less.css doesn't exist
      as directory
        D:\DeskTop\Work\xxx\src\pages\User\Login\~antd\es\style\themes\default.less doesn't exist
    resolve as module
      D:\DeskTop\Work\xxx\src\pages\User\Login\node_modules doesn't exist or is not a directory
      D:\DeskTop\Work\xxx\src\pages\User\node_modules doesn't exist or is not a directory
      D:\DeskTop\Work\xxx\src\pages\node_modules doesn't exist or is not a directory
      D:\DeskTop\Work\xxx\src\node_modules doesn't exist or is not a directory
      looking for modules in D:\DeskTop\Work\xxx\node_modules
        D:\DeskTop\Work\xxx\node_modules\~antd doesn't exist
      D:\DeskTop\Work\node_modules doesn't exist or is not a directory
      D:\DeskTop\node_modules doesn't exist or is not a directory
      D:\node_modules doesn't exist or is not a directory

Webpack resolver error missing:
undefined

      Error in D:\DeskTop\Work\xxx\src\pages\User\Login\index.less (line 1, column 0
```

ç»æŸ¥çœ‹`node_modules`ä¸‹æœªå‘ç°å¯¹åº”lessæ–‡ä»¶, **æ‰€ä»¥æ˜¯æ–‡æ¡£æ²¡æ›´æ–°???**
è¯¥å¦‚ä½•åœ¨V5ç‰ˆæœ¬ä¸­ä½¿ç”¨è„šæ‰‹æ¶å†…ç½®lesså˜é‡?

### ğŸ“· å¤ç°æ­¥éª¤ | Recurrence steps

- `npx @ant-design/pro-cli create myapp`, `yarn install`
- åœ¨ä»»ä¸€é¡µé¢å†…ä¾æ®[æ–‡æ¡£](https://pro.ant.design/zh-CN/docs/less#indexless-1)å¼•å…¥å†…ç½®less
- `yarn start`

### ğŸ æœŸæœ›ç»“æœ | Expected results

å¯ä»¥æ­£å¸¸ä½¿ç”¨å†…ç½®lesså˜é‡

### ğŸ’» å¤ç°ä»£ç  | Recurrence code

å¦‚ä¸Š

### Â© ç‰ˆæœ¬ä¿¡æ¯

- Ant Design Pro ç‰ˆæœ¬: v5
- umi ç‰ˆæœ¬: 4.0.52
- æµè§ˆå™¨ç¯å¢ƒ: chrome
- å¼€å‘ç¯å¢ƒ: windows 11

### ğŸš‘ å…¶ä»–ä¿¡æ¯

æ— 

## chenshuai2144

> TAutomatically replying with ChatGPT can be attempted, but it cannot be guaranteed to be completely accurate and may not fully address all issues. Please feel free to reply if you have any further questions or concerns.
> æ­¤å›å¤åŸºäº ChatGPT è‡ªåŠ¨ç”Ÿæˆï¼Œå¯ä»¥å°è¯•ä¸‹æ–¹æ¡ˆï¼Œå®˜æ–¹äººå‘˜ä¼šåœ¨ä¸€å®šæ—¶é—´åç»§ç»­ç»§ç»­å¤„ç†ã€‚

ä½ å¥½ï¼æ ¹æ®ä½ æä¾›çš„ä¿¡æ¯ï¼Œå¯èƒ½é—®é¢˜å‡ºåœ¨ä½ çš„`less`ç¼–è¯‘é…ç½®ä¸Šã€‚ä½ å¯ä»¥åœ¨`.umirc.ts`æˆ–è€…`config/config.ts`ä¸­æ‰¾åˆ°`less-loader`é…ç½®ï¼Œç„¶åæ·»åŠ `less`çš„`alias`æ˜ å°„ï¼Œè¿™æ ·åœ¨å¼•ç”¨çš„æ—¶å€™å°±å¯ä»¥æ‰¾åˆ°å¯¹åº”çš„æ–‡ä»¶äº†ã€‚ä¾‹å¦‚ï¼Œä¸‹é¢æ˜¯ä¸€ä¸ª`less-loader`çš„é…ç½®ç¤ºä¾‹ï¼š

```js
{
  loader: 'less-loader',
  options: {
    // æŒ‡å®šé¢å¤–çš„ less æ–‡ä»¶, é€šå¸¸æ˜¯ä¸€äº›å…¨å±€å˜é‡çš„å®šä¹‰æ–‡ä»¶
    // æ³¨æ„, è¿™é‡Œéœ€è¦ä½¿ç”¨æ­£ç¡®çš„ç›¸å¯¹è·¯å¾„, é…åˆ Webpack.ProvidePlugin ä½¿ç”¨å¯ä»¥å…¨åº”ç”¨ä¸­å¯¼å…¥
    additionalData: `@import "@/styles/global.less";`,
    // é€šè¿‡è®¾ç½®å…¨å±€å˜é‡å¯ä»¥ç›´æ¥åœ¨ less æ–‡ä»¶ä½¿ç”¨ $ æˆ–è€… @ ä¿®é¥°ç¬¦
    globalVars: {
      brand_primary: '#1DA57A',
      brand_primary_tap: '#1FA67A'
    },
    // alias æ˜ å°„, å®šä½ antd ä¸­çš„ less
    // é€šè¿‡è¿™ç§é…ç½®æ–¹å¼å¯ä»¥åœ¨é¡¹ç›®ä¸­åƒè¿™æ ·å¯¼å…¥æ ·å¼ @import '~antd/lib/button/style/index'
    // é¿å…äº† Webpack æ ‘æ‘‡é™¤äº†ä¸€äº›æ ·å¼ä¹‹ååœ¨ç¼–è¯‘æ—¶æ‰¾ä¸åˆ°å¯¹åº”çš„ less æ–‡ä»¶çš„é—®é¢˜
    // è¿™é‡Œçš„ '~' ç¬¦å·å°±æ„å‘³ç€ antd çš„ç›®å½•ä½ç½®
    alias: {
      '@ant-design/icons/lib/dist$': path.resolve(__dirname, '../src/styles/icons.js'),
      '@ant-design/icons/lib/dist/lib': path.resolve(__dirname, '../src/styles/custom-ant-icons.less'),
      '~antd': path.resolve(__dirname, '../../node_modules/antd')
    }
  }
},
```

å…¶ä¸­ï¼Œ`alias`éœ€è¦æ ¹æ®ä½ è‡ªå·±çš„é¡¹ç›®æƒ…å†µæ¥ä¿®æ”¹ã€‚å¦‚æœä½ çš„`less`æ–‡ä»¶å¼•å…¥çš„æ˜¯å®Œæ•´çš„`antd/es`è·¯å¾„ï¼Œä½ éœ€è¦åœ¨`alias`ä¸­æ·»åŠ å¯¹åº”è·¯å¾„çš„æ˜ å°„ã€‚ä¾‹å¦‚ï¼Œä½ åœ¨`less`æ–‡ä»¶ä¸­è¿™æ ·å¼•å…¥`default.less`:

```less
@import "~antd/es/style/themes/default.less";
```

é‚£ä¹ˆï¼Œå¯¹åº”çš„`alias`æ˜ å°„åº”è¯¥è¿™æ ·è®¾ç½®ï¼š

```js
alias: {
  // å…¶å®ƒæ˜ å°„
  '~antd': path.resolve(__dirname, '../../node_modules/antd'),
  // æ·»åŠ æ˜ å°„
  '~antd/es': path.resolve(__dirname, '../../node_modules/antd/es')
}
```

è¿™æ ·è®¾ç½®ä¹‹åï¼Œå°±å¯ä»¥æ­£ç¡®åœ°æ‰¾åˆ°å¯¹åº”çš„`less`æ–‡ä»¶äº†ã€‚åŒæ—¶ï¼Œä½ ä¹Ÿå¯ä»¥æ ¹æ®è‡ªå·±çš„ä¸šåŠ¡éœ€è¦è‡ªå·±å®šä¹‰ä¸€äº›`less`æ–‡ä»¶ï¼Œå¹¶å°†å…¶æ·»åŠ åˆ°`additionalData`é€‰é¡¹ä¸­ï¼Œæ¯”å¦‚ï¼š

```js
additionalData: `
  @import '@/styles/common.less';
  @import '@/styles/color.less';
  @import '@/styles/font.less';
`;
```

è¿™æ ·ä½ å°±å¯ä»¥åœ¨ä»»æ„åœ°æ–¹ç›´æ¥ä½¿ç”¨å®šä¹‰çš„å˜é‡ï¼Œè€Œä¸éœ€è¦å†æ¬¡å¼•å…¥`less`æ–‡ä»¶äº†ã€‚å¸Œæœ›å¯¹ä½ æœ‰æ‰€å¸®åŠ©ï¼

## renanwilliam

same issue here

## chenshuai2144

> TAutomatically replying with ChatGPT can be attempted, but it cannot be guaranteed to be completely accurate and may not fully address all issues. Please feel free to reply if you have any further questions or concerns.
> æ­¤å›å¤åŸºäº ChatGPT è‡ªåŠ¨ç”Ÿæˆï¼Œå¯ä»¥å°è¯•ä¸‹æ–¹æ¡ˆï¼Œå®˜æ–¹äººå‘˜ä¼šåœ¨ä¸€å®šæ—¶é—´åç»§ç»­ç»§ç»­å¤„ç†ã€‚

Hello, according to the information you provided, the issue is related to the built-in LESS variables in Ant Design Pro v5. As a GitHub issue assistant who can only handle frontend problems related to React, I assume that you are using React and the Ant Design Pro v5 in your project.

In order to use the built-in LESS variables in Ant Design Pro v5, you can import the LESS files from the `antd` package directly in the `less` file of your component. An example of importing the `default.less` file from the `antd` package is as follows:

```less
@import "~antd/dist/antd.less";
```

If you want to override some of the variables in the `antd.less` file, you can import your own LESS file that defines these variables after importing the `antd.less` file. An example of overriding the `@primary-color` variable is as follows:

```less
@import "~antd/dist/antd.less";
@import "./custom.less";

@primary-color: #d82b7b; // override the primary color
```

In this example, `custom.less` is a LESS file that defines variables.

Please note that you also need to configure the `less-loader` properly in your project to enable the compilation of the LESS files. You can add the `less-loader` to the Webpack configuration file of your project, and set the `modifyVars` or `javascriptEnabled` option of the `less-loader` according to your needs. An example of the Webpack configuration for the `less-loader` is as follows:

```js
{
  test: /\.less$/,
  use: [
    'style-loader',
    'css-loader',
    {
      loader: 'less-loader',
      options: {
        modifyVars: {
          'primary-color': '#d82b7b',  // override the primary color
        },
        javascriptEnabled: true,
      },
    },
  ],
},
```

In this example, the `modifyVars` option is used to override the `@primary-color` variable, and the `javascriptEnabled` option is set to `true` to allow JavaScript in the LESS files.

I hope this information can help you. If you have any further questions, please feel free to ask.

## chenshuai2144

look here

https://ant.design/docs/react/migration-v5-cn
