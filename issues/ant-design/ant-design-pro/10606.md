# 🐛 [BUG]菜单栏收缩异常

`AI Reply`

### 🐛 bug 描述

点击菜单栏偶尔无效
1、点击子菜单后，母菜单自动关闭，再次点击母菜单无法展开
2、比如其他（如订单）后，OA系统菜单就能恢复正常
![8](https://user-images.githubusercontent.com/56745493/224596833-583e5ae0-1eb8-46a3-b3e1-a2b68f486302.gif)
![7](https://user-images.githubusercontent.com/56745493/224596581-716a35d1-d3e4-43c8-8677-1cfc308a565c.gif)

### 💻 复现代码 | Recurrence code

```
export default [
  {
    path: '/welcome',
    name: '主页',
    icon: 'home',
    component: './Welcome',
  },
  {
    path: '/admin',
    name: 'admin',
    icon: 'crown',
    access: 'canAdmin',
    routes: [
      {
        path: '/admin',
        redirect: '/admin/sub-page',
      },
      {
        path: '/admin/sub-page',
        name: 'sub-page',
        component: './Admin',
      },
    ],
  },
  {
    // path: '/oa',
    name: 'oa系统',
    icon: 'crown',
    // flatMenu: true,
    routes: [
      {
        name: '用户',
        path: '/user',
        icon: 'idcard',
        layout: true,
        component: './User/UserList',
      },
      {
        name: '供应商',
        path: '/supplier',
        icon: 'shop',
        layout: true,
        component: './Supplier/SupplierList',
      },
      {
        name: '项目',
        path: '/project',
        icon: 'bank',
        layout: true,
        component: './Project/ProjectList',
      },
    ],
  },
  {
    name: '订单',
    path: '/order',
    icon: 'profile',
    layout: true,
    defaultOpen: true, // 默认展开子菜单
    component: './Order/OrderList',
  },
  {
    name: '材料合同',
    path: '/Contract',
    icon: 'wallet',
    layout: true,
    component: './Contract/ContractList',
  },
  {
    name: '材料汇总系统',
    path: '/material_all',
    icon: 'tool',
    layout: true,
    component: './Material/MaterialAll',
  },
  // https://v3.umijs.org/zh-CN/plugins/plugin-layout
  {
    path: '/order/:order_id/orderitems/',
    name: '材料单明细',
    icon: 'tool',
    layout: true,
    hideInMenu: true,
    component: './OrderItem/OrderItemList',
  },
  {
    path: '/contract/:contract_id/contractitems/',
    name: '合同明细',
    icon: 'tool',
    layout: true,
    hideInMenu: true,
    component: './ContractItem/ContractItemList',
  },
]

const Settings: ProLayoutProps & {
  pwa?: boolean;
  logo?: string;
} = {
  navTheme: 'light',
  // 拂晓蓝
  colorPrimary: '#1890ff',
  layout: 'side',
  contentWidth: 'Fluid',
  fixedHeader: false,
  fixSiderbar: true,
  pwa: true,
  colorWeak: false,
  splitMenus: false,
  title: '建筑材料管理平台',
  headerRender: false,
  logo: 'https://gw.alipayobjects.com/zos/rmsportal/KDpgvguMpGfqaHPjicRK.svg',
  iconfontUrl: '',
  menu: {
    locale: false,
  },
  token: {
    // 参见ts声明，demo 见文档，通过token 修改样式
    //https://procomponents.ant.design/components/layout#%E9%80%9A%E8%BF%87-token-%E4%BF%AE%E6%94%B9%E6%A0%B7%E5%BC%8F
  },
};

export default Settings;
```

### © 版本信息

"name": "ant-design-pro",
"version": "6.0.0",

## chenshuai2144

> TAutomatically replying with ChatGPT can be attempted, but it cannot be guaranteed to be completely accurate and may not fully address all issues. Please feel free to reply if you have any further questions or concerns.
> 此回复基于 ChatGPT 自动生成，可以尝试下方案，官方人员会在一定时间后继续继续处理。

Hi，感谢您的提问！

根据您的描述，可以尝试以下解决方案：

1. 检查代码中是否有重复的路由配置：在您的代码中，可以看到 `/admin` 路由地址中有两个子路由，其中一个是重定向到 `/admin/sub-page` 的，建议将其中一个删除，以避免可能的冲突。

2. 确保您在菜单栏中所使用的组件是 Ant Design Pro 中的 `<SiderMenu>` 组件。当然，您可以尝试更新 `@umijs/plugin-layout` 插件，并将 `splitMenus` 设置为 `true` 以启用新的菜单模式。

3. 尝试使用 `defaultOpen` 属性来设置子菜单是否默认展开，不需要使用 `defaultSelectedKeys` 属性。也就是说，不是通过设置默认选中的方式来展开菜单，而是通过设置默认展开子菜单来实现。

4. 检查您的依赖项版本是否正常。在 `ant-design-pro 6.0.0` 中，官方建议使用 `umi-plugin-antd-icon-config` 插件来配置 Ant Design 图标，如果您使用了其他方式，请尝试升级到该版本。

希望这些解决方案可以帮助您解决问题，尽可能地提供了各种解决方案，供您参考。同时，您也可以阅读 Ant Design Pro 官方文档以查找更多相关的信息与解决方案。

Best！
