# 🐛 [BUG]动态渲染Menu菜单总是默认选中最后一项且无法选择其他项

### 🐛 bug 描述

在app.tsx中layout对象里使用request获取到数据并渲染的菜单总是会默认选中菜单的最后一项，并触发两次onSelect事件。并且后续的onClick和onSelect事件都失效了。也无法再选中其他项菜单。

<!--
详细地描述 bug，让大家都能理解
-->

### 📷 复现步骤 | Recurrence steps

<!--
清晰描述复现步骤，让别人也能看到问题
Clearly describe the recurrence steps so that others can see the problem
-->

### 🏞 期望结果 | Expected results

<!--
描述你原本期望看到的结果
Describe what you expected to see
-->

### 💻 复现代码 | Recurrence code

//从服务器获取菜单数据
menu: {
// 每当 initialState?.currentUser?.userid 发生修改时重新执行 request
params: {
// userId: initialState
},
// eslint-disable-next-line @typescript-eslint/no-unused-vars
request: async (params: void, defaultMenuData: any) => {
const menus = await getMenuList().then((res: any) => {
return res.data.map((item: any) => {
subMenuArr.push(item.id)
return {
path: '/',
name: item.meta.title,
icon: React.createElement(allIcons['SettingOutlined']),
key: item.name + item.meta.title,
routes: item.children.map((element: any) => {
return {
// path: '/?path=' + element.fullUrl,
// path: 'https://procomponents.ant.design/components/layout',
path: '/',
name: element.meta.title,
key: element.name + element.meta.title,
};
}),
};
});
});
// initialState.currentUser 中包含了所有用户信息
setInitialState({ ...initialState, rootSubmenuKeys: subMenuArr })
return menus;
},
onClick: ({ item }: { item: any }) => {
console.log(item, 'item,选中菜单');
},
},

<!--
提供可复现的代码，仓库，或线上示例

-->

### © 版本信息

- Ant Design Pro 版本: 6.0.0
- umi 版本:4
- 浏览器环境:edge
- 开发环境 [e.g. windows 11]

### 🚑 其他信息

![1691131558272](https://github.com/ant-design/ant-design-pro/assets/77582948/9d53564c-9cb7-4877-9e88-21a77cadf8dd)
![1691131575108(1)](https://github.com/ant-design/ant-design-pro/assets/77582948/ac190f98-e2c1-4ed8-ba31-b0f3e17f9479)

<!--

-->
