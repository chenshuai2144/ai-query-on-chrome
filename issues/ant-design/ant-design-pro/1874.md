# antd pro 项目内嵌到 electron的简单实践

`🤩Discussion`

最近准备将antd pro的项目迁移到 electron，找了两天资料终于有点头绪。
一、首先你要有一个完整的antd pro的项目，然后进入项目目录安装依赖

```python
# 安装依赖包并运行
npm install -save electron
```

二、配置 main.js
项目根目录下面新建 main.js 文件

```python
// 引入electron并创建一个Browserwindow
const { app, BrowserWindow } = require('electron');
const path = require('path');
const url = require('url');

// 保持window对象的全局引用,避免JavaScript对象被垃圾回收时,窗口被自动关闭.
let mainWindow;

function createWindow() {
  // 创建浏览器窗口,宽高自定义具体大小你开心就好
  mainWindow = new BrowserWindow({ width: 800, height: 600 });

  // 加载应用 electron-quick-start中默认的加载入口
  // mainWindow.loadURL(
  //   url.format({
  //     pathname: path.join(__dirname, 'index.html'),
  //     protocol: 'file:',
  //     slashes: true,
  //   })
  // );

  // 加载应用 适用于 react 项目
  mainWindow.loadURL('http://localhost:8000/');

  // 打开开发者工具，默认不打开
  // mainWindow.webContents.openDevTools();

  // 关闭window时触发下列事件.
  mainWindow.on('closed', () => {
    mainWindow = null;
  });
}

// 当 Electron 完成初始化并准备创建浏览器窗口时调用此方法
app.on('ready', createWindow);

// 所有窗口关闭时退出应用.
app.on('window-all-closed', () => {
  // macOS中除非用户按下 `Cmd + Q` 显式退出,否则应用与菜单栏始终处于活动状态.
  if (process.platform !== 'darwin') {
    app.quit();
  }
});

app.on('activate', () => {
  // macOS中点击Dock图标时没有已打开的其余应用窗口时,则通常在应用中重建一个窗口
  if (mainWindow === null) {
    createWindow();
  }
});

// 你可以在这个脚本中续写或者使用require引入独立的js文件.

```

要注意“加载应用”这里你的端口号要一致。

三、配置你的 package.json ，添加以下项

```python
{
  "main": "main.js", // 配置启动文件
  "dependencies": {
    "electron": "^2.0.5"
  },
  "scripts": {
    "electron-start": "electron ." // 配置electron的start，区别于web端的start
  }
}
```

注意根据你自己原本的项目的基础上来配置。

四、还有重要的一点需要修改webpack
在antd pro我修改的是 .babelrc.js，添加 target: 'electron-renderer'。

以下是我的 .babelrc.js 配置

```python
module.exports = {
  target: 'electron-renderer',
  plugins: [
    [
      'babel-plugin-module-resolver',
      {
        alias: {
          components: './src/components',
        },
      },
    ],
  ],
};
```

注意根据你自己原本的项目的基础上来配置。

五、启动

```python
# 启动react项目
npm start

# 启动electron
npm run electron-start
```

以上内容参考自 [https://juejin.im/post/5a6a91276fb9a01cbd58ce32](https://juejin.im/post/5a6a91276fb9a01cbd58ce32)

欢迎关注我这个前端小菜的博客[一叶怀沙](http://yyhuaisha.github.io/)

后续还会更新关于打包的部分。

## mengdu

其实可以不用这么麻烦，封装一个electron架子，然后直接读http的页面就行，这方便更新
打个广告，这个是我之前做的electron架子 [vue-electron-chrome](https://github.com/mengdu/vue-electron-chrome)
![](https://github.com/mengdu/vue-electron-chrome/raw/master/20171218164524.png)

## chenshuai2144

可以在 site 写个文章，润色之后可以发到主站的

## pkaq

看来大家都有这种情结啊 doge
[http://pkaq.org/2018/02/09/electronbs/](http://pkaq.org/2018/02/09/electronbs/)

## yyhuaisha

[从antd-pro 迁移到 electron（2.打包篇）](https://zhuanlan.zhihu.com/p/41103887)

## zhfish

mark一下，持续关注

## heytheww

mark

## ShawLyon

> 最近准备将antd pro的项目迁移到 electron，找了两天资料终于有点头绪。
> 一、首先你要有一个完整的antd pro的项目，然后进入项目目录安装依赖
>
> ```python
> # 安装依赖包并运行
> npm install -save electron
> ```
>
> 二、配置 main.js
> 项目根目录下面新建 main.js 文件
>
> ```python
> // 引入electron并创建一个Browserwindow
> const { app, BrowserWindow } = require('electron');
> const path = require('path');
> const url = require('url');
>
> // 保持window对象的全局引用,避免JavaScript对象被垃圾回收时,窗口被自动关闭.
> let mainWindow;
>
> function createWindow() {
>   // 创建浏览器窗口,宽高自定义具体大小你开心就好
>   mainWindow = new BrowserWindow({ width: 800, height: 600 });
>
>   // 加载应用 electron-quick-start中默认的加载入口
>   // mainWindow.loadURL(
>   //   url.format({
>   //     pathname: path.join(__dirname, 'index.html'),
>   //     protocol: 'file:',
>   //     slashes: true,
>   //   })
>   // );
>
>   // 加载应用 适用于 react 项目
>   mainWindow.loadURL('http://localhost:8000/');
>
>   // 打开开发者工具，默认不打开
>   // mainWindow.webContents.openDevTools();
>
>   // 关闭window时触发下列事件.
>   mainWindow.on('closed', () => {
>     mainWindow = null;
>   });
> }
>
> // 当 Electron 完成初始化并准备创建浏览器窗口时调用此方法
> app.on('ready', createWindow);
>
> // 所有窗口关闭时退出应用.
> app.on('window-all-closed', () => {
>   // macOS中除非用户按下 `Cmd + Q` 显式退出,否则应用与菜单栏始终处于活动状态.
>   if (process.platform !== 'darwin') {
>     app.quit();
>   }
> });
>
> app.on('activate', () => {
>   // macOS中点击Dock图标时没有已打开的其余应用窗口时,则通常在应用中重建一个窗口
>   if (mainWindow === null) {
>     createWindow();
>   }
> });
>
> // 你可以在这个脚本中续写或者使用require引入独立的js文件.
> ```
>
> 要注意“加载应用”这里你的端口号要一致。
>
> 三、配置你的 package.json ，添加以下项
>
> ```python
> {
>   "main": "main.js", // 配置启动文件
>   "dependencies": {
>     "electron": "^2.0.5"
>   },
>   "scripts": {
>     "electron-start": "electron ." // 配置electron的start，区别于web端的start
>   }
> }
> ```
>
> 注意根据你自己原本的项目的基础上来配置。
>
> 四、还有重要的一点需要修改webpack
> 在antd pro我修改的是 .babelrc.js，添加 target: 'electron-renderer'。
>
> 以下是我的 .babelrc.js 配置
>
> ```python
> module.exports = {
>   target: 'electron-renderer',
>   plugins: [
>     [
>       'babel-plugin-module-resolver',
>       {
>         alias: {
>           components: './src/components',
>         },
>       },
>     ],
>   ],
> };
> ```
>
> 注意根据你自己原本的项目的基础上来配置。
>
> 五、启动
>
> ```python
> # 启动react项目
> npm start
>
> # 启动electron
> npm run electron-start
> ```
>
> 以上内容参考自 https://juejin.im/post/5a6a91276fb9a01cbd58ce32
>
> 欢迎关注我这个前端小菜的博客[一叶怀沙](http://yyhuaisha.github.io/)
>
> 后续还会更新关于打包的部分。

webpack 请问那段配置是干嘛的。我想在antd Pro里引入import ‘electron’，但打印出来是undefined

## spirobel

https://github.com/yaoleia/electron-umi-antd-pro
我还有找到这个https://github.com/BySlin/umi-plugin-electron-builder 刚在试试

## WangJM001

基于Umi的Electron框架，一行命令(pnpm create poros)生成Electron应用，快速开发、打包， 集成了各种功能，方便好用，感兴趣的可以看下，欢迎Star，项目还在不断迭代中。
https://github.com/porosjs/poros
