# 🐛[BUG] 菜单的高级用法中使用layoutActionRef 报错

### 🐛 bug 描述

在app.tsx中加入export const layoutActionRef = createRef<{ reload: () => void }>();会报错

### 📷 复现步骤

![image](https://user-images.githubusercontent.com/38587734/117434881-c7933780-af5f-11eb-8dfb-a0f1628fac22.png)

<!--
清晰描述复现步骤，让别人也能看到问题
-->

### 🏞 期望结果

<!--
描述你原本期望看到的结果
-->

### 💻 复现代码

<!--
提供可复现的代码，仓库，或线上示例
-->

### © 版本信息

- Ant Design Pro 版本: 5.0.0-beta.2
- umi 版本
- 浏览器环境
- 开发环境 [e.g. mac OS]

### 🚑 其他信息

<!--
如截图等其他信息可以贴在这里
-->

## chenshuai2144

app.tsx 好像不能随便 export

## qq329401134

> app.tsx 好像不能随便 export

文档上是那样用的，正确的方法应该是什么样子的呢，而且我发现layout->menu 的request中如果返回数组，登录成功后会调用一次request，如果返回一个promise的话登录成功后不会调用request，在request中打印的initialState的currentUser一直是undefined除非刷新页面

## chenshuai2144

@qq329401134 params 设置一下，params 修改就会触发request

`params={initialState}` 你可以这样设置一下

## chenshuai2144

可以更新依赖试试了

## qq329401134

> 可以更新依赖试试了

我新开了一个更详细的 劳烦看一下

## againF

umi4里面出现了同样的问题

## Fluox-Etine

> ###

这样设置有问题 params={initialState} 登录后重复请求；请求了2次。 无论 params={initialState} 还是 initialState?.currentUser?.user_id, 这样设置；退出的时候会在一次请求路由接口。请问这样如何解决呢
