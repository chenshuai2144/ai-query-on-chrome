# ğŸ§[é—®é¢˜] ä½¿ç”¨ request ç»Ÿä¸€é…ç½®é”™è¯¯å¤„ç†æ— æ•ˆã€‚

### ğŸ§ é—®é¢˜æè¿°

å°è¯•ä½¿ç”¨ æ¡†æ¶è‡ªå·±å¸¦çš„é”™è¯¯å¤„ç†ï¼Œä½†æ˜¯ä½¿ç”¨ useRequest æ—¶ï¼ŒæˆåŠŸå¯ä»¥è¿”å›æ•°æ®ï¼Œåå°è¿”å›é”™è¯¯æ—¶ï¼Œå‰ç«¯ä¸ä¼šæŠ¥é”™ã€‚

åå°è¿”å›çš„æ•°æ®å¦‚ä¸‹ï¼š

`{
    "success": false,
    "data": {},
    "errorMessage": "Parameters Error.",
    "showType": 1
}`

æ­¤æ—¶ useRequest æ²¡æœ‰è¿”å›é”™è¯¯ï¼Œè§¦å‘äº† onSuccess äº‹ä»¶ã€‚

ä½¿ç”¨é»˜è®¤é…ç½®ä¸æˆåŠŸåï¼Œå°è¯•ä½¿ç”¨è‡ªå®šä¹‰é…ç½®ï¼š
åœ¨ app.tsx ä¸­æ·»åŠ äº†å¦‚ä¸‹ä»£ç ï¼š, æ‹¦æˆªå™¨ä¸è‡ªå®šä¹‰çš„é”™è¯¯é…ç½®å‡ä¸ç”Ÿæ•ˆ,
å…³äºæ‹¦æˆªå™¨ï¼Œç½‘ä¸Šæœ‰äººå’Œæˆ‘ä¸€æ ·ï¼Œå¯å‚è€ƒ https://www.sunzhongwei.com/ant-design-pro-v5-using-umi-request-interceptor-for-request-header-and-jwt-token

æƒ³çŸ¥é“ app.tsx é™¤äº†ç›´æ¥å¯¼å‡º è¿˜éœ€è¦å¢åŠ å…¶ä»–é…ç½®å—ï¼Ÿ

```
const authHeaderInterceptor = (url: string, options: any) => {
  let token = localStorage.getItem('token');
  if (null === token) {
    token = '';
  }
  const authHeader = { Authorization: `Bearer ${token}` };
  return {
    url: url,
    options: { ...options, interceptors: true, headers: authHeader },
  };
};

export const request: RequestConfig = {
  timeout: 1000,
  errorConfig: {
    adaptor: (resData) => {
      console.log(resData)
      return {
        ...resData,
        success: resData.success,
        errorMessage: resData.errorMessage,
      };
    },
  },
  middlewares: [],
  requestInterceptors: [authHeaderInterceptor],
  responseInterceptors: [],
};



```

## FanNick

ç»è¿‡èƒ½æµ‹è¯•ï¼Œ å¦‚æœæˆ‘åœ¨ http è¿”å› 400 çš„é”™è¯¯ä¼šæç¤ºï¼Œä½†å¦‚æœåªæ˜¯ success = false ä¸ä¼šè§¦å‘é”™è¯¯äº‹ä»¶ã€‚

## sunzhongwei

è€å“¥ï¼Œä½ ç”¨äº†æˆ‘çš„é“¾æ¥ï¼Œå“ˆå“ˆ ğŸ˜‚

## FanNick

æˆ‘å‡çº§äº† 5.2 è¿™ä¸ªé—®é¢˜å°±è§£å†³äº†ã€‚ä½† defaultSetting åˆåŠ è½½ä¸äº†ã€‚

## chenshuai2144

defaultSetting çœ‹çœ‹æ˜¯ä¸æ˜¯ è·¯å¾„é”™äº†
