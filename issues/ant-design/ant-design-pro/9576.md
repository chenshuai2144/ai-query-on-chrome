# ğŸ§[é—®é¢˜] Productionç¯å¢ƒçš„API Base URLè®¾ç½®?

### ğŸ§ é—®é¢˜æè¿°

å¯èƒ½æ˜¯ä¸ªå¾ˆåŸºç¡€çš„é—®é¢˜ä½†æˆ‘çœŸçš„æ‰¾ä¸åˆ°è§£ç­”
è¯·é—®ä¸‹å„ä½ï¼Œæˆ‘çŸ¥é“å¼€å‘ç¯å¢ƒä¸‹çš„API Base URLå¯åœ¨proxy.jsä¸­è®¾ç½®
ä¸è¿‡è‹¥æ˜¯è¦åœ¨æ­£å¼ç¯å¢ƒä¸‹ç¼–è¯‘(yarn build/npm run build)ï¼Œå¹¶å°†APIçš„target base URLè®¾ç½®åœ¨å…¶ä»–å¤–éƒ¨æœåŠ¡å™¨ç­‰ä¸æœ¬ä¸“æ¡ˆä¸åŒçš„åœ°å€
æ˜¯å¦æœ‰åŠæ³•å¼ºåˆ¶è®©ä»–è½½å…¥proxy.jsçš„è®¾ç½®?
æˆ‘åœ¨å®˜æ–¹æ–‡æ¡£é‡Œæ²¡æœ‰æ‰¾åˆ°æ­£å¼ç¯å¢ƒä¸‹çš„API Base URLç¡®åˆ‡è®¾ç½®åœ¨å“ª
åªæœ‰æç¤ºè¯´æ­£å¼ç¯å¢ƒä¸ä¼šä½¿ç”¨proxy.jsçš„è®¾ç½®
ç½‘ä¸ŠæŸ¥äº†ä¸‹è²Œä¼¼å¯èƒ½æ˜¯åœ¨config/config.jsä¸­è®¾ç½®ï¼Œä½†æ²¡æœ‰æ‰¾åˆ°ç›¸å…³ç¤ºä¾‹æ‰€ä»¥ä¸æ˜¯å¾ˆç¡®å®š
çƒ¦è¯·å„ä½è§£æƒ‘äº†ï¼Œæ„Ÿæ¿€ä¸å°½

### ğŸ’» ç¤ºä¾‹ä»£ç 

ç•¥

### ğŸš‘ å…¶ä»–ä¿¡æ¯

ç•¥

## Kisky3

å¯ä»¥è¯•è¯•åˆ›å»º.envæ–‡ä»¶æ¥å®šä¹‰å„ä¸ªç¯å¢ƒçš„BASE URLè®¾ç½®/
ä½ å¿…é¡»ä»¥ REACT*APP* å¼€å¤´åˆ›å»ºè‡ªå®šä¹‰ç¯å¢ƒå˜é‡ã€‚

ä¾‹:
.env.production

```
REACT_APP_BASE_URL=$DOMAIN/bar
```

å‚è€ƒ:
https://www.html.cn/create-react-app/docs/adding-custom-environment-variables/#%E5%9C%A8-env-%E4%B8%AD%E6%B7%BB%E5%8A%A0%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F

## evolution9502

> å¯ä»¥è¯•è¯•åˆ›å»º.envæ–‡ä»¶æ¥å®šä¹‰å„ä¸ªç¯å¢ƒçš„BASE URLè®¾ç½®/ ä½ å¿…é¡»ä»¥ REACT*APP* å¼€å¤´åˆ›å»ºè‡ªå®šä¹‰ç¯å¢ƒå˜é‡ã€‚
>
> ä¾‹: .env.production
>
> ```
> REACT_APP_BASE_URL=$DOMAIN/bar
> ```
>
> å‚è€ƒ: https://www.html.cn/create-react-app/docs/adding-custom-environment-variables/#%E5%9C%A8-env-%E4%B8%AD%E6%B7%BB%E5%8A%A0%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F

æ‚¨å¥½ï¼Œ
é€™æ–¹æ³•æˆ‘è©¦éäº†ï¼Œåœ¨æ ¹ç›®éŒ„ä¸‹æ·»åŠ äº†.env.production æ–‡ä»¶
åœ¨è£¡é¢æ·»åŠ äº†REACT_APP_BASE_URL='https://APIåœ°å€'
ä½†è²Œä¼¼ä¾ç„¶æ²’æœ‰ç”¨
yarn buildå¾Œç¨‹åºä¸€æ¨£æ˜¯é€£åˆ°æœå‹™å™¨æœ¬åœ°çš„åœ°å€...

## chenshuai2144

https://umijs.org/zh-CN/docs/config#å¤šç¯å¢ƒå¤šä»½é…ç½®

çœ‹è¿™ä¸ª

## evolution9502

> [https://umijs.org/zh-CN/docs/config#å¤šç¯å¢ƒå¤šä»½é…ç½®](https://umijs.org/zh-CN/docs/config#%E5%A4%9A%E7%8E%AF%E5%A2%83%E5%A4%9A%E4%BB%BD%E9%85%8D%E7%BD%AE)
>
> çœ‹è¿™ä¸ª

é€™ç¯‡æ–‡æª”æˆ‘å…ˆå‰å°±çœ‹éäº†
å¯ä»¥å†è§£é‡‹å¾—æ¸…æ¥šäº›å—?
åƒæ˜¯base urlçš„åƒæ•¸æ˜¯ä»€éº¼ï¼Œæœƒè¢«ä»€éº¼è¨­å®šè¦†è“‹ç­‰ç­‰

## chenshuai2144

å¼€å‘ç¯å¢ƒæ˜¯é€šè¿‡porxyæ¥è®¾ç½®ã€‚

åœ¨çº¿ä¸Šç¯å¢ƒå¯ä»¥é€šè¿‡é…ç½®ã€‚baseurl æ¥è®¾ç½®çš„ã€‚ä¸åŒçš„ç¯å¢ƒé…ç½®ä¸åŒçš„urlï¼Œå†™æ­»åˆ°ä»£ç ä¸­ã€‚

å¦‚æœè¦åŠ¨æ€çš„ï¼Œé‚£å°±éœ€è¦ç½‘å…³çš„æ”¯æŒäº†

## derrickxiang

> å¼€å‘ç¯å¢ƒæ˜¯é€šè¿‡porxyæ¥è®¾ç½®ã€‚
>
> åœ¨çº¿ä¸Šç¯å¢ƒå¯ä»¥é€šè¿‡é…ç½®ã€‚baseurl æ¥è®¾ç½®çš„ã€‚ä¸åŒçš„ç¯å¢ƒé…ç½®ä¸åŒçš„urlï¼Œå†™æ­»åˆ°ä»£ç ä¸­ã€‚
>
> å¦‚æœè¦åŠ¨æ€çš„ï¼Œé‚£å°±éœ€è¦ç½‘å…³çš„æ”¯æŒäº†

æœ€è¿‘ä¹Ÿé‡åˆ°äº†åŒæ ·çš„é—®é¢˜ï¼Œæ€ä¹ˆéƒ¨ç½²åˆ°éæ ¹ç›®å½•ä¸‹é¢ï¼Œæˆ‘ä¹Ÿç ”ç©¶äº†[è¿™ä¸ªæ–‡æ¡£](https://pro.ant.design/zh-CN/docs/deploy/#%E9%83%A8%E7%BD%B2%E5%88%B0%E9%9D%9E%E6%A0%B9%E7%9B%AE%E5%BD%95)ï¼Œæ”¹äº†config.ts

`...
  base: '/s3app/',
  publicPath: '/s3app/',`
ç„¶åbuildï¼Œéƒ¨ç½²åä¸€ç›´ç¢°åˆ°/scripts/loading.jsæ‰¾ä¸åˆ°çš„é—®é¢˜ï¼Œæ£€æŸ¥distä¸‹çš„index.htmlï¼š
`
...

<link rel="stylesheet" href="/s3app/umi.043f10e7.css">
<script async="" src="/scripts/loading.js"></script>
</head>
<body>
<div id="root"></div>
<script src="/s3app/umi.14bfb194.js"></script>

</body></html>
`
åŸæ¥æ˜¯loading.jsæ²¡æœ‰è‡ªåŠ¨äº§ç”Ÿ/s3app/çš„è·¯å¾„ï¼Œè¿™ä¸ªæ˜¯å“ªé‡Œè¿˜éœ€è¦æ”¹é…ç½®ï¼Ÿ
å¦å¤–æˆ‘çš„apiæ˜¯åœ¨å¦å¤–ä¸€å°serverä¸Šï¼Œè¦æ€ä¹ˆåšæ•°æ®æµé…ç½®ï¼Ÿ
è°¢è°¢

## quocbang

> > å¼€å‘ç¯å¢ƒæ˜¯é€šè¿‡porxyæ¥è®¾ç½®ã€‚
> > åœ¨çº¿ä¸Šç¯å¢ƒå¯ä»¥é€šè¿‡é…ç½®ã€‚baseurl æ¥è®¾ç½®çš„ã€‚ä¸åŒçš„ç¯å¢ƒé…ç½®ä¸åŒçš„urlï¼Œå†™æ­»åˆ°ä»£ç ä¸­ã€‚
> > å¦‚æœè¦åŠ¨æ€çš„ï¼Œé‚£å°±éœ€è¦ç½‘å…³çš„æ”¯æŒäº†
>
> æœ€è¿‘ä¹Ÿé‡åˆ°äº†åŒæ ·çš„é—®é¢˜ï¼Œæ€ä¹ˆéƒ¨ç½²åˆ°éæ ¹ç›®å½•ä¸‹é¢ï¼Œæˆ‘ä¹Ÿç ”ç©¶äº†[è¿™ä¸ªæ–‡æ¡£](https://pro.ant.design/zh-CN/docs/deploy/#%E9%83%A8%E7%BD%B2%E5%88%B0%E9%9D%9E%E6%A0%B9%E7%9B%AE%E5%BD%95)ï¼Œæ”¹äº†config.ts
>
> `... base: '/s3app/', publicPath: '/s3app/',` ç„¶åbuildï¼Œéƒ¨ç½²åä¸€ç›´ç¢°åˆ°/scripts/loading.jsæ‰¾ä¸åˆ°çš„é—®é¢˜ï¼Œæ£€æŸ¥distä¸‹çš„index.htmlï¼š ` ...
>
> <script async="" src="/scripts/loading.js"></script>
> <script src="/s3app/umi.14bfb194.js"></script> ` åŸæ¥æ˜¯loading.jsæ²¡æœ‰è‡ªåŠ¨äº§ç”Ÿ/s3app/çš„è·¯å¾„ï¼Œè¿™ä¸ªæ˜¯å“ªé‡Œè¿˜éœ€è¦æ”¹é…ç½®ï¼Ÿ å¦å¤–æˆ‘çš„apiæ˜¯åœ¨å¦å¤–ä¸€å°serverä¸Šï¼Œè¦æ€ä¹ˆåšæ•°æ®æµé…ç½®ï¼Ÿ è°¢è°¢

same issue here
