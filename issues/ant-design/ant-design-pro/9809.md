# 🧐[问题] 动态菜单无法渲染菜单对应的组件

### 🧐 问题描述

组件路径是通过服务器返回的，在静态菜单里可以正常渲染：

```
{
        path: '/privilege/org',
        name: 'org',
        icon: 'smile',
        component: '@/pages/permission/org',
      }
```

现在所有的选项通过服务器返回，在app.ts文件里获取动态菜单数据：

```
menu: {
      // 每当 initialState?.currentUser?.userid 发生修改时重新执行 request
      params: {
        userId: initialState?.currentUser?.userId,
      },
      request: async (params, defaultMenuData) => {
        if(initialState&&initialState.currentUser){
          // fetch menu when having auth info to avoid the dead loop
          const menuData = await userMenuTree();
          debugger
          return menuData;
        }
      },
    },

```

动态菜单可以显示，现在遇到的问题是组件好像没有起作用，根据服务器返回的配置点击动态的菜单还是无法渲染对应的页面。还必须得在本地维护菜单路径才可以。这里就有2份，一份服务器返回，一份本地的路由包含所有菜单配置。有没有办法只使用服务端的？难道本地还要维护一份？这个是服务端返回的数据：

```
{
    "result": [
        {
            "id": 9,
            "name": "welcome",
            "res_type": 0,
            "created_time": 0,
            "updated_time": 0,
            "component": "./Welcome",
            "path": "/welcome",
            "parent_id": 5,
            "routes": []
        },
        {
            "id": 1,
            "name": "app",
            "res_type": 0,
            "created_time": 0,
            "updated_time": 0,
            "component": null,
            "path": "/app",
            "parent_id": 5,
            "routes": [
                {
                    "id": 13,
                    "name": "job",
                    "res_type": 0,
                    "created_time": 0,
                    "updated_time": 0,
                    "component": null,
                    "path": "/app/job",
                    "parent_id": 1,
                    "routes": [
                        {
                            "id": 14,
                            "name": "interview",
                            "res_type": 0,
                            "created_time": 0,
                            "updated_time": 0,
                            "component": null,
                            "path": "/app/job/interview",
                            "parent_id": 13,
                            "routes": []
                        }
                    ]
                },
                {
                    "id": 3,
                    "name": "cruise",
                    "res_type": 0,
                    "created_time": 0,
                    "updated_time": 0,
                    "component": null,
                    "path": "/app/cruise",
                    "parent_id": 1,
                    "routes": [
                        {
                            "id": 4,
                            "name": "channel",
                            "res_type": 0,
                            "created_time": 0,
                            "updated_time": 0,
                            "component": "./apps/cruise/channel",
                            "path": "/app/cruise/channel",
                            "parent_id": 3,
                            "routes": []
                        },
                        {
                            "id": 7,
                            "name": "article",
                            "res_type": 0,
                            "created_time": 0,
                            "updated_time": 0,
                            "component": "./apps/cruise/article",
                            "path": "/app/cruise/article",
                            "parent_id": 3,
                            "routes": []
                        }
                    ]
                },
                {
                    "id": 10,
                    "name": "overview",
                    "res_type": 0,
                    "created_time": 0,
                    "updated_time": 0,
                    "component": null,
                    "path": "/app/overview",
                    "parent_id": 1,
                    "routes": [
                        {
                            "id": 12,
                            "name": "list",
                            "res_type": 0,
                            "created_time": 0,
                            "updated_time": 0,
                            "component": "./apps/overview/app",
                            "path": "/app/overview/list",
                            "parent_id": 10,
                            "routes": []
                        },
                        {
                            "id": 11,
                            "name": "product",
                            "res_type": 0,
                            "created_time": 0,
                            "updated_time": 0,
                            "component": "./apps/overview/product",
                            "path": "/app/overview/product",
                            "parent_id": 10,
                            "routes": []
                        }
                    ]
                }
            ]
        },
        {
            "id": 16,
            "name": "me",
            "res_type": 0,
            "created_time": 0,
            "updated_time": 0,
            "component": null,
            "path": "/me",
            "parent_id": 5,
            "routes": [
                {
                    "id": 17,
                    "name": "profile",
                    "res_type": 0,
                    "created_time": 0,
                    "updated_time": 0,
                    "component": null,
                    "path": "/me/profile",
                    "parent_id": 16,
                    "routes": []
                },
                {
                    "id": 18,
                    "name": "password",
                    "res_type": 0,
                    "created_time": 0,
                    "updated_time": 0,
                    "component": "./me/password",
                    "path": "/me/password",
                    "parent_id": 16,
                    "routes": []
                }
            ]
        },
        {
            "id": 2,
            "name": "privilege",
            "res_type": 0,
            "created_time": 0,
            "updated_time": 0,
            "component": null,
            "path": "/privilege",
            "parent_id": 5,
            "routes": [
                {
                    "id": 15,
                    "name": "menu",
                    "res_type": 0,
                    "created_time": 0,
                    "updated_time": 0,
                    "component": "./permission/menu",
                    "path": "/privilege/menu",
                    "parent_id": 2,
                    "routes": []
                },
                {
                    "id": 19,
                    "name": "org",
                    "res_type": 0,
                    "created_time": 0,
                    "updated_time": 0,
                    "component": "@/pages/permission/org",
                    "path": "/privilege/org",
                    "parent_id": 2,
                    "routes": []
                },
                {
                    "id": 6,
                    "name": "role",
                    "res_type": 0,
                    "created_time": 0,
                    "updated_time": 0,
                    "component": "./permission/role",
                    "path": "/privilege/role",
                    "parent_id": 2,
                    "routes": []
                },
                {
                    "id": 8,
                    "name": "user",
                    "res_type": 0,
                    "created_time": 0,
                    "updated_time": 0,
                    "component": "./permission/user",
                    "path": "/privilege/user",
                    "parent_id": 2,
                    "routes": []
                }
            ]
        },
        {
            "id": 20,
            "name": "system",
            "res_type": 0,
            "created_time": 0,
            "updated_time": 0,
            "component": null,
            "path": "/system",
            "parent_id": 5,
            "routes": [
                {
                    "id": 21,
                    "name": "dict",
                    "res_type": 0,
                    "created_time": 0,
                    "updated_time": 0,
                    "component": "./system/dict",
                    "path": "/system/dict",
                    "parent_id": 20,
                    "routes": []
                }
            ]
        }
    ],
    "statusCode": "200",
    "resultCode": "200",
    "msg": "ok"
}

```

## jiangxiaoqiang

刚发现route路径和组件路径一致就可以渲染，还是会有问题。目前的解决方案是本地和服务器都定义菜单，本地定义一份所有的，服务端根据具体权限返回菜单。应该是获取菜单后要在root节点重新渲染。

## Thor-ChenBiao

同问

## shindouhiro

同问

## wenjianzhang

component 不支持动态加载的

## chenshuai2144

动态菜单和动态路由是两回事

## lcc908

> 动态菜单和动态路由是两回事

因为我本地也维护了一个全量的route，但后端数据里面没有的菜单路由，也能通过URL访问到，这个问题如何规避呢

## KYX1234

> > 动态菜单和动态路由是两回事
>
> 因为我本地也维护了一个全量的route，但后端数据里面没有的菜单路由，也能通过URL访问到，这个问题如何规避呢

页面切换的时判断你的menu里包含pathname不，还有可以在使用动态路由搞就是patchClientRoutes
