# onValuesChange æ”¶é›†åˆ°çš„æ•°æ®ä¸å‡†ç¡®

`ğŸ› Bug`

### Reproduction link

[![Edit on CodeSandbox](https://codesandbox.io/static/img/play-codesandbox.svg)](https://codesandbox.io/s/sad-flower-8jnwx6?file=/src/App.tsx)

### Steps to reproduce

ä½¿ç”¨ form.list ç»„ä»¶ï¼Œä½¿ç”¨ add æ–¹æ³•æ·»åŠ  2 ä¸ªå…ƒç´ ï¼Œåœ¨ä½¿ç”¨ remove æ–¹æ³•åˆ é™¤ 1 ä¸ªå…ƒç´ ï¼Œä½¿ç”¨ onValuesChange çš„ç¬¬äºŒä¸ªå‚æ•°æ”¶é›†æ•°æ®ï¼Œfields æ•°ç»„ä¾ç„¶å­˜åœ¨ 2 ä¸ªå…ƒç´ ï¼Œè¢«åˆ é™¤çš„å…ƒç´ åœ¨ fields çš„ä¸‹æ ‡ä½ç½®å­˜åœ¨ä¸º undefined

### What is expected?

æˆ‘ç†è§£çš„ onValuesChange ç¬¬äºŒä¸ªå‚æ•°æ”¶é›†æ•°æ®ï¼Œå¦‚å¤ç°æ­¥éª¤æ“ä½œï¼Œè¢«åˆ é™¤å…ƒç´ çš„åœ¨ onValuesChange æ”¶é›†åˆ°çš„æ•°æ®ä¸‹æ ‡ä¸­ä¸åº”è¯¥å­˜åœ¨ï¼Œ

### What is actually happening?

è¢«åˆ é™¤çš„å…ƒç´ åœ¨ fields çš„ä¸‹æ ‡ä½ç½®å­˜åœ¨ä¸º undefined

| Environment | Info   |
| ----------- | ------ |
| antd        | 5.1.2  |
| React       | 18     |
| System      | mac    |
| Browser     | chrome |

<!-- generated by ant-design-issue-helper. DO NOT REMOVE -->

## loo41

æˆ‘çœ‹äº†ä¸€ä¸‹ï¼Œæ„Ÿè§‰å¤§æ¦‚çš„æƒ…å†µæ˜¯è°ƒç”¨ remove ä¹‹å onVauleChange æ–¹æ³•è°ƒç”¨ä¹‹å‰æ²¡æœ‰æ‰§è¡Œ unRegisterFieldï¼Œå¯¼è‡´ this.fieldEntities è¿˜æ˜¯æœªç§»å‡ºå‰çš„æ•°æ®ï¼Œåªæœ‰å½“ componentWillUnmount å£°æ˜å‘¨æœŸèµ·ä½œç”¨çš„æ—¶å€™ this.fieldEntities æ‰æ˜¯æœ€æ–°çš„æ•°æ®ï¼Œæ‰€ä»¥ onVauleChange å’Œç›´æ¥è°ƒç”¨ getFieldsValue æ‹¿åˆ°çš„ç»“æœä¸ä¸€è‡´

## Ali-ovo

çœ‹äº†ä¸€ä¸‹è¿™ä¸ªç»„ä»¶çš„æºç å¼•ç”¨äº†rcçš„ rc-field-form ç»„ä»¶
æˆ‘è¦æ€ä¹ˆæ‰èƒ½å¸®å¿™ä¿®æ”¹rcçš„ç»„ä»¶å‘¢ï¼Œç›®å‰æ˜¯å‘ç°äº†åœ¨antdçš„æºç ä¸­è²Œä¼¼æ— æ³•ä¿®å¤è¿™ä¸ªbug

## yoyo837

PR å‘åˆ° `rc-field-form`, å…³è”æ­¤issueå³å¯

## Ali-ovo

> PR å‘åˆ° `rc-field-form`, å…³è”æ­¤issueå³å¯

åœ¨ `rc-field-form` é¡¹ç›®ä¸­ `å¤ç°è¯¥bug` ååˆ†å¤æ‚
å¤ç°è¯¥bug å¿…é¡»ä½¿ç”¨ Antd çš„ `Form.Item` è¿™ä¸ª åŒ…è£…çš„æ§ä»¶ çš„ **name å±æ€§** æ¥å˜æˆ **è¢«è¡¨å•æ§ä»¶æ‰€æ§åˆ¶çš„çŠ¶æ€**æ‰èƒ½å¤ç°
ä½†æ˜¯ `rc-field-form` å¹¶æ²¡æœ‰ `Form.Item` è¿™ä¸ªåŒ…è£…æ§ä»¶

## yoyo837

ä¸æ˜ç™½ä½ å•¥æ„æ€, ä½ å…ˆåˆ°ä¸Šæ¸¸æäº¤PR , å‘ç‰ˆæœ¬, ç„¶åå†æ¥antdæ”¹

## yoyo837

ä¸¤è¾¹éƒ½æ˜¯åŒä¸€ä¸ªå›¢é˜Ÿçš„ä»“åº“

## Ali-ovo

> ä¸æ˜ç™½ä½ å•¥æ„æ€, ä½ å…ˆåˆ°ä¸Šæ¸¸æäº¤PR , å‘ç‰ˆæœ¬, ç„¶åå†æ¥antdæ”¹

å°±æ˜¯åœ¨ `rc-field-form` è¿™ä¸ªåº“ä¸­æ— æ³•å¤ç°è¿™ä¸ªbugï¼Œ å› ä¸ºè¿™ä¸ªbugä¾èµ–äº† Antd çš„ `Form.Item` ç»„ä»¶æ‰å¯ä»¥å¤ç°
ä½†æ˜¯åœ¨ `rc-field-form` åº“ä¸­æ²¡æœ‰è¿™ä¸ªç»„ä»¶

## Francoshum95

> > ä¸æ˜ç™½ä½ å•¥æ„æ€, ä½ å…ˆåˆ°ä¸Šæ¸¸æäº¤PR , å‘ç‰ˆæœ¬, ç„¶åå†æ¥antdæ”¹
>
> å°±æ˜¯åœ¨ `rc-field-form` è¿™ä¸ªåº“ä¸­æ— æ³•å¤ç°è¿™ä¸ªbugï¼Œ å› ä¸ºè¿™ä¸ªbugä¾èµ–äº† Antd çš„ `Form.Item` ç»„ä»¶æ‰å¯ä»¥å¤ç° ä½†æ˜¯åœ¨ `rc-field-form` åº“ä¸­æ²¡æœ‰è¿™ä¸ªç»„ä»¶

You need to go to the [rc-field-form](https://github.com/react-component/field-form) repository, and find `src/List.tsx`. You can take a look at `const operations = {add: ..., remove: ...}`

## Ali-ovo

> > > ä¸æ˜ç™½ä½ å•¥æ„æ€, ä½ å…ˆåˆ°ä¸Šæ¸¸æäº¤PR , å‘ç‰ˆæœ¬, ç„¶åå†æ¥antdæ”¹
> >
> > å°±æ˜¯åœ¨ `rc-field-form` è¿™ä¸ªåº“ä¸­æ— æ³•å¤ç°è¿™ä¸ªbugï¼Œ å› ä¸ºè¿™ä¸ªbugä¾èµ–äº† Antd çš„ `Form.Item` ç»„ä»¶æ‰å¯ä»¥å¤ç° ä½†æ˜¯åœ¨ `rc-field-form` åº“ä¸­æ²¡æœ‰è¿™ä¸ªç»„ä»¶
>
> You need to go to the [rc-field-form](https://github.com/react-component/field-form) repository, and find `src/List.tsx`. You can take a look at `const operations = {add: ..., remove: ...}`

However, this bug can only be reoccurrence by relying on `Antd Input component `. Cant reoccurrence in `rc-field-form`

## kiner-tang

> > > > ä¸æ˜ç™½ä½ å•¥æ„æ€, ä½ å…ˆåˆ°ä¸Šæ¸¸æäº¤PR , å‘ç‰ˆæœ¬, ç„¶åå†æ¥antdæ”¹
> > >
> > > å°±æ˜¯åœ¨ `rc-field-form` è¿™ä¸ªåº“ä¸­æ— æ³•å¤ç°è¿™ä¸ªbugï¼Œ å› ä¸ºè¿™ä¸ªbugä¾èµ–äº† Antd çš„ `Form.Item` ç»„ä»¶æ‰å¯ä»¥å¤ç° ä½†æ˜¯åœ¨ `rc-field-form` åº“ä¸­æ²¡æœ‰è¿™ä¸ªç»„ä»¶
> >
> > You need to go to the [rc-field-form](https://github.com/react-component/field-form) repository, and find `src/List.tsx`. You can take a look at `const operations = {add: ..., remove: ...}`
>
> However, this bug can only be reoccurrence by relying on `Antd Input component `. Cant reoccurrence in `rc-field-form`

You can fork both of `antd` and `rc-field-form`,then fix this bug in `rc-field-form` and link it into `antd` to check it.
![image](https://user-images.githubusercontent.com/10286961/223894451-6d9dcaf1-6bda-4558-9fbd-32d75f765fcd.png)
![image](https://user-images.githubusercontent.com/10286961/223894473-d436857b-8e2f-4bb2-a610-1453a52de822.png)

## Ali-ovo

> > > > > ä¸æ˜ç™½ä½ å•¥æ„æ€, ä½ å…ˆåˆ°ä¸Šæ¸¸æäº¤PR , å‘ç‰ˆæœ¬, ç„¶åå†æ¥antdæ”¹
> > > >
> > > > å°±æ˜¯åœ¨ `rc-field-form` è¿™ä¸ªåº“ä¸­æ— æ³•å¤ç°è¿™ä¸ªbugï¼Œ å› ä¸ºè¿™ä¸ªbugä¾èµ–äº† Antd çš„ `Form.Item` ç»„ä»¶æ‰å¯ä»¥å¤ç° ä½†æ˜¯åœ¨ `rc-field-form` åº“ä¸­æ²¡æœ‰è¿™ä¸ªç»„ä»¶
> > >
> > > You need to go to the [rc-field-form](https://github.com/react-component/field-form) repository, and find `src/List.tsx`. You can take a look at `const operations = {add: ..., remove: ...}`
> >
> > However, this bug can only be reoccurrence by relying on `Antd Input component `. Cant reoccurrence in `rc-field-form`
>
> You can fork both of `antd` and `rc-field-form`,then fix this bug in `rc-field-form` and link it into `antd` to check it. ![image](https://user-images.githubusercontent.com/10286961/223894451-6d9dcaf1-6bda-4558-9fbd-32d75f765fcd.png) ![image](https://user-images.githubusercontent.com/10286961/223894473-d436857b-8e2f-4bb2-a610-1453a52de822.png)

Wow, amazing

## zombieJ

å‘ç°æ˜¯ field æ•°æ®æ²¡å¡«è¿›å»ï¼šhttps://codesandbox.io/s/floral-platform-zujs63
