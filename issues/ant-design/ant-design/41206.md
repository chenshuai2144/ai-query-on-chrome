# Argument appears to not be a ReactComponent. Keys: forceAlign,forcePopupAlign

`🤔 Need Reproduce`

### Reproduction link

[https://ant.design/](https://ant.design/)

### Steps to reproduce

1. Use <ProTable/>
2. Use latest version of antd

### What is expected?

Table should appear

### What is actually happening?

Table shows error message "Argument appears to not be a ReactComponent. Keys: forceAlign,forcePopupAlign"

![image](https://user-images.githubusercontent.com/96863959/224722431-53fdf697-836c-4925-8186-32a220fe8257.png)

| Environment | Info   |
| ----------- | ------ |
| antd        | 5.3.1  |
| React       | 17.0.2 |
| System      | macOS  |
| Browser     | Chrome |

<!-- generated by ant-design-issue-helper. DO NOT REMOVE -->

## kiner-tang

@fitterfizzle I can't reproduce this problem in Ant Design website. Can you provide a detailed reenactment procedure or record a video?

## fitterfizzle

Sure thing here it is

https://user-images.githubusercontent.com/96863959/224733851-dbf79d7d-f575-42f7-a143-1f8689873ece.mp4

## kiner-tang

> Sure thing here it is

Can you provide the link which you reproduce?

## fitterfizzle

> > Sure thing here it is
>
> Can you provide the link which you reproduce?

I am not allowed to share the source code. I can try and see if a codesandbox is able to reproduce it. As additional info everything was working until 5.3.0, if I downgrade to 5.2.3 then everything works again. Does this help?

## fitterfizzle

Maybe this is also helpful

![image](https://user-images.githubusercontent.com/96863959/224745085-2642c64b-c84f-403c-a3f3-66095b0639f2.png)

## kiner-tang

> I am not allowed to share the source code. I can try and see if a codesandbox is able to reproduce it. As additional info everything was working until 5.3.0, if I downgrade to 5.2.3 then everything works again. Does this help?

Thanks, If it is convenient, please provide the link for codesandbox to reproduce

## fitterfizzle

I even tried rendering only the <ProTable/> component in my environment top level at index.js level and the problem still appears. Here a more detailed `console.error`

![image](https://user-images.githubusercontent.com/96863959/224953941-ab73507f-1d24-4b71-a81a-bc7fa2b04de3.png)

## deng-yc

same problem

## deng-yc

使用了ProTable 会上面的错误
设置options={{ setting:false }} 正常显示

```
<ProTable
            size="small"
            options={{
              setting: false,
            }}
          />
```

## fitterfizzle

> 使用了ProTable 会上面的错误 设置options={{ setting:false }} 正常显示
>
> ```
> <ProTable
>             size="small"
>             options={{
>               setting: false,
>             }}
>           />
> ```

I can confirm that using the `options={{setting:false}}` indeed renders the table normally. However this completely removes the custom hide/unhide and reorder functionality of `<ProTable/>` which is a no go

## kiner-tang

Hello @fitterfizzle. Please provide a online reproduction by forking codesandbox of [antd@5.x](https://u.ant.design/codesandbox-repro) or [antd@4.x](https://u.ant.design/codesandbox-repro-4x), or provide a minimal GitHub repository.

## fitterfizzle

> Hello @fitterfizzle. Please provide a online reproduction by forking codesandbox of [antd@5.x](https://u.ant.design/codesandbox-repro) or [antd@4.x](https://u.ant.design/codesandbox-repro-4x), or provide a minimal GitHub repository.

I can't reproduce it on sandbox, but as said both by me and by @deng-yc this is happening in both of our environments. As @deng-yc mentioned the problem is disappearing if you disable the settings of `<ProTable/>` so it has to do something with that.

## fitterfizzle

Any news?

## afc163

A reproduce is needed.

## askurat

I can confirm this is also happening to me. I have tried reproducing in a sandbox but can't seem to produce the error.

## fitterfizzle

We are reverting back to `v5.2.3` until this issue gets fixed, `v5.3.0` and above are unusable and unstable for a major version

## hbatalhaStch

I just ran into this issue but I reverted back to `v5.2.3` and updated again to `v5.3.1` and now it is working as expected. I have no idea what just happened. I am just hoping this is not a bug that will creep up on me when I am least expecting.

## fitterfizzle

> I just ran into this issue but I reverted back to `v5.2.3` and updated again to `v5.3.1` and now it is working as expected. I have no idea what just happened. I am just hoping this is not a bug that will creep up on me when I am least expecting.

If you do a clean install of `v5.3.1` and `npm run start` the problem will still be there...

## hbatalhaStch

> If you do a clean install of v5.3.1 and npm run start the problem will still be there...

That is what I did after commenting but still worked as expected. Tbh idk what is happening, I can confirm that this issue happened but now I can't reproduce it (using the same exact code).

## askurat

We reverted back to `v5.2.3` as well. Reverting and upgrading back to `v5.3.1` did not work.

I did also notice the issue seems to be related to `Popconfirm` and /or `Tooltip`. I am using Popconfirm in a few places and the component would work if I removed it. The same would happen with `ProTable`, if I set `options={false}` the component would load fine.

## hbatalhaStch

I just tested in another computer and it gave me the same error, so I deleted the whole `node_modules` folder and ran `npm i` and it worked.

In my case the problem arose when I was using `Popover` .

## hooliy

  <img width="634" alt="image" src="https://user-images.githubusercontent.com/3368691/225825131-75bd9369-d891-4bba-a68e-a3cc81731818.png">
同样的问题，升级到最新版后，不管怎么降级都会一直报错，删除 node_modules 再重新 yarn 同样报错！

## afc163

> 同样的问题，升级到最新版后，不管怎么降级都会一直报错，删除 node_modules 再重新 yarn 同样报错！

@hooliy 试试删除 yarn.lock 和 package-lock.json 后重装。

## hooliy

> > 同样的问题，升级到最新版后，不管怎么降级都会一直报错，删除 node_modules 再重新 yarn 同样报错！
>
> @hooliy 试试删除 yarn.lock 和 package-lock.json 后重装。

3Q！多谢解决了我的问题，要不又要肝到半夜了！

## xuqiang1227

删除 yarn.lock 后执行yarn install 报错：

```
Cannot find module 'antd/dist/theme'
```

reset yarn.lock 后。
设置：

```
options={{ setting: false }}
```

就可以了

## askurat

While deleting node_modules and package-lock.json/yarn.lock did seem to resolve the issue, I ran into issues where tooltips/popovers were very inconsistent. Sometimes they would work, sometimes not. They would also stay on the screen after the mouse moved away. I couldn't click on buttons I had wrapped in a tooltip either.

For know I will stick with `5.2.3` until this is resolved.

## TdyP

I encountered the same error using `Popconfirm` on v5.3.2.
Rolling back to 5.2.3 solved it.

Unfortunately I'm not able to reproduce it in a simple codesandbox.
Anyone having the same issue with more clues about the origin?

## xuqiang1227

@afc163 @zombieJ
我这个问题我尝试在codesandbox，都没办法复现，但是本地依然存在问题。
尝试debug了一下发现在 `resize-observer` 工程中的 `src\SingleObserver\index.tsx` 文件里第42行的 `getDom`方法中：

```
  const getDom = () =>
    findDOMNode<HTMLElement>(elementRef.current) || findDOMNode<HTMLElement>(wrapperRef.current);
```

当这个问题出现时：`elementRef.current` 的 值为：

```
{
   forceAlign: () => {},
   forcePopupAlign: () => {}
}
```

![image](https://user-images.githubusercontent.com/4525647/227862924-ee36f053-f036-48ba-91e4-1cf8aaea05b3.png)

该值应该为antd 中 `ant-design\components\tooltip\index.tsx` 第221行定义的 ref。
所以麻烦再review一下这里的代码，看看是否存在bug。

## GirlGlitter

in version 5.5.1, i also encountered the same issue
