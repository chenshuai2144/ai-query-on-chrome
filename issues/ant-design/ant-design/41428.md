# Shadow DOM ä¸‹ Popconfirm ç»„ä»¶æ— æ³•æ­£å¸¸å·¥ä½œ

`ğŸ› Bug`,`ğŸ‘·ğŸ»â€â™‚ï¸ Someone working on it`

### Reproduction link

[![Edit on CodeSandbox](https://codesandbox.io/static/img/play-codesandbox.svg)](https://codesandbox.io/s/ji-ben-antd-5-3-2-forked-tjow71?file=/index.tsx)

### Steps to reproduce

æ‰“å¼€åç›´æ¥ç‚¹å‡»æŒ‰é’®å³å¯å¤ç°

### What is expected?

æ­£å¸¸æ‰“å¼€å¼¹çª—

### What is actually happening?

æ‰“ä¸å¼€ï¼Œæ‰“å¼€ç«‹å³è‡ªåŠ¨å…³é—­äº†

| Environment | Info                  |
| ----------- | --------------------- |
| antd        | 5.3.2                 |
| React       | 18                    |
| System      | mac m1                |
| Browser     | chrome 111.0.5563.110 |

<!-- generated by ant-design-issue-helper. DO NOT REMOVE -->

## hewenguang

æˆ‘å¼€å‘çš„æ‰©å±• Circle é˜…è¯»åŠ©æ‰‹å°±æ˜¯åŸºäº antd ç»„ä»¶çš„ï¼Œè¿‘æœŸæ³¨æ„åˆ°å¯ä»¥å‡çº§åˆ° antd v5ï¼ŒæŒ‰ç…§æ•™ç¨‹é¡ºåˆ©å‡çº§ã€‚å½“æµ‹è¯• Popconfirm ç»„ä»¶æ—¶å‘ç°æœ‰é—®é¢˜ã€‚

CodeSandbox å¤ç°äº†æ‰“ä¸å¼€çš„é—®é¢˜ï¼ŒæŠ¥é”™å’Œæˆ‘æœ¬åœ°çš„æŠ¥é”™ä¸ä¸€è‡´ï¼ŒçŒœæµ‹åº”è¯¥åŸå› æ˜¯ä¸€è‡´çš„ã€‚

æœ¬åœ°æŠ¥é”™ä¹Ÿæä¾›å¦‚ä¸‹ï¼Œå¸Œæœ›å¯¹äº bug æ’æŸ¥æœ‰å¸®åŠ©ã€‚é—®é¢˜éƒ½æ˜¯ Popconfirm ç»„ä»¶å¯¼è‡´çš„ã€‚

<img width="860" alt="æˆªå±2023-03-23 23 19 54" src="https://user-images.githubusercontent.com/38025280/227251377-6a4884e9-4c1a-463b-ab0c-b96762d155e7.png">

## zombieJ

debug äº†ä¸€ä¸‹ï¼Œç‚¹å‡»è§¦å‘ Popconfirm çš„æ—¶å€™ä¼šæ·»åŠ  window ç‚¹å‡»äº‹ä»¶ç›‘å¬ã€‚æ­¤æ—¶ç”±äºç‚¹å‡»å…ƒç´ æ˜¯ shadow domï¼Œæ‰€ä»¥å®ƒå¹¶ä¸èƒ½æ‹¿åˆ°çœŸå®çš„ dom èŠ‚ç‚¹ï¼Œä»¥è‡³äºå¼¹å±‚è®¤ä¸ºç‚¹äº†å¤–éƒ¨æ‰€ä»¥å…³å…³é—­ã€‚å¯ä»¥å…ˆåŠ ä¸ª stopPopï¼š
https://codesandbox.io/s/ji-ben-antd-5-3-2-forked-9q8lyv?file=/demo.tsx

## hewenguang

å¼ºï¼Œç¡®å®å¯ä»¥ä¸´æ—¶è§£å†³ï¼ï¼ï¼

## acyza

å¤§æ¦‚è¯•äº†ä¸‹ï¼Œå¥½åƒshadowrootä¸‹çš„æ‰€æœ‰domçš„clickäº‹ä»¶targetéƒ½æ˜¯shadowrootå®¿ä¸»
æˆ–è®¸å¯ä»¥ç”¨eventä¸­æä¾›çš„ä¸€äº›åæ ‡åˆ¤æ–­èŒƒå›´ï¼Œä½†è‚¯å®šæ²¡æœ‰targetå‡†ç¡®ã€‚

## zombieJ

fixed: https://codesandbox.io/s/ji-ben-antd-5-3-2-forked-hxh93q?file=/package.json

## RyzenPan

è¯·é—®æ€ä¹ˆè§£å†³ï¼Œæ²¡çœ‹æ‡‚åœ¨å“ªé‡ŒåŠ stopPopï¼Ÿ

## acyza

> è¯·é—®æ€ä¹ˆè§£å†³ï¼Œæ²¡çœ‹æ‡‚åœ¨å“ªé‡ŒåŠ stopPopï¼Ÿ

https://github.com/ant-design/ant-design/issues/41428#issuecomment-1481466692
`stopPropagation`çœ‹è¿™æ¡è¯„è®ºçš„demoï¼Œæˆ–å‡çº§rc-trigger

## RyzenPan

> > è¯·é—®æ€ä¹ˆè§£å†³ï¼Œæ²¡çœ‹æ‡‚åœ¨å“ªé‡ŒåŠ stopPopï¼Ÿ
>
> [#41428 (comment)](https://github.com/ant-design/ant-design/issues/41428#issuecomment-1481466692) `stopPropagation`çœ‹è¿™æ¡è¯„è®ºçš„demoï¼Œæˆ–å‡çº§rc-trigger

ä¹‹åå®˜æ–¹ä¼šè§£å†³æ˜¯å§ï¼Œå¤§æ¦‚ä»€ä¹ˆæ—¶å€™å‘æ­£å¼ç‰ˆï¼Ÿ

## RyzenPan

> > è¯·é—®æ€ä¹ˆè§£å†³ï¼Œæ²¡çœ‹æ‡‚åœ¨å“ªé‡ŒåŠ stopPopï¼Ÿ
>
> [#41428 (comment)](https://github.com/ant-design/ant-design/issues/41428#issuecomment-1481466692) `stopPropagation`çœ‹è¿™æ¡è¯„è®ºçš„demoï¼Œæˆ–å‡çº§rc-trigger

è¯·é—®rc-triggeréœ€è¦å‡çº§åˆ°å“ªä¸ªç‰ˆæœ¬ï¼Œæˆ‘çœ‹ç°åœ¨æœ€æ–°çš„æ˜¯5.3.4ï¼Œè·Ÿä»“åº“çš„tagç‰ˆæœ¬ä¸ä¸€è‡´ï¼Ÿ

## yoyo837

åœ¨ @rc-component/trigger äº†

## RyzenPan

> åœ¨ @rc-component/trigger äº†

è¯·é—®æ€ä¹ˆæ›´æ–°antdçš„@rc-component/triggeråŒ…äº†ï¼Œæˆ‘ç›´æ¥å®‰è£…æœ€æ–°ç‰ˆåœ¨é¡¹ç›®ä¸­ï¼Œantdæ²¡æœ‰ç”¨åˆ°è¿™ä¸ªåŒ…ï¼Œæˆ‘ç”¨çš„æ˜¯pnpm

## hewenguang

è¯•è¯•å¸è½½ antd åé‡æ–°å®‰è£…ï¼Œè¿™æ ·ç›¸å…³çš„ä¾èµ–ä¼šæ›´æ–°

## yoyo837

> > åœ¨ @rc-component/trigger äº†
>
> è¯·é—®æ€ä¹ˆæ›´æ–°antdçš„@rc-component/triggeråŒ…äº†ï¼Œæˆ‘ç›´æ¥å®‰è£…æœ€æ–°ç‰ˆåœ¨é¡¹ç›®ä¸­ï¼Œantdæ²¡æœ‰ç”¨åˆ°è¿™ä¸ªåŒ…ï¼Œæˆ‘ç”¨çš„æ˜¯pnpm

ç›®å‰æœ€æ–°ç‰ˆæœ¬çš„antdè¿˜å‰©ä¿©åŒ…æ²¡æœ‰åˆ‡æ¢ä¾èµ–, å…¶ä»–çš„éƒ½åˆ‡æ¢äº†

![image](https://user-images.githubusercontent.com/6134547/234515334-5f2504d6-255a-4e6e-a013-33fcd8bb7ff4.png)
