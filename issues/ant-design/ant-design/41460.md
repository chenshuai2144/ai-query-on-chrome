# 对动态显示的form field在每次mount的时候进行validation

`unconfirmed`

### Reproduction link

[![Edit on CodeSandbox](https://codesandbox.io/static/img/play-codesandbox.svg)](https://codesandbox.io/s/dynamic-field-validation-issue-otr1ec?file=/demo.tsx)

### Steps to reproduce

1. select 'cancelled' and type a value in the dynamic Input field. Note that an error message is displayed due to validation configuration
2. change status to 'optIn', dynamic field is gone
3. now change status back to 'cancelled' . Note that at this point, error message is not displayed, until you click 'submit' which triggers a form wide validation

### What is expected?

how to (or if it's even possible) to trigger validation at step 3?

### What is actually happening?

validation is not triggered at step 3 . why?

| Environment | Info      |
| ----------- | --------- |
| antd        | undefined |
| React       | 18.0      |
| System      | mac os    |
| Browser     | chrome    |

---

多谢！

<!-- generated by ant-design-issue-helper. DO NOT REMOVE -->

## bchenSyd

> validation is not triggered at step 3 . why?

I think it's because that dynamic field isn't registered when remounted; i'm not sure how to force register that field whenever it's mounted

## bchenSyd

ok.. just debugged the code.

looks like that field _is_ auto registered whenever it's mounted; but antd doesn't think it's value has been changed therefore wont' trigger validation. I guess I'll have to use an `effect` to trigger validation manually

## bchenSyd

got it. . it's more complicated than I thought before...

I added `useWatch` to watch `status` and did a `form.validationField('endDate')` inside `useEffect` and it _does_ work quite well. However, this will force validation on that dynamic field _on the first time it's mounted_ as well, which is a bit unexpected, but it makes sense.

I guess the issue here is that when a dynamic field is re-mounted, it's

1. it's clean , as that component is just mounted, not touched yet;
2. it contains data that was saved last time it was rendered;

seems to be a tricky issue!

I had to use `useRef` to track if that dynamic field was rendered before

## zombieJ

Yes. I agree its little tricky since Field is not register after render. You can handle this by `onValuesChange` with async `validateFields`:
https://codesandbox.io/s/dynamic-field-validation-issue-forked-1ilvwh?file=/demo.tsx
