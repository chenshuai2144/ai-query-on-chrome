# 4.x/5.x表格渲染性能优化：internalRowClassName、expandIcon 需要用 useMemo 缓存

`🤔 Need Reproduce`

### What problem does this feature solve?

表格数据100条时操作卡顿问题

### What does the proposed API look like?

修改 `Table.tsx`:
https://github.com/ant-design/ant-design/blob/307b76b478fe701b91197ecc19ce835e26fb397e/components/table/Table.tsx#L438

```typescript
const internalRowClassName = React.useMemo(
  (record: RecordType, index: number, indent: number) => {
    let mergedRowClassName: string;
    if (typeof rowClassName === "function") {
      mergedRowClassName = classNames(rowClassName(record, index, indent));
    } else {
      mergedRowClassName = classNames(rowClassName);
    }

    return classNames(
      {
        [`${prefixCls}-row-selected`]: selectedKeySet.has(
          getRowKey(record, index),
        ),
      },
      mergedRowClassName,
    );
  },
  [rowClassName, selectedKeySet, getRowKey],
);

// ========================== Expandable ==========================

// Pass origin render status into `rc-table`, this can be removed when refactor with `rc-table`
(mergedExpandable as any).__PARENT_RENDER_ICON__ = mergedExpandable.expandIcon;

// Customize expandable icon
mergedExpandable.expandIcon = React.useMemo(() => {
  return (
    mergedExpandable.expandIcon || expandIcon || renderExpandIcon(tableLocale!)
  );
}, [mergedExpandable.expandIcon, expandIcon, tableLocale]);
```

<!-- generated by ant-design-issue-helper. DO NOT REMOVE -->

## zombieJ

`useMemo` 返回的是缓存值，不是 function。是没有入参的。

## zombieJ

给个具体的 reproduce 看看是什么问题？
