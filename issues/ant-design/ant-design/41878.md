# Tree 组件删除其中一个节点的时候页面会闪一下

`🐛 Bug`,`help wanted`

### Reproduction link

[![Edit on CodeSandbox](https://codesandbox.io/static/img/play-codesandbox.svg)](https://codesandbox.io/s/ji-ben-antd-5-4-2-forked-xn3nbd)

### Steps to reproduce

先展开所有节点，再点删除

### What is expected?

页面不会闪

### What is actually happening?

页面会闪

https://user-images.githubusercontent.com/49217418/232949715-9576a5a0-2808-4377-974b-0fa5f1862f6a.mp4

| Environment | Info   |
| ----------- | ------ |
| antd        | 5.4.2  |
| React       | 18.2.0 |
| System      | mac    |
| Browser     | Chrome |

<!-- generated by ant-design-issue-helper. DO NOT REMOVE -->

## afc163

我怎么看到的视频是白的？

## li-jia-nan

> 我怎么看到的视频是白的？

唉？看不到视频吗大佬？我发群里你看下

## afc163

和 https://github.com/ant-design/ant-design/issues/27702 是同一个问题。

## GitHubJackson

> 和 #27702 是同一个问题。

请问这个问题解决了吗？我用的 4.22.0 版本好像还是存在这个问题

## afc163

有人看看这问题不。 @ant-design/ant-design-collaborators

## BoyYangzai

@li-jia-nan @afc163 试了一下 好像只有当上层key的dom元素完全被移除的时候才会出现这种抖动
https://codesandbox.io/s/ji-ben-antd-5-4-2-forked-bbd1x7?file=/demo.tsx:658-664
只需要移除下面的dom元素 保证上方key的dom不变就不会出现这种情况
抖动应该是diff到key不一样了 移除dom元素导致回流造成🤔

## suiyun39

@BoyYangzai
我之前尝试分析的时候发现 rc-tree 不存在这个问题, 感觉样式的问题可能性更高一些.
https://codesandbox.io/s/blissful-wing-mbq451?file=/App.jsx

## BoyYangzai

> @BoyYangzai 我之前尝试分析的时候发现 rc-tree 不存在这个问题, 感觉样式的问题可能性更高一些. https://codesandbox.io/s/blissful-wing-mbq451?file=/App.jsx

我本地也试了一下 确实没有问题呜呜呜

## BoyYangzai

@NoDocCat 排除法挨个试了一下
![image](https://github.com/ant-design/ant-design/assets/94534613/a010c8c1-a22e-4fb4-9519-0896308bd5f4)
是这个hashId的原因
这个pr https://github.com/ant-design/ant-design/pull/34272/files

---

纠正一下 还是样式问题 hashid是组件级cssinjs的一部份
具体原因是这里有个叫
![image](https://github.com/ant-design/ant-design/assets/94534613/1189c778-bc74-4126-a27c-fd2c6cb2c58d)
prefixCls-indent的类
当该整个treeNode删除的时候
该元素宽度会立马塌陷 导致后方盒子收缩 从而产生闪烁

## li-jia-nan

https://juejin.cn/post/7231940493256998972

## xiaohuoni

徒增一个烦恼 https://codesandbox.io/s/ji-ben-antd-5-4-2-forked-zsfrxl?file=/demo.tsx 在antd@4.x 也能复现这个问题
![image](https://github.com/react-component/tree/assets/11746742/95e1175c-e35b-4e77-bb9e-0c47b2fb415c)
感觉更有助于解题

## afc163

居然有这么多 PR 修这个问题。 @zombieJ @MadCcc 看看？
