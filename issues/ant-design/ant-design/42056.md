# [BUG](Upload): 在disabled=true的Form组件下，即使为Upload单独设置了disabled=false，依然无法删除已上传的文件

`🐛 Bug`,`👷🏻‍♂️ Someone working on it`

### Reproduction link

[![Edit on CodeSandbox](https://codesandbox.io/static/img/play-codesandbox.svg)](https://codesandbox.io/s/yi-shang-chuan-de-wen-jian-lie-biao-antd-5-4-5-forked-ymnozr?file=/demo.tsx)

### Steps to reproduce

1. Upload组件在 disabled=true 的context 下
2. 单独为Upload设置disabled=false
3. 点击已上传文件的删除Icon，无反应

### What is expected?

点击删除Icon能够删除已上传文件

### What is actually happening?

删除Icon被禁用

| Environment | Info       |
| ----------- | ---------- |
| antd        | 5.4.6      |
| React       | 18.0.0     |
| System      | mac os     |
| Browser     | chrome 112 |

### Reason

https://github.com/ant-design/ant-design/blob/c9bac13bc860a071749f19ee5574c926d5622303/components/upload/UploadList/index.tsx#L140

因为这里实现是Button包裹，但是没有从上游传入disabled，导致Button用的是自己从Context中取到的disabled

<!-- generated by ant-design-issue-helper. DO NOT REMOVE -->

## Wxh16144

好像确实有问题, 我来尝试解决一下~

## xliez

> 好像确实有问题, 我来尝试解决一下~

https://github.com/ant-design/ant-design/blob/c9bac13bc860a071749f19ee5574c926d5622303/components/upload/UploadList/index.tsx#L140

因为这里实现是Button包裹，但是没有从上游传入disabled，导致Button用的是自己从Context中取到的disabled

@Wxh16144

## Wxh16144

解决这个问题的适合我在考虑这种 case 是否需要考虑:

```tsx
<Form disabled>
  <Form.Item>
    <Upload disabled={false}>
      <Button onClick={window.console.log}>click</Button>
    </Upload>
  </Form.Item>
</Form>
```

现状是这个 Button 是禁用的🤔

---

假设将 Upload 都用 `DisabledContextProvider` 包裹一层的话, 那其他 antd 组件是不是也需要呢? 比如:

case1.

```tsx
<Form name="base" disabled>
  <Form.Item name="upload">
    <Button disabled={false} size="large">
      <Button size="small">click</Button>
    </Button>
  </Form.Item>
</Form>
```

## xliez

因为目前只有Form是用了 `DisabledContextProvider`，所以能支持手动传入 disabled 就也还好

## Wxh16144

我提交了一个 PR, 等待核心成员的意见和建议

## xliez

方便 4.x 版本上也 fix 一下吗？

## Wxh16144

> 方便 4.x 版本上也 fix 一下吗？

当然, 原则上 4.x 如果有 bug 都将接受更新. 晚点我去提交一个 PR.

## oliver34

现在下载按钮也被禁用了

## Wxh16144

> 现在下载按钮也被禁用了

@oliver34 我没有理解到你的意思, 可以帮助我提供一个复现地址么? (也可以重新开一个 issue

## danzw1995

> > 现在下载按钮也被禁用了
>
> @oliver34 我没有理解到你的意思, 可以帮助我提供一个复现地址么? (也可以重新开一个 issue

我最近也遇到了这个问题，我的项目中，某些情况下，Upload组件会设置为只读，但是已经上传过的文件期望能够下载。 现在disabled会传递给Button，导致下载按钮的点击事件不生效
