# Upload 组件在上传列表超过 maxCount 数量时，再进行文件上传将不会在文件上传成功/失败回调 onChange 方法

`👷🏻‍♂️ Someone working on it`

### Reproduction link

[![Edit on CodeSandbox](https://codesandbox.io/static/img/play-codesandbox.svg)](https://codesandbox.io/s/xian-zhi-shu-liang-antd-4-24-10-forked-ch8kvj)

### Steps to reproduce

1. 先上传文件直至达到maxCount 要过的数量
2. 然后再进行上传文件将只会触发一次 onChange 且 file 的 status 是 uploading 状态
3. 后续文件上传成功或者失败都不会继续出发onChange, 且上传列表也不会更新

### What is expected?

需要进行确认，期望是覆盖掉最老的文件，还是说需要弹窗提示“超过文件数量不能继续上传”而且第一次触发的onChange file 的 status 是 error 状态

### What is actually happening?

Upload 组件在上传列表超过 maxCount 数量时，再进行文件上传不会在文件上传成功/失败回调 onChange 方法

| Environment | Info                 |
| ----------- | -------------------- |
| antd        | 4.24.10              |
| React       | 18.0.0               |
| System      | MaxOS Big Sur 11.3.1 |
| Browser     | 114.0.5735.106       |

<!-- generated by ant-design-issue-helper. DO NOT REMOVE -->

## SharkBaby

我这边分析了一下原因是因为在 Antd Upload.tsx 内部，当前文件因为是超过maxCount 的数量，所以不会在他内部的mergedFileList，导致这里查找文件失败了，就不会继续触发onChange事件， 需要团队看一下这样的问题需要怎样解决？
![image](https://github.com/ant-design/ant-design/assets/18545909/db94c369-b334-467d-b549-eb38c4bf2006)

## zombieJ

超出 `maxCount` 不应该触发 `onChange` 事件，只有在 `maxCount=1` 时才会替换。

## zombieJ

> 需要进行确认，期望是覆盖掉最老的文件，还是说需要弹窗提示“超过文件数量不能继续上传”而且第一次触发的onChange file 的 status 是 error 状态

这个是业务逻辑，`maxCount` 限制不允许上传，or 不设置 `maxCount` 通过受控自行替换即可哈~

## zombieJ

> 超出 `maxCount` 不应该触发 `onChange` 事件，只有在 `maxCount=1` 时才会替换。

这个我修一下

## SharkBaby

> > 超出 `maxCount` 不应该触发 `onChange` 事件，只有在 `maxCount=1` 时才会替换。
>
> 这个我修一下
> 这个问题希望能够在>4.20的版本修复可以吗？目前我们临时的方式是在我们的业务组件中在maxCount > 1并且fileList.length等于 maxCount 的时候就禁用上传功能
> CC: @roc-an

## zombieJ

v4 的话发版本不会这么勤，你这个业务实现是可以的。
