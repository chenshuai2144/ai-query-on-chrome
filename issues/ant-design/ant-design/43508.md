# Modal组件自4.24版本以后，类组件无法在componentDidMount中根据document.getElementById获取元素

`needs-more-info`

### Reproduction link

[![Edit on CodeSandbox](https://codesandbox.io/static/img/play-codesandbox.svg)](https://codesandbox.io/s/competent-pond-628qg8?file=/src/test.jsx)

### Steps to reproduce

切换4.24之前的版本和4.24之后的版本

### What is expected?

类组件可以正常在componentDidMount中根据document.getElementById获取元素

### What is actually happening?

在4.24版本之后，类组件无法在componentDidMount中根据document.getElementById获取元素

| Environment | Info                                                 |
| ----------- | ---------------------------------------------------- |
| antd        | 4.24.0                                               |
| React       | 18.2                                                 |
| System      | Windows10企业版                                      |
| Browser     | Microsoft Edge 版本 114.0.1823.67 (正式版本) (64 位) |

<!-- generated by ant-design-issue-helper. DO NOT REMOVE -->

## MadCcc

建议用 ref

## Jovian-cw

> 是的，用ref是没有问题的，就是好奇引起这个问题的原因是什么

## MadCcc

原因可能是 react 创建了这个元素但是还没有 append 到 body 上。
可能和 portal 的升级有关

## zombieJ

嗯，之前实现是在 render 阶段创建一个 dom 到 body 上。这个在 React 18 后 StrictMode or Suspense 下会重复创建 dom 节点。所以挪到 useLayoutEffect 里实现了。
