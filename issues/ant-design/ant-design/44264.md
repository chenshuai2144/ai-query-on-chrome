# Form 表单 如何只想清除表单验证结果

`unconfirmed`

### What problem does this feature solve?

清除表单的值，会触发表单验证，但是 需求是把表单验证结果去掉

### What does the proposed API look like?

clearValidate

<!-- generated by ant-design-issue-helper. DO NOT REMOVE -->

## afc163

validateFields 可以么？

## lance-li

> validateFields 可以么？

<img width="648" alt="image" src="https://github.com/ant-design/ant-design/assets/21050392/26b05fac-e9a3-4fa6-ac53-8c0a313a621e">
根据参数好像并不能满足，清除UI的校验结果

## afc163

> 需求是把表单验证结果去掉

你的完整需求是啥，什么情况下不需要 reset 内容只清除校验结果，用户体验上具体要解决什么问题。

## lance-li

> > 需求是把表单验证结果去掉
>
> 你的完整需求是啥，什么情况下不需要 reset 内容只清除校验结果，用户体验上具体要解决什么问题。

一、我在基于antd 组件UI 写一套组件UI，以健壮antd数据驱动视图。如下图：
<img width="1529" alt="image" src="https://github.com/ant-design/ant-design/assets/21050392/9ea3e83b-f8fd-4ca9-b0b9-3a03a8ef9cfa">

```jsx
import zhCN from 'antd/es/locale/zh_CN';
import { LRTForm } from 'lrt';
import React,{useState,useRef} from 'react'
import {ConfigProvider} from 'antd'

  function App(props,ref) {
    const [count, setCount] = useState(0)
    // const form = Form.useFormInstance();
    const form  = useRef()
    const dicDataList = [{label: '2121', value: 32}, {label: '4343', value: 44}]
    const options: any[] = [
      {
        va: 'zhejiang',
        la: 'Zhejiang',
        child: [
          {
            va: 'hangzhou',
            la: 'Hangzhou',
            child: [
              {
                va: 'xihu',
                la: 'West Lake',
              },
            ],
          },
        ],
      },
      {
        va: 'jiangsu',
        la: 'Jiangsu',
        child: [
          {
            va: 'nanjing',
            la: 'Nanjing',
            child: [
              {
                va: 'zhonghuamen',
                la: 'Zhong Hua Men',
              },
            ],
          },
        ],
      },
    ];
    const option = {
      disabled: false,
      tabs: count === 3,
      menus: [
        {
          label: '清空',
          prop: 'clear',
          click: ({ref}: any) => {
            console.log(ref.getFieldsValue())
          }
        }
      ],
      initialValues: {
        name1: '454353535'
      },
      column: [
        {label: '单文本输入框', prop: 'name', initialValue: '2123213123123', rules: [{required: true}]},
        {
          label: '多文本输入框', prop: 'name1', type: 'textarea',
          showCount: true,
          allowClear: true,
          autoSize: false,
          cascaderItem: ['name2']
        },
        {label: '密码输入框', prop: 'name2', type: 'password'},
        {label: '搜索输入框', prop: 'name3', type: 'search'},
        {
          label: '自定义文本', prop: 'name4', type: 'textarea',
          render: (props: Record<string, any>) => <div ref={props.specific}
                                                       style={{textAlign: "left"}}>23131231313131313</div>

        },
        {
          label: '搜索输入框',
          prop: ['age', 'name5'],
          disabled: false,
          allowClear: true,
          initialValue: 44,
          type: 'select',
          dicData: count === 3 ? [...dicDataList, {label: '989898', value: 43}] : dicDataList
        },
      ],
      group: [
        {
          label: '文本1',
          prop: 'key1',
          column: [
            {label: '单文本输入框', prop: 'name12'},
            {
              label: 'radio', prop: 'name13', type: 'radio',
              // optionRender:()=>{return <p>dadhkjsahdakjhd</p>},
              dicData: count === 3 ? [...dicDataList, {label: '989898', value: 43}] : dicDataList
            },
            {
              label: 'cascader',
              prop: 'name14',
              type: 'cascader',
              dicData: options,
              props: {label: 'la', value: 'va', children: 'child'}
            },
            {
              label: 'checkbox', prop: 'name15', type: 'checkbox', all: false,
              dicData: dicDataList
            },
            {label: '日期', prop: 'name16', type: 'daterange', showTime: false},
            {label: 'selectTree', prop: 'name17', type: 'tree', dicData: options,props: {label: 'la', value: 'va', children: 'child'}},
          ]
        }
      ]
    }
    const text = '212121211221'
    const items: CollapseProps['items'] = [
      {
        key: '1',
        label: 'This is panel header 1',
        children: <p>{text}</p>,
      },
      {
        key: '2',
        label: 'This is panel header 2',
        children: <p>{text}</p>,
      },
      {
        key: '3',
        label: 'This is panel header 3',
        children: <p>{text}</p>,
      },
    ];

    const handleSubmit = (data, done) => {
      console.log(data,form.current.getFieldsValue())
      done && done()
    }

    return (
      <ConfigProvider locale={zhCN}>
        <div className="App">
          <LRTForm ref={form} option={option} onSubmit={handleSubmit}/>
        </div>
      </ConfigProvider>
    )
  }

  export default React.forwardRef(App);
```

二，我这里有form 的清空数据的功能，如上图所示 “单文本输入框 ” 是个必填项，使用场景是 initialValues 给定了 必填项值，然后用户手动清除输入内容 会触发 表单 验证，当然会正常显示验证结果，此时要满足一个功能 是点击清除按钮 实现的效果是：1、清除表单所有内容，2、清除表单所有表单验证 验证显示结果

三，后续会有 form 嵌套 和 table 表单 嵌套等功能，都会应有 清除 值和表单验证的功能，antd 提供了 setFieldsValue 的方法，当然想设置为空 值 或者 null ，所以也想清除 表单验证显示结果

## lance-li

顺便 再说一下resetFields，当然 用户也可以自行 根据name 正向处理reset，在大表单的情况下重置可以恢复到 initialValues 的状态，但是会存在 极个别很少量的字段不希望 reset ,resetFields 已经提供了 name 需要恢复的字段，但是可否 再提供一个参数用于 resetExclude 排除在外，可供考虑

## afc163

> 此时要满足一个功能 是点击清除按钮 实现的效果是：1、清除表单所有内容，2、清除表单所有表单验证 验证显示结果

点击清除按钮同时达到这两个效果么？可以用 setFields 来实现这个效果：https://codesandbox.io/s/biao-dan-fang-fa-diao-yong-class-component-antd-5-8-3-forked-4rphs8?file=/demo.tsx

## afc163

> 但是会存在 极个别很少量的字段不希望 reset ,resetFields 已经提供了 name 需要恢复的字段，但是可否 再提供一个参数用于 resetExclude 排除在外，可供考虑

可以自己实现一个 exclude 处理后再传给 `resetFields([ ... ])`。

## lance-li

> > 此时要满足一个功能 是点击清除按钮 实现的效果是：1、清除表单所有内容，2、清除表单所有表单验证 验证显示结果
>
> 点击清除按钮同时达到这个效果么？可以用 setFields 来实现这个效果：https://codesandbox.io/s/biao-dan-fang-fa-diao-yong-class-component-antd-5-8-3-forked-4rphs8?file=/demo.tsx
> 感谢，可以，那就多写点代码

## lance-li

> > 但是会存在 极个别很少量的字段不希望 reset ,resetFields 已经提供了 name 需要恢复的字段，但是可否 再提供一个参数用于 resetExclude 排除在外，可供考虑
>
> 可以自己实现一个 exclude 处理后再传给 `resetFields([ ... ])`。

目前只能这么去做，谢谢
