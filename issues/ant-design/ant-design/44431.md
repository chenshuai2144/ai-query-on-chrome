# 为什么不使用 React.memo 来开启 shallowEqual，以及相关操作来优化性能呢？

`unconfirmed`

### What problem does this feature solve?

为什么不使用 React.memo 来开启 shallowEqual，以及相关操作来优化性能呢？

### What does the proposed API look like?

想了解为什么

<!-- generated by ant-design-issue-helper. DO NOT REMOVE -->

## yoyo837

请具体点, 哪个位置应该用而没用memo

## yuanliu147

> 请具体点, 哪个位置应该用而没用memo

额，貌似很多组件，比如 Modal、Form 之类的。

## yoyo837

链到具体的行来看看?

## yuanliu147

> 链到具体的行来看看?

https://github.com/ant-design/ant-design/blob/4e9ac02b08bb967a588f00cc08809f59cf2b45f9/components/modal/Modal.tsx#L133

有疑惑，好像没有使用 React.memo() 包裹组件，，

## zombieJ

`React.memo` 控制粒度是不够的，内部组件更新需要更精细化的 deps 管理。antd 中大量使用 `useMemo` 做优化：

https://github.com/search?q=repo%3Aant-design%2Fant-design%20useMemo&type=code
https://github.com/search?q=org%3Areact-component+useMemo&type=code

## zombieJ

> 有疑惑，好像没有使用 React.memo() 包裹组件，，

如果只是组件没有全部包，可以看一下 React 的官方文档：https://react.dev/learn/render-and-commit

React 官方并不推荐随意进行过度优化的操作，只有当性能有明显问题是才需要处理。

## yuanliu147

原来如此

## zombieJ

> > 有疑惑，好像没有使用 React.memo() 包裹组件，，
>
> 如果只是组件没有全部包，可以看一下 React 的官方文档：https://react.dev/learn/render-and-commit
>
> React 官方并不推荐随意进行过度优化的操作，只有当性能有明显问题是才需要处理。

可以参考一下这个例子体会一下为什么不应该过度优化：
https://codesandbox.io/s/blazing-microservice-xpfm5v?file=/src/App.tsx
