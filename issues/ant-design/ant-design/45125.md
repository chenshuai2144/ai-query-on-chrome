# useWatch在条件渲染Form.Item的时候，取值和form.getFieldValue不一致

`unconfirmed`

### Reproduction link

[![Edit on CodeSandbox](https://codesandbox.io/static/img/play-codesandbox.svg)](https://codesandbox.io/s/ji-ben-shi-yong-antd-4-24-12-forked-l8g2mr)

### Steps to reproduce

点击checkbox，切换checkbox的值为false和true，观察console.log打印情况，发现checkbox值为ture的时候，页面有正常渲染出正确值的表单元素，但是useWatch拿到的值是undefined，form.getFieldValue能拿到正确的值。

### What is expected?

1、useWatch取值和form.getFieldValue一致，如果不一致，可以解释一下为什么useWatch拿到的是undefined，但是form.getFieldValue拿的却是正常的值吗？
2、是否条件渲染，只能放在Form.Item里去做处理，不能放到外头来决定是否渲染Form.Item?

### What is actually happening?

useWatch在isEdit为true的情况下，拿到的值是undefined。

| Environment | Info                  |
| ----------- | --------------------- |
| antd        | 4.24.12               |
| React       | ^18.0.0               |
| System      | mac                   |
| Browser     | chrome 114.0.5735.133 |

<!-- generated by ant-design-issue-helper. DO NOT REMOVE -->

## zombieJ

https://codesandbox.io/s/ji-ben-shi-yong-antd-4-24-12-forked-l6zmh2

参考文档。`useWatch` 监听的是存在 Field 注册的字段，当切换时页面没有对应的 Field 会略过该字段。通过 `preserve` 属性可以始终关联 FormInstance 内的值，而无视 Field 是否存在。

ref https://ant-design.antgroup.com/components/form-cn#formusewatch

## crazyair

isEdit 为 true 后才会加载 name 字段，会经过2次render
第一次 render：isEdit 为 true，执行 useEffect，这时 name 因为是刚加载，所以还是 undefined
第二次 render： name 会有值

所以不能这样写

```tsx
useEffect(() => {
  console.log(name);
}, [isEdit]);
```

## crazyair

> preserve

不能用 preserve，不然不知道 name 是否加载，是否为空，就没法根据 name 判断了
