# åœ¨modalä¸­è¿›è¡Œè¡¨å•éªŒè¯, è¡¨å•éªŒè¯ä¸æˆåŠŸæ—¶ï¼Œä¼šè§¦å‘modalçš„onCanceläº‹ä»¶

`ğŸ¤” Need Reproduce`

### Reproduction link

[http://æš‚æ— url](http://æš‚æ— url)

### Steps to reproduce

formRef.current?.validateFields().then(rsp => { console.log(rsp) }).catch((e) => { console.log(e) })

### What is expected?

ç‚¹å‡»ç¡®è®¤æ—¶ï¼Œè¡¨å•éªŒè¯ä¸æˆåŠŸæ—¶ï¼Œä¸è¦è§¦å‘äº†onCanceläº‹ä»¶

### What is actually happening?

è‡ªåŠ¨å…³é—­modal, å¹¶è§¦å‘äº† onCancel äº‹ä»¶

| Environment | Info   |
| ----------- | ------ |
| antd        | 5.10.1 |
| React       | react  |
| System      | win11  |
| Browser     | Chrome |

---

ç‚¹å‡»ç¡®è®¤æ—¶ï¼Œè¡¨å•éªŒè¯ä¸æˆåŠŸæ—¶ï¼Œæµè§ˆå™¨æ•è·äº† rejectï¼Œ è§¦å‘äº†onCanceläº‹ä»¶ï¼Œ å½“è¡¨å•éªŒè¯æˆåŠŸçš„åˆ™æ— æ­¤é—®é¢˜ã€‚

-- Antd è¡¨å•éªŒè¯å¤„ç†ä»£ç æ®µ

```
var pending = new Promise(function(resolve, reject) {
    var next2 = function next3(errors) {
      results.push.apply(results, errors);
      total  ;
      if (total === objArrLength) {
        callback(results);
        return results.length ? reject(new AsyncValidationError(results, convertFieldsError(results))) : resolve(source);
      }
    };
```

--

-- Modal å®šä¹‰

```
<Modal
        title={title}
        open={open}
        width="80%"
        onOk={handleOK}
        onCancel={handleCancel}>
        <Spin spinning={isLoading}>
            <ProForm submitter={false} formRef={formRef} preserve={false}>
                <ProFormText name="name" label="è§’è‰²åç§°" width="md" rules={ruleRequired} />
                <ProFormText name="displayName" label="å¯¹å¤–å±•ç¤ºåç§°" width="md" rules={ruleRequired} />
            </ProForm>
        </Spin>
    </Modal>
```

-- äº‹ä»¶

```
    const handleCancel = useCallback(async () => {
        console.log("do cancel")
        // onCancel && onCancel()
    }, [])

    const handleOK = useCallback(async () => {
        console.log("hit")
        formRef.current?.validateFields().then(rsp => { console.log(rsp) }).catch((e) => { console.log(e) })
    }, [])
```

ç‚¹å‡» ç¡®å®šï¼Œ è°ƒè¯•ç»“æœå¦‚ä¸‹ï¼š

hit

modal-edit.tsx?t=1697387705752:25 do cancel

modal-edit.tsx?t=1697387705752:33 {values: {â€¦}, errorFields: Array(2), outOfDate: false}

<!-- generated by ant-design-issue-helper. DO NOT REMOVE -->
