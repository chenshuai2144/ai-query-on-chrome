# ğŸ‘‘ [éœ€æ±‚]ProTable æ—¥æœŸåŒºé—´æ”¯æŒè‡ªå®šä¹‰å‚æ•°åç§°.

`table`,`ğŸ–ï¸  featrue`

### ğŸ¥° éœ€æ±‚æè¿°

<!--
è¯¦ç»†åœ°æè¿°éœ€æ±‚ï¼Œè®©å¤§å®¶éƒ½èƒ½ç†è§£
-->

{
title: 'åˆ›å»ºæ—¶é—´',
dataIndex: 'createTime',
width: 160,
valueType: 'dateRange',
rangeStart:'beginCreateTime', // æ·»åŠ ç±»ä¼¼çš„è®¾ç½®
rangeEnd:'endCreateTime', // æ·»åŠ ç±»ä¼¼çš„è®¾ç½®
},

ç›®å‰ç”Ÿæˆçš„ä¸º
createTime[0]: 2020-08-01
createTime[1]: 2020-08-30

å¸Œæœ›èƒ½å¤Ÿè¿›è¡Œè‡ªå®šä¹‰,
beginCreateTime:2020-08-01
endCreateTime:2020-08-01

### ğŸ§ è§£å†³æ–¹æ¡ˆ

<!--
å¦‚æœä½ æœ‰è§£å†³æ–¹æ¡ˆï¼Œåœ¨è¿™é‡Œæ¸…æ™°åœ°é˜è¿°
-->

### ğŸš‘ å…¶ä»–ä¿¡æ¯

<!--
å¦‚æˆªå›¾ç­‰å…¶ä»–ä¿¡æ¯å¯ä»¥è´´åœ¨è¿™é‡Œ
-->

## chenshuai2144

æ¥ä¸ª prï¼Ÿ

## l745230

æœ‰å¤§ä½¬æ„Ÿå…´è¶£æ¥prå—~~åç«¯ç¨‹åºçŒ¿è¡¨ç¤ºå¯¹å‰ç«¯ä»…ä»…å¤„äºä¼šç”¨çš„ç¨‹åº¦...

## chenshuai2144

ğŸ˜ æè¿°çš„è¶Šè¯¦ç»†è¶Šå®¹æ˜“è¢«å®ç°

## l745230

åŠŸèƒ½æè¿°:
åç«¯æ¥å£,è¡¨æ ¼åˆ—åç§°ä¸åˆ—æŸ¥è¯¢åç§°ä¸åŒ.æ ¹æ®key/dataIndex è‡ªåŠ¨ç”Ÿæˆçš„å‚æ•°åç§°æ— æ³•ä½¿ç”¨.

åœºæ™¯1.æ¥å£è¿”å›ç”¨æˆ·ä¿¡æ¯å­—æ®µä¸º account(è´¦å·å),nickname(æ˜µç§°), ä½¿ç”¨nameåšä¸ºå…³é”®è¯ æ¨¡ç³ŠæŸ¥è¯¢account,nickname. 2.æ¥å£è¿”å›ç”¨æˆ·åˆ›å»ºæ—¶é—´ createTIme. ä½¿ç”¨startTime,endTIme ä¸¤ä¸ªå­—æ®µåŒºé—´æŸ¥è¯¢createTIme.

éœ€æ±‚:
Columns åˆ—å®šä¹‰æ·»åŠ æ”¯æŒè‡ªå®šä¹‰å‚æ•°åç§°.

æ€è·¯å‚è€ƒ:
Columnsæ·»åŠ paramName,paramName2ä½œä¸ºè‡ªå®šä¹‰å‚æ•°åç§°
paramName ä¸ºç©º,èµ°æ—§é€»è¾‘ä½¿ç”¨key/dataIndexä½œä¸ºå‚æ•°å
paramName ä¸ä¸ºç©º,ä½œä¸ºå‚æ•°å
paramName2, å½“ä¸ºåŒºé—´ç»„ä»¶æ—¶, paramNameä¸paramName2ä¸ä¸ºç©º. åˆ†åˆ«æ›¿æ¢key[0] key[1]

APIç¤ºä¾‹:
{
title: 'è´¦å·å',
dataIndex: 'account',
hideInSearch: true,
},
{
title: 'æ˜µç§°',
dataIndex: 'nickname',
paramName:'name',
},
{
title: 'åˆ›å»ºæ—¶é—´',
dataIndex: 'createTime',
valueType: 'dateRange',
paramName:'startTIme',
paramName2:'endTine',
},

è®¿é—®url
é…ç½®å‰
/userList?nickname=å¼ ä¸‰&createTime[0]=2020-08-13&createTime[1]=2020-08-30
é…ç½®è‡ªå®šä¹‰å‚æ•°åç§°å
/userList?name=å¼ ä¸‰&startTime=2020-08-13&endTime=2020-08-30

## itsuki0927

æˆ‘çš„æƒ³æ³•ç»™`ProTable`å¢åŠ ä¸€ä¸ª`props`å±æ€§: `renameReqKeyMap`,ç„¶ååœ¨`submit`çš„æ—¶å€™å¯ä»¥è·å–`formValue`, å¯¹`key`è¿›è¡Œ`rename`æ“ä½œ,å½“ç„¶è¿™ä¸ª`rename`æ“ä½œæ˜¯åœ¨`beforeSearchSubmit`ä¹‹å‰çš„,ä¹Ÿå°±æ˜¯è¯´åœ¨`beforeSearchSubmit`ä¸­å¯ä»¥è·å–åˆ°`rename key`çš„å¯¹è±¡.

ä½†æ˜¯å®ƒéœ€è¦æ»¡è¶³ä¸€å®šçš„è§„å®šæ¯”å¦‚è¯´:

- å¦‚æœåªæ˜¯éœ€è¦å°†`key a` -> `key b` åªéœ€è¦`{ a: 'b' }`

ä¸¾ä¸ªæ —å­

```js
const formValue = {
  name: "lsl",
  age: 10,
};
const renameReqKeyMap = {
  name: "name1",
};
// æœ€ç»ˆç»“æœä¸º { name1: 'lsl', age: 10 }
```

- å¦‚æœæ˜¯åµŒå¥—å¯¹è±¡ `key 'a.b.c' -> key 'f.b.c'` åªéœ€è¦`{ 'a.b.c' : ['f'] }` ä»¥æ­¤ç±»æ¨

**ä¸¾ä¸ªä¾‹å­**

```js
const formValue = {
  a: {
    b: { c: 1 },
  },
  age: 10,
};
const renameReqKeyMap1 = {
  "a.b.c": ["f"],
};
// æœ€ç»ˆç»“æœä¸º { f:{ b: { c: 1 } }, age: 10 }

const renameReqKeyMap2 = {
  "a.b.c": ["f", "g"],
};
// æœ€ç»ˆç»“æœä¸º { f:{ g: { c: 1 } }, age: 10 }
// ä»¥æ­¤ç±»æ¨
```

- å¦‚æœæ˜¯`formValue`çš„`key [x,xx]`æ˜ å°„æˆ`{a:x,b:xx}`,åˆ™éœ€è¦ä¼ å…¥ä¸€ä¸ªæ•°ç»„,å¹¶ä¸”**ä¿è¯ä¼ å…¥çš„é¡ºåº**

**ä¸¾ä¸ªä¾‹å­**

```js
const formValue = {
  createdAt: ["2020-8-20", "2020-8-27"],
  age: 10,
};
const renameReqKeyMap = {
  createdAt: ["startTime", "endTime"],
};
// æœ€ç»ˆç»“æœä¸º { startTime: '2020-8-20',endTime: '2020-8-27', age:10 }
```

- ä½†æ˜¯æœ‰ä¸ªå…¶ä»–æƒ…å†µå°±æ˜¯: å‡å¦‚è¯´ç”¨æˆ·åœ¨ä¼ å…¥æ•°ç»„çš„æ—¶å€™å¤šä¼ å…¥æˆ–è€…å°‘ä¼ å…¥,è¿™æ ·å­åº”è¯¥æ€ä¹ˆå»å¤„ç†å‘¢

```js
// å¤šä¼ å…¥
const formValue = {
  status: [1, 2, 3, 4, 5],
};
const renameReqKeyMap = {
  status: ["startTime", "endTime"],
};
// çœç•¥: { startTime: 1, endTime: 2 }
// åˆ©ç”¨åŸæ¥çš„å­—æ®µ: { startTime:1, endTime: 2, list: [3, 4, 5] }

// å°‘ä¼ å…¥
const formValue = {
  status: [1],
  age: 10,
};
const renameReqKeyMap = {
  status: ["startTime", "endTime"],
};
// çœç•¥: { startTime: 1 }
```

åº”è¯¥æ€ä¹ˆå»å¤„ç†è½¬æ¢å‘¢? çœç•¥æ‰? è¿˜æ˜¯åˆ©ç”¨åŸæ¥çš„å­—æ®µ? æˆ–è€…æœ‰å…¶ä»–æ€è·¯

æˆ‘è¿™è¾¹å·²ç»å®ç°å‰é¢ä¸¤ç§æƒ…å†µ,ä½†æ˜¯æœ€åä¸€ç§æƒ…å†µ,ä¸å¯æ§å› ç´ æœ‰ç‚¹å¤š <img width="569" alt="Screen Shot 2020-08-14 at 6 53 34 PM" src="https://user-images.githubusercontent.com/40518195/90242361-771efb80-de5f-11ea-930c-27cfe9af0e29.png"> ![Screen Shot 2020-08-14 at 6 56 16 PM](https://user-images.githubusercontent.com/40518195/90242552-da109280-de5f-11ea-843d-53e0eec35d5b.png)

è¿™ä¸ªæ˜¯æˆ‘çš„æ€è·¯, æˆ–è€…è¿˜æœ‰æ›´å¥½çš„å®ç°æ–¹æ³•æˆ–è€…å…¶ä»–æ€è·¯?

## itsuki0927

æˆ–è€…æŠŠè¿™ä¸ªå±æ€§æ‹†åˆ†åˆ°æ¯ä¸€ä¸ª`column`,éœ€è¦`rename key`çš„å±æ€§åˆ—åœ¨å…¶ Column ä¸­å®šä¹‰

```js
const columns = [
  {
    title: "åˆ›å»ºæ—¶é—´",
    key: "since",
    dataIndex: "createdAt",
    valueType: "dateTime",
    // è½¬æ¢æˆ{ transformSince:'' }
    renameKey: "transformSince",
  },
  {
    title: "æ—¥æœŸåŒºé—´",
    key: "createdAtRange",
    dataIndex: "createdAtRange",
    valueType: "dateRange",
    // è½¬æ¢æˆ { startTime:'', endTime:'' }
    renameKey: ["startTime", "endTime"],
  },
  {
    title: "æ›´æ–°æ—¶é—´",
    key: "since2",
    dataIndex: "createdAt",
    valueType: "date",
  },
];
```

## l745230

https://github.com/ant-design/pro-components/issues/247

## l745230

@chenshuai2144 æˆ‘å°è¯•ç»“åˆ @WoodsLiu çš„æ€è·¯,å°è£…äº†ä¸‹.
ç›®å‰æ˜¯èƒ½å®ç°æäº¤çš„æ—¶å€™æ ¹æ®æ˜ å°„å…³ç³»,è‡ªåŠ¨å¤„ç†å‚æ•°, ä¸urlè‡ªåŠ¨å°†å‚æ•°å›æ˜¾.

```js
 // æ—¥æœŸå‚æ•°æ˜ å°„å…³ç³»
  dateParamKeyMap?: [
    {
      key: String; // å‚æ•°åç§°
      valueType: 'dateRange'; // æ—¥æœŸç±»å‹(ç›®å‰åªå®ç°åŒºé—´æ—¥æœŸç±»å‹)
      startTime?: String; // åŒºé—´æ—¥æœŸ,é‡å‘½åå¼€å§‹å‚æ•°å
      endTime?: String; // åŒºé—´æ—¥æœŸ,é‡å‘½åç»“æŸå‚æ•°å
      dateTime?: String; // å•ä¸ªæ—¥æœŸ,é‡å‘½åå‚æ•°å
    },
  ];

è°ƒç”¨:
dateParamKeyMap={[
          {
            key: 'createTime',
            valueType: 'dateRange',
            startTime: 'startTime',
            endTime: 'endTime',
          },
        ]}

æäº¤å¤„ç†:
const onSubmit = (params: any) => {
    // å¤„ç†æ—¥æœŸå‚æ•°æäº¤å€¼
    if (dateParamKeyMap) {
      dateParamKeyMap.map(item => {
        if (item.valueType === 'dateRange') {
          if (item.startTime) {
            params[`${item.startTime}`] = params[`${item.key}`]?.[0];
          }
          if (item.endTime) {
            params[`${item.endTime}`] = params[`${item.key}`]?.[1];
          }
          delete params[`${item.key}`];
        }
      });
    }
}

Urlå›æ˜¾:
http://localhost:8000/#/List?startTime=2020-08-01&endTime=2020-08-02

 // å¤„ç†æ—¥æœŸå‚æ•°åˆå§‹å€¼
  let othersQuery = {};
  if (query && dateParamKeyMap) {
    dateParamKeyMap.map(item => {
      if (item.valueType === 'dateRange') {
        if (query[`${item.startTime}`] && query[`${item.endTime}`]) {
          othersQuery[`${item.key}`] = [
            moment(query[`${item.startTime}`], 'YYYY-MM-DD'),
            moment(query[`${item.endTime}`], 'YYYY-MM-DD'),
          ];
        }
      }
    });
  }

<ProTable
        form={{
          initialValues: {
            ...othersQuery,
          },
        }}
        loading={loading}
        dataSource={data}
      />
```

## l745230

è™½ç„¶æ•ˆæœå®ç°äº†,ä½†æ˜¯å°è£…çš„å¾ˆç²—é™‹, è¿˜æ˜¯æœŸæœ›èƒ½ç”¨ä¸Šå®˜æ–¹æä¾›çš„.

## dmdoit

æˆ‘è§‰å¾—é»˜è®¤åº”è¯¥æ˜¯
createTime[0]: 2020-08-01
createTime[1]: 2020-08-30

å¦‚æœä½ éœ€è¦startTimeå’ŒendTimeè¿™æ ·çš„æ ¼å¼çš„è¯ï¼Œå¯ä»¥åœ¨beforeSearchSubmit è¿™ä¸ªapiä¸­æ‰‹åŠ¨è½¬åŒ–ä¸€ä¸‹

## zmj0920

```
 {
      title: 'æ—¶é—´åŒºé—´',
      key: 'dateTimeRange',
      width: 100,
      align: 'center',
      dataIndex: 'createdAtRange',
      valueType: 'dateTimeRange',
      // hideInForm: true,
      // initialValue: [moment('2019-11-16 12:50:26'), moment('2019-11-16 12:50:26')],
      fieldProps: {
        className: `${style.pre}`,
      },
      search: {
        transform: (value) => ({
          //è½¬åŒ–å€¼çš„ key, ä¸€èˆ¬ç”¨äºäº‹ä»¶åŒºé—´çš„è½¬åŒ–
          startTime: value[0],
          endTime: value[1],
        }),
      },
```

## zmj0920

![image](https://user-images.githubusercontent.com/42410507/98004444-e8e95e80-1e2a-11eb-846c-9fd882ce64bb.png)

## xgj1988

è¿™ä¸ªé—®é¢˜è¿˜æ²¡è§£å†³ï¼Ÿ

## watsonhaw5566

> search: {
> transform: (value) => ({
> //è½¬åŒ–å€¼çš„ key, ä¸€èˆ¬ç”¨äºäº‹ä»¶åŒºé—´çš„è½¬åŒ–
> startTime: value[0],
> endTime: value[1],
> }),
> },

è§£å†³äº†ï¼Œç”¨ zjm0920 çš„æ–¹æ¡ˆå°±å¥½
