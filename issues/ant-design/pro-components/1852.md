# ğŸ§[é—®é¢˜] pro-layout å¸¦çš„ menu , å±•å¼€é—­åˆæ—¶ï¼Œ éå¸¸å¡é¡¿ï¼Œ çœ‹äº†ä¸‹ cpu å ç”¨, ä¸çŸ¥é“å“ªä¸€å—çš„é—®é¢˜

`â­•ï¸   bug`,`table`

### ğŸ§ é—®é¢˜æè¿°

ä½¿ç”¨çš„æ˜¯ pro-layout å¸¦çš„ menu , å±•å¼€é—­åˆæ—¶ï¼Œ éå¸¸å¡é¡¿ï¼Œ çœ‹äº†ä¸‹ cpu å ç”¨, ä¸çŸ¥é“å“ªä¸€å—çš„é—®é¢˜

<!--
è¯¦ç»†åœ°æè¿°é—®é¢˜ï¼Œè®©å¤§å®¶éƒ½èƒ½ç†è§£
-->

### ğŸ’» ç¤ºä¾‹ä»£ç 

BasicLayout æ–‡ä»¶å¦‚ä¸‹ï¼š

```
/**
 * Ant Design Pro v4 use `@ant-design/pro-layout` to handle Layout.
 * You can view component api by:
 * https://github.com/ant-design/ant-design-pro-layout
 */
import ProLayout, { PageContainer } from '@ant-design/pro-layout';
import React, { useEffect, useMemo, useRef } from 'react';
import { Link, useIntl, connect, history } from 'umi';
import { Result, Button } from 'antd';
import { SmileOutlined, HeartOutlined } from '@ant-design/icons';
import Authorized from '@/utils/Authorized';
import RightContent from '@/components/GlobalHeader/RightContent';
import { getMatchMenu } from '@umijs/route-utils';
import logo from '../assets/logo.svg';

const IconMap = {
  smile: <SmileOutlined />,
  heart: <HeartOutlined />,
};

// ç”¨äºä¸ºä»æœåŠ¡ç«¯è¯·æ±‚æ¥çš„èœå•æ·»åŠ é€šè¿‡ icon å­—æ®µ åŒ¹é… Icon ï¼ˆå­—ä½“å›¾æ ‡ï¼‰
const loopMenuItem = (menuList) =>
  menuList.map(({ icon, children, ...item }) => ({
    ...item,
    icon: icon && IconMap[icon],
    children: children && loopMenuItem(children),
  }));

const noMatch = (
  <Result
    status={403}
    title="403"
    subTitle="Sorry, you are not authorized to access this page."
    extra={
      <Button type="primary">
        <Link to="/user/login">Go Login</Link>
      </Button>
    }
  />
);

/**
 * use Authorized check all menu item
 */

const BasicLayout = (props) => {
  const {
    dispatch,
    children,
    settings,
    location = {
      pathname: '/',
    },
    menuList,
    loading,
  } = props;
  const menuDataRef = useRef([]);

  useEffect(() => {
    if (dispatch) {
      dispatch({
        type: 'menu/menuTree',
        payload: {
          menuParentId: '22248',
        },
      });
      dispatch({
        type: 'dict/types',
      });
    }
  }, []);
  /**
   * init variables
   */

  const handleMenuCollapse = (payload) => {
    if (dispatch) {
      dispatch({
        type: 'global/changeLayoutCollapsed',
        payload,
      });
    }
  };

  // get children authority
  const authorized = useMemo(
    () =>
      getMatchMenu(location.pathname || '/', menuDataRef.current).pop() || {
        authority: undefined,
      },
    [location.pathname],
  );
  const { formatMessage } = useIntl();

  return (
    <ProLayout
      logo={logo}
      formatMessage={formatMessage}
      {...props}
      {...settings}
      onCollapse={handleMenuCollapse}
      onMenuHeaderClick={() => history.push('/')}
      menuItemRender={(menuItemProps, defaultDom) => {
        if (
          menuItemProps.isUrl ||
          !menuItemProps.path ||
          location.pathname === menuItemProps.path
        ) {
          return defaultDom;
        }

        return <Link to={menuItemProps.path}>{defaultDom}</Link>;
      }}
      breadcrumbRender={(routers = []) => [
        {
          path: '/',
          breadcrumbName: formatMessage({
            id: 'menu.home',
          }),
        },
        ...routers,
      ]}
      itemRender={(route, params, routes, paths) => {
        const first = routes.indexOf(route) === 0;
        return first ? (
          <Link to={paths.join('/')}>{route.breadcrumbName}</Link>
        ) : (
          <span>{route.breadcrumbName}</span>
        );
      }}
      menuDataRender={() => loopMenuItem(menuList)}
      rightContentRender={() => <RightContent />}
      postMenuData={(menuData) => {
        menuDataRef.current = menuData || [];
        return menuData || [];
      }}
      menu={{ locale: false, loading }}
    >
      <Authorized authority={authorized.authority} noMatch={noMatch}>
        <PageContainer header={{ title: '' }}>{children}</PageContainer>
      </Authorized>
    </ProLayout>
  );
};

export default connect(({ global, settings, menu, loading }) => ({
  collapsed: global.collapsed,
  settings,
  menuList: menu.menuList,
  loading: loading.effects['menu/menuTree'],
}))(BasicLayout);

```

<!--
å¦‚æœä½ æœ‰è§£å†³æ–¹æ¡ˆï¼Œåœ¨è¿™é‡Œæ¸…æ™°åœ°é˜è¿°
-->

### ğŸš‘ å…¶ä»–ä¿¡æ¯

â†“â†“â†“â†“â†“â†“â†“â†“â†“â†“â†“â†“

<!--
å¦‚æˆªå›¾ç­‰å…¶ä»–ä¿¡æ¯å¯ä»¥è´´åœ¨è¿™é‡Œ
-->

![å›¾ç‰‡](https://user-images.githubusercontent.com/49026458/106748244-e7187c80-665f-11eb-8bbb-d1d4565e09b0.png)

## chenshuai2144

å†™æ ‡é¢˜

## opamine

@chenshuai2144

## chenshuai2144

åº”è¯¥ä¸æ˜¯menuçš„é—®é¢˜æŠŠï¼Œè¿™ä¹ˆæå¾—å ç”¨ä¸è‡³äºã€‚ã€‚

ä½ ç”¨devtoolçš„ æ€§èƒ½å·¥å…·æä¸ªç«ç„°å›¾å‡ºæ¥

## opamine

![å›¾ç‰‡](https://user-images.githubusercontent.com/49026458/107134643-e832fd80-692e-11eb-81d6-f8452c2c16be.png)
![å›¾ç‰‡](https://user-images.githubusercontent.com/49026458/107134645-f123cf00-692e-11eb-8ad2-18f18e247485.png)
![å›¾ç‰‡](https://user-images.githubusercontent.com/49026458/107134654-0567cc00-692f-11eb-9466-98e7b00dedc6.png)
![å›¾ç‰‡](https://user-images.githubusercontent.com/49026458/107134656-0d277080-692f-11eb-970b-24a96fe223ed.png)

ğŸ–¥ï¸ : æˆ‘æ‰§è¡Œçš„æ˜¯ é—­åˆ -> å±•å¼€ -> é—­åˆ -> å±•å¼€

ğŸ§® : ä»¥ä¸Šå››å¼ å›¾æ˜¯ å‰ä¸¤æ­¥æ“ä½œçš„æˆªå›¾

## opamine

@chenshuai2144 å¤§å“¥æŸ¥æ”¶

## chenshuai2144

è¿™ä¸ªä¸è‡³äºé‚£ä¹ˆé«˜çš„cpuå ç”¨çš„ï¼Œchrome åœ¨å·å·å¹²åˆ«çš„äº‹æƒ…æŠŠ

ä½ è¯•è¯•ç”¨æˆ·ç”¨ç«ç‹

## opamine

> è¿™ä¸ªä¸è‡³äºé‚£ä¹ˆé«˜çš„cpuå ç”¨çš„ï¼Œchrome åœ¨å·å·å¹²åˆ«çš„äº‹æƒ…æŠŠ
>
> ä½ è¯•è¯•ç”¨æˆ·ç”¨ç«ç‹

æˆ‘è¿™è¾¹è¯•äº†ä¸‹ç«ç‹,ä¹Ÿæ˜¯è¿™æ ·ã€‚
è¿™è¾¹å¤§æ¦‚çŸ¥é“é—®é¢˜æ‰€åœ¨äº†ï¼Œ æˆ‘ç¨åæ•´ç†ä¸€ä¸‹å‘å‡ºæ¥

## opamine

"@ant-design/pro-layout": 6.14.0
"@ant-design/pro-table": 2.28.0

![å›¾ç‰‡](https://user-images.githubusercontent.com/49026458/107140937-8be8d180-6960-11eb-9c66-8f29d5937938.png)

æˆ‘è¿™è¾¹æŠŠ pro-table çš„ request å±æ€§å»æ‰, ä¸ä»æœåŠ¡å™¨è¯·æ±‚æ•°æ®ï¼Œ ä¸Šé¢çš„æƒ…å†µå°±ä¸å­˜åœ¨äº† â“

## opamine

> "@ant-design/pro-layout": 6.14.0
> "@ant-design/pro-table": 2.28.0
>
> ![å›¾ç‰‡](https://user-images.githubusercontent.com/49026458/107140937-8be8d180-6960-11eb-9c66-8f29d5937938.png)
>
> æˆ‘è¿™è¾¹æŠŠ pro-table çš„ request å±æ€§å»æ‰, ä¸ä»æœåŠ¡å™¨è¯·æ±‚æ•°æ®ï¼Œ ä¸Šé¢çš„æƒ…å†µå°±ä¸å­˜åœ¨äº† â“

å¥½åƒè¿˜ä¸æ˜¯è¿™ä¸ªåŸå› ï¼Œæˆ‘å†ç ”ç©¶ä¸€ä¸‹å§ï¼Œ

## chenshuai2144

chrome æœ‰è‡ªå·±çš„ä»»åŠ¡ç®¡ç†å™¨ï¼Œå»é‡Œé¢çœ‹çœ‹æŠŠ

## samotoo

ä½ å¥½ï¼Œ

è¿™è¾¹æœ‰ç±»ä¼¼çš„é—®é¢˜ï¼Œä¾§è¾¹æ menuå±•å¼€æ”¶èµ·åŠ¨ç”»æœ‰æ˜æ˜¾çš„å¡é¡¿ï¼ŒæŠŠProTableçš„scroll propå»æ‰ï¼Œå°±ä¸ä¼šå¡é¡¿äº†ï¼Œåº”è¯¥å¦‚ä½•è§£å†³å‘¢ï¼Ÿ
ä½¿ç”¨çš„ç»„ä»¶ç‰ˆæœ¬ï¼š
"@ant-design/pro-layout": "^6.21.0",
"@ant-design/pro-table": "^2.43.0",

## samotoo

è¿™ä¸ªé—®é¢˜è²Œä¼¼å’Œ#3113æ˜¯åŒä¸€ä¸ªé—®é¢˜ï¼Œé‚£ä¸ªissueé‡Œæç¤ºç”¨sCUæ¥è§£å†³æ›´æ–°é¢‘ç‡é«˜çš„é—®é¢˜ï¼Œè¯·é—®èƒ½å¦ç»™ä¸ªä¾‹å­è¯´æ˜ä¸€ä¸‹ã€‚
å®½åº¦å˜åŒ–å¯¼è‡´çš„æ›´æ–°å¹¶ä¸æ˜¯å› ä¸ºçˆ¶ç»„ä»¶ä¼ ç»™ProTableçš„propå˜åŒ–äº†ï¼Œè€Œæ˜¯å› ä¸ºProTableå†…éƒ¨çš„æ›´æ–°æœºåˆ¶ï¼Œè¯¥å¦‚ä½•ä»å¤–éƒ¨å»æ§åˆ¶è¿™ä¸ªå†…éƒ¨æœºåˆ¶å‘¢ï¼Ÿ

## qidasheng369

æœ‰åŒæ ·çš„é—®é¢˜ï¼Œèœå•å±•å¼€/æ”¶èµ·ï¼Œæ˜æ˜¾æœ‰å¡é¡¿ã€‚
ä½¿ç”¨çš„antdPro-smipleæ¶å­ï¼›
å¯¹åº”çš„ç‰ˆæœ¬åˆ†åˆ«ä¸ºprotableï¼š"^2.56.0",å’Œlayoutï¼š^6.26.0",
å…ˆåŸ‹ä¸ªå‘ï¼Œåç»­å®šä½é—®é¢˜ï¼Œåç­‰æœ‰å¤§ä½¬ç»™å‡ºè§£å†³æ–¹æ¡ˆã€‚ã€‚

## qidasheng369

å»æ‰scrollè¿™ä¸ªå®½åº¦çš„å±æ€§ä¹‹åï¼Œå°±å¾ˆæµç•…ï¼›ä¸ç¡®å®šæ˜¯ä¸æ˜¯è¿™ä¸ªå±æ€§å¯¼è‡´layoutéœ€è¦è®¡ç®—å®½åº¦ï¼Œäº§ç”Ÿçš„æ€§èƒ½é—®é¢˜ã€‚ã€‚

## microJ

å¦‚æœéœ€è¦ scroll æ¨ªå‘æ»šåŠ¨çš„æœ‹å‹ï¼Œå¯ä»¥å°è¯•ä½¿ç”¨ `scroll={{x: 'max-content'}}`ï¼Œæ¯” `scroll={{x: true}}` æ‰å¸§è¦å‡å°‘å¾ˆå¤šã€‚

## panyushan-jade

è¯·é—®è§£å†³äº†å˜›ï¼Œæˆ‘ä¹Ÿæœ‰è¿™ä¸ªé—®é¢˜ ğŸ™

## microJ

> è¯·é—®è§£å†³äº†å˜›ï¼Œæˆ‘ä¹Ÿæœ‰è¿™ä¸ªé—®é¢˜ ğŸ™

å‡çº§ç‰ˆæœ¬è¯•ä¸‹

## qingweiSun

ç°åœ¨ä¹Ÿè¿˜æ˜¯å¡å‘€

## chaovbz

scroll={{x: 120}}
