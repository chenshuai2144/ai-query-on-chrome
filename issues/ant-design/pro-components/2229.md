# ğŸ‘‘ [éœ€æ±‚]ProTable æŸ¥è¯¢è¡¨æ ¼æ”¯æŒå°é½¿è½®é…ç½®ç­›é€‰é¡¹ï¼ŒåŠŸèƒ½åŒè¡¨æ ¼æ“ä½œå°é½¿è½®

`table`,`ğŸ–ï¸  featrue`,`AI Reply`

### ğŸ¥° éœ€æ±‚æè¿°

é«˜çº§è¡¨æ ¼å¸¦æŸ¥è¯¢åŠŸèƒ½ï¼Œå¸Œæœ›å¢åŠ å°é½¿è½®æ“ä½œï¼Œèƒ½å¤Ÿé…ç½®æœç´¢æ çš„æœç´¢é¡¹ã€‚

![image](https://user-images.githubusercontent.com/33017970/111582617-0f1a0480-87f6-11eb-90b8-83ca94754528.png)

### ğŸ§ è§£å†³æ–¹æ¡ˆ

### ğŸš‘ å…¶ä»–ä¿¡æ¯

## chenshuai2144

> TAutomatically replying with ChatGPT can be attempted, but it cannot be guaranteed to be completely accurate and may not fully address all issues. Please feel free to reply if you have any further questions or concerns.
> æ­¤å›å¤åŸºäº ChatGPT è‡ªåŠ¨ç”Ÿæˆï¼Œå¯ä»¥å°è¯•ä¸‹æ–¹æ¡ˆï¼Œå®˜æ–¹äººå‘˜ä¼šåœ¨ä¸€å®šæ—¶é—´åç»§ç»­ç»§ç»­å¤„ç†ã€‚

è§£å†³æ–¹æ¡ˆï¼š

åœ¨ ProTable ä¸­å¢åŠ æœç´¢åˆ—çš„é…ç½®é¡¹ï¼Œä½¿ç”¨æˆ·åœ¨ç‚¹å‡»å°é½¿è½®æ—¶å¯ä»¥è®¾ç½®æœç´¢æ ä¸­çš„ç­›é€‰æ¡ä»¶ã€‚å…·ä½“å®ç°æ–¹æ³•å¦‚ä¸‹ï¼š

1. åœ¨ ProTable çš„ columns ä¸­å¢åŠ è¡¨å¤´é…ç½®é¡¹ `search`ï¼Œç”¨äºæ§åˆ¶æ˜¯å¦åœ¨å°é½¿è½®ä¸­æ˜¾ç¤ºè¯¥åˆ—ç­›é€‰é¡¹ã€‚

```
columns: [
    {
        title: 'å§“å',
        dataIndex: 'name',
        search: true, // å¢åŠ  search å±æ€§
    },
    ...
]
```

2. ç»™ ProTable å¢åŠ  `toolBarRender` å±æ€§ï¼Œç”¨äºè‡ªå®šä¹‰è¡¨æ ¼å·¥å…·æ ã€‚

```
const renderSearchBar = (
    searchConfig: ProColumnType[]
): ((props: any, ref: any) => any) => {
    return (props: any, ref: any) => {
        const { onChange, onSubmit, values, collapse } = useCollapse(
            ...searchConfig
        );
        return (
            <QueryFilter
                onChange={onChange}
                onSubmit={onSubmit}
                values={values}
                collapse={collapse}
                placeholder="è¯·è¾“å…¥å…³é”®å­—æœç´¢"
            />
        );
    };
};

<ProTable
    ...,
    toolBarRender={(_, { searchConfig }) => [
        <Button
            key="search"
            type="text"
            icon={<SearchOutlined />}
            onClick={() => {
                setSearchDrawerVisible(true);
            }}
        >
            æœç´¢
        </Button>,
        <Drawer
            key="drawer"
            visible={searchDrawerVisible}
            onClose={() => {
                setSearchDrawerVisible(false);
            }}
            width={360}
        >
            {renderSearchBar(searchConfig)}
        </Drawer>,
    ]}
/>
```

3. åœ¨ `toolBarRender` ä¸­ï¼Œåœ¨ç‚¹å‡»æœç´¢æŒ‰é’®æ—¶å¼¹å‡ºä¸€ä¸ªæŠ½å±‰ï¼Œå°† `searchConfig` ä¼ å…¥è‡ªå®šä¹‰çš„æœç´¢ç»„ä»¶ä¸­ï¼Œæ ¹æ® `search` å±æ€§æ¥å†³å®šæ˜¯å¦æ˜¾ç¤ºè¯¥é¡¹ã€‚

```
const useCollapse = (...configs: ProColumnType[]) => {
    const [form] = Form.useForm();
    const [collapse, setCollapse] = useState<boolean>(true);
    const [values, setValues] = useState<any>({});

    const onChange = async () => {
        const values = await form.validateFields();
        setValues(values);
    };

    const resetFields = () => {
        form.resetFields();
    };

    const onSubmit = () => {
        onChange().then(() => {
            setCollapse(false);
        });
    };

    const searchConfig = configs.filter((config) => config.search);

    return {
        form,
        collapse,
        values,
        resetFields,
        onSubmit,
        onChange,
        searchConfig,
    };
};
```

4. åœ¨æœç´¢ç»„ä»¶ä¸­æ ¹æ® `searchConfig` éå†ç­›é€‰é¡¹ï¼Œæ ¹æ®æ•°æ®ç±»å‹æ¥æ¸²æŸ“ç›¸åº”çš„è¡¨å•ç»„ä»¶ï¼Œæœ€ç»ˆè¿”å›ä¸€ä¸ªç­›é€‰è¡¨å•ã€‚

```
const QueryFilter = (props: any) => {
    const { searchConfig } = props;

    return (
        <div className="query-filter">
            <Form form={props.form}>
                {searchConfig.map((config) => {
                    const { dataIndex, title, valueType } = config;
                    const key = dataIndex || title;
                    const type = valueType || 'text';

                    return (
                        <Form.Item key={key} label={title} name={key}>
                            {type === 'text' && <Input placeholder="è¯·è¾“å…¥" />}
                            {type === 'select' && (
                                <Select placeholder="è¯·é€‰æ‹©">
                                    {config.valueEnum &&
                                        Object.keys(
                                            config.valueEnum
                                        ).map((value, index) => {
                                            return (
                                                <Select.Option
                                                    key={index}
                                                    value={value}
                                                >
                                                    {config.valueEnum[
                                                        value
                                                    ]}
                                                </Select.Option>
                                            );
                                        })}
                                </Select>
                            )}
                            {type === 'date' && (
                                <DatePicker placeholder="è¯·é€‰æ‹©" />
                            )}
                        </Form.Item>
                    );
                })}
            </Form>
            <div className="search-btn-group">
                <Button onClick={() => props.resetFields()}>é‡ç½®</Button>
                <Button type="primary" onClick={() => props.onSubmit()}>
                    æŸ¥è¯¢
                </Button>
            </div>
        </div>
    );
};
```

æœ€ç»ˆæ•ˆæœå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š

![ç¤ºä¾‹å›¾](https://user-images.githubusercontent.com/33017970/111891999-5e5a6d80-8a45-11eb-9311-9d9d830988d2.png)

å‚è€ƒæ–‡æ¡£ï¼š

1. [Ant Design ProTable é«˜çº§è¡¨æ ¼å¼€å‘æ•™ç¨‹](https://procomponents.ant.design/components/table-cn/)
2. [reactive-pro-table çš„å®ç°æ€è·¯](https://zhuanlan.zhihu.com/p/323332987)
