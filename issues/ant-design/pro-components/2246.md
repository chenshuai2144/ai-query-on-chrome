# ğŸ›[BUG] EditableProTable width é…åˆ fixed ä¸ç”Ÿæ•ˆ

`â­•ï¸   bug`,`table`

### ğŸ› bug æè¿°

è®¾ç½®äº†widthï¼Œä¸å›ºå®šåˆ—ï¼Œä½†æ˜¯æ€»é•¿åº¦è¶…å‡ºçš„æ—¶å€™ä¼šè‡ªé€‚åº”å®½åº¦ï¼Œæ— æ³•å®ç° protable çš„å›ºå®šåˆ—æ•ˆæœï¼Œå¯¼è‡´åˆ—æ•°è¾ƒå¤šæ—¶å±•ç¤ºå¼‚å¸¸

### ğŸ“· å¤ç°æ­¥éª¤

copyå®˜ç½‘çš„ editableProTable ç¤ºä¾‹ï¼Œcolumns ä¸­é¦–å°¾åˆ—å¢åŠ  widthï¼Œfixed é…ç½®ã€‚

### ğŸ æœŸæœ›ç»“æœ

é¦–åˆ—ä¸å°¾åˆ—å›ºå®šåœ¨ä¸¤ç«¯ï¼Œä¸éšæµè§ˆå™¨ç¼©æ”¾æ”¹å˜å®½åº¦ï¼Œä¸­é—´åˆ—å¯å·¦å³æ»‘åŠ¨ã€‚

### ğŸ’» å¤ç°ä»£ç 

```
import React, { useState } from 'react';
import type { ProColumns } from '@ant-design/pro-table';
import { EditableProTable, ColumnsState } from '@ant-design/pro-table';
import ProField from '@ant-design/pro-field';
import ProCard from '@ant-design/pro-card';
import { Button } from 'antd';
type DataSourceType = {
  id: React.Key;
  title?: string;
  decs?: string;
  state?: string;
  created_at?: string;
  children?: DataSourceType[];
};
const defaultData: DataSourceType[] = [
  {
    id: 624748504,
    title: 'æ´»åŠ¨åç§°ä¸€',
    decs: 'è¿™ä¸ªæ´»åŠ¨çœŸå¥½ç©',
    state: 'open',
    created_at: '2020-05-26T09:42:56Z',
  },
  {
    id: 624691229,
    title: 'æ´»åŠ¨åç§°äºŒ',
    decs: 'è¿™ä¸ªæ´»åŠ¨çœŸå¥½ç©',
    state: 'closed',
    created_at: '2020-05-26T08:19:22Z',
  },
];
export default () => {
  const [editableKeys, setEditableRowKeys] = useState<React.Key[]>(() => defaultData.map((item) => item.id));
  const [dataSource, setDataSource] = useState<DataSourceType[]>(() => defaultData);
  const [columnsStateMap, setColumnsStateMap] = useState<{
    [key: string]: ColumnsState;
  }>({
    title: {
      show: false,
      fixed: 'right',
    },
    option: {
      show: true,
      fixed: 'left',
    },
  });
  const columns: ProColumns<DataSourceType>[] = [
    {
      title: 'æ´»åŠ¨åç§°',
      dataIndex: 'title',
      fixed: 'right',
      width: 650,
    },
    {
      title: 'çŠ¶æ€',
      key: 'state',
      width: 750,
      dataIndex: 'state',
      valueType: 'select',
      valueEnum: {
        all: { text: 'å…¨éƒ¨', status: 'Default' },
        open: {
          text: 'æœªè§£å†³',
          status: 'Error',
        },
        closed: {
          text: 'å·²è§£å†³',
          status: 'Success',
        },
      },
    },
    {
      title: 'æè¿°',
      dataIndex: 'decs',
      width: 750,
    },
    {
      title: 'æ“ä½œ',
      valueType: 'option',
      fixed: 'left',
      width: 650,
      render: () => {
        return null;
      },
    },
  ];
  return (
    <>
      <EditableProTable
        headerTitle="å¯ç¼–è¾‘è¡¨æ ¼"
        columns={columns}
        rowKey="id"
        value={dataSource}
        onChange={setDataSource}
        columnsStateMap={columnsStateMap}
        onColumnsStateChange={map => setColumnsStateMap(map)}
        recordCreatorProps={{
          newRecordType: 'dataSource',
          record: () => ({
            id: Date.now(),
          }),
        }}
        toolBarRender={() => {
          return [
            <Button
              type="primary"
              key="save"
              onClick={() => {
                // dataSource å°±æ˜¯å½“å‰æ•°æ®ï¼Œå¯ä»¥è°ƒç”¨ api å°†å…¶ä¿å­˜
                console.log(dataSource);
              }}
            >
              ä¿å­˜æ•°æ®
            </Button>,
          ];
        }}
        editable={{
          type: 'multiple',
          editableKeys,
          actionRender: (row, config, defaultDoms) => {
            return [defaultDoms.delete];
          },
          onValuesChange: (record, recordList) => {
            setDataSource(recordList);
          },
          onChange: (...params) => {
            console.log('change params', params);
            setEditableRowKeys(params[0]);
            setDataSource(params[1]);
          },
        }}
      />
      <ProCard title="è¡¨æ ¼æ•°æ®" headerBordered collapsible defaultCollapsed>
        <ProField
          fieldProps={{
            style: {
              width: '100%',
            },
          }}
          mode="read"
          valueType="jsonCode"
          text={JSON.stringify(dataSource)}
        />
      </ProCard>
    </>
  );
};
```

### Â© ç‰ˆæœ¬ä¿¡æ¯

- ProTable ç‰ˆæœ¬: [e.g. 2.30.6]
- antd 4.14.0
- umi ç‰ˆæœ¬ 3.3.5
- æµè§ˆå™¨ç¯å¢ƒ chrome 88.0.4324.192ï¼ˆæ­£å¼ç‰ˆæœ¬ï¼‰ (x86_64)
- å¼€å‘ç¯å¢ƒ [e.g. mac OS]

### ğŸš‘ å…¶ä»–ä¿¡æ¯

![image](https://user-images.githubusercontent.com/37355850/111735442-02111a00-88b7-11eb-8aed-3b309dc99e8a.png)

## xiefengnian

è¿™ä¸ª bug å…³è”çš„é—®é¢˜æ¯”è¾ƒå¤§ã€‚proTable ç”¨çš„æ˜¯ antd çš„ tableï¼Œåœ¨ antd ä¸­å¦‚æœ table çš„åˆ—ä¸º inputï¼ŒåŒæ ·çš„ï¼Œwidth æ— æ³•å‘æŒ¥ä½œç”¨ã€‚

è§£å†³åŠæ³•æ˜¯å¯ä»¥é€šè¿‡ formItemProp å‘ input æ³¨å…¥å®½åº¦è§£å†³ã€‚

```ts
{
  title: 'æè¿°',
  dataIndex: 'decs',
  /* width: 500, */
  formItemProps: {
    style: { width: 500 },
  },
},
```

relatedï¼šhttps://github.com/ant-design/ant-design/issues/13825#issuecomment-449889241

## lovesly

> è¿™ä¸ª bug å…³è”çš„é—®é¢˜æ¯”è¾ƒå¤§ã€‚proTable ç”¨çš„æ˜¯ antd çš„ tableï¼Œåœ¨ antd ä¸­å¦‚æœ table çš„åˆ—ä¸º inputï¼ŒåŒæ ·çš„ï¼Œwidth æ— æ³•å‘æŒ¥ä½œç”¨ã€‚
>
> è§£å†³åŠæ³•æ˜¯å¯ä»¥é€šè¿‡ formItemProp å‘ input æ³¨å…¥å®½åº¦è§£å†³ã€‚
>
> ```ts
> {
>   title: 'æè¿°',
>   dataIndex: 'decs',
>   /* width: 500, */
>   formItemProps: {
>     style: { width: 500 },
>   },
> },
> ```
>
> relatedï¼š[ant-design/ant-design#13825 (comment)](https://github.com/ant-design/ant-design/issues/13825#issuecomment-449889241)

æ€ä¹ˆç›´æ¥å…³æ‰äº†ï¼Œæ•ˆæœä¸å¤ªè¡Œï¼Œæ ·å¼å®Œå…¨ä¹±äº†ã€‚å½“æˆ‘ä½¿ç”¨è‡ªå®šä¹‰çš„è¡¨å•ç¼–è¾‘ç»„ä»¶çš„æ—¶å€™ï¼Œè¿™æ ·çš„è®¾ç½®ä¹Ÿæ˜¯æ— æ•ˆçš„ã€‚ä½ èƒ½è´´ä¸€æ®µä½¿ç”¨ EditableProTable ç”Ÿæ•ˆçš„ä»£ç å—ï¼Ÿ

## chenshuai2144

è‡ªå®šä¹‰ç¼–è¾‘çš„æ—¶å€™ï¼Œä½ å¯ä»¥ç›´æ¥æ§åˆ¶å®½åº¦å§

## lovesly

> è‡ªå®šä¹‰ç¼–è¾‘çš„æ—¶å€™ï¼Œä½ å¯ä»¥ç›´æ¥æ§åˆ¶å®½åº¦å§

å›å¤´ç»™ä½ ä¸ªdemoï¼Œwidth æ˜¯ç”Ÿæ•ˆçš„ï¼Œä½†æ˜¯ table ä¼šè¶…é•¿ï¼Œä¸­é—´åˆ—çš„æ»‘åŠ¨ä¹Ÿæœ‰ç‚¹é—®é¢˜ã€‚

## lovesly

æˆ‘å¤§æ¦‚çŸ¥é“æ€ä¹ˆå›äº‹äº†ï¼Œä¸»è¦æ˜¯ä¸¤ä¸ªé—®é¢˜ï¼š

1. formItem width ä¸ç”Ÿæ•ˆï¼Œä½¿ç”¨ fromItemProps ä¼ å…¥é…ç½®ï¼Œå¦‚æœåŒæ—¶ä¼ å…¥ rulesï¼Œå’Œ styleï¼Œstyle å°±æ²¡æœ‰è¢«è·å–åˆ°ã€‚
2. editableProTable çš„å¤–å±‚ï¼Œ.ant-table-content è¿™ä¸ªå…ƒç´ å°‘ä¸€ä¸ª overflow-x: autoï¼Œæ‰€ä»¥å¦‚æœ1ç”Ÿæ•ˆäº†ï¼Œå¹¶ä¸”æ€»é•¿åº¦è¶…å‡ºå®¹å™¨ï¼Œå³ä¾§å°±é¡¶å‡ºå»äº†ã€‚

## xXAvoraXx

not working when formItemProps width
