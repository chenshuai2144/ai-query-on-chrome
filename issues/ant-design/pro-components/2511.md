# 🐛[BUG] ProLayout 当父级菜单与子菜单相似匹配时，菜单选中多个

### 🐛 bug 描述

见 [复现代码](https://codesandbox.io/s/pro-layout-menu-bug-z42gr) 菜单: `Project`, `Setting > Members` 被选中.
调试查看 `<Menu />` 组件 `selectedKeys` 属性值不应该是 `["/project","/project/setting/members"]`.

```
  const menus = [
    {
      path: "/project",  // 父菜单链接
      exact: true,
      name: "Project"
    },
    {
      name: "Setting",
      children: [
        {
          name: "Members",
          path: "/project/setting/members",  // 子菜单链接
          exact: true
        },
        {
          name: "Roles",
          path: "/project/setting/roles",
          exact: true
        }
      ]
    }
  ];
```

```
<Menu selectedKeys={["/project","/project/setting/members"]} ... />
```

### 📷 复现步骤

https://codesandbox.io/s/pro-layout-menu-bug-z42gr

### 🏞 期望结果

https://github.com/ant-design/pro-components/blob/master/packages/layout/src/BasicLayout.tsx#L327-L329

`matchMenus` 值应该只有 `"/project/setting/members"`.

```
<Menu selectedKeys={["/project/setting/members"]} ... />
```

### 💻 复现代码

https://codesandbox.io/s/pro-layout-menu-bug-z42gr

### © 版本信息

- @ant-design/pro-layout: 6.16.2

### 🚑 其他信息

![image](https://user-images.githubusercontent.com/2050694/114900690-b49cb400-9e46-11eb-92eb-c5b40862281e.png)

## Moln

其它类似问题: #1001 #1002

## chenshuai2144

这个是featrue，我们是通过路径的相关性来计算选中的。我觉得你的菜单设置是有问题的。
/project 应该是 project/home 之类的，而不是一个超级大的父亲最为平级节点。

当然也是有解决办法的，就是设置不同的key，我们会优先使用key

## oyhk

@chenshuai2144 具体代码是怎么实现的呢？为什么我加了key还是会选中多个菜单

## oyhk

@chenshuai2144 代码如下，麻烦指导一下，这两个菜单是平级的，但是111是代表一个动态id

```
    {
      name: '工作台',
      path: '/111',
      component: '@/pages/index',
      key:'workbench',
      exact:true,
    },
    // 菜品管理
    {
      name: '菜品管理',
      path: '/111/dishes',
      component: '@/pages/dishes/dishesIndex',
      access: 'role',
      exact:true,
      key:'dishes',
    },
```

## chenshuai2144

调换一下顺序呢？

## oyhk

@chenshuai2144 试过了

## chenshuai2144

能给个仓库吗？ 我debug一下算法

## oyhk

@chenshuai2144 暂时没有

## cuijiudai

> 这个是featrue，我们是通过路径的相关性来计算选中的。我觉得你的菜单设置是有问题的。 /project 应该是 project/home 之类的，而不是一个超级大的父亲最为平级节点。
>
> 当然也是有解决办法的，就是设置不同的key，我们会优先使用key

能关掉这个feature 吗，上下级应该根据routes 的嵌套来确定。设置了key，没有作用

## cuijiudai

@oyhk 实现出来了吗？
