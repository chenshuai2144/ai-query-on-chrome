# ğŸ§[é—®é¢˜] ProFormList ç»„ä»¶ä¸­ä½¿ç”¨ProFormDependency åš ProFormSelectè”åŠ¨å¦‚ä½•æ¸…ç†å·²ç»é€‰ä¸­çš„å€¼

### ğŸ§ é—®é¢˜ ProFormList ç»„ä»¶ä¸­ä½¿ç”¨ProFormDependency åš ProFormSelectè”åŠ¨å¦‚ä½•æ¸…ç†å·²ç»é€‰ä¸­çš„å€¼

ProFormList é‡Œé¢åµŒå¥—äº† ProFormSelect å’Œ ProFormDependency åšè”åŠ¨ï¼Œ å½“ç¬¬ä¸€ä¸ªProFormSelect æ”¹å˜é€‰æ‹©å€¼çš„æ—¶å€™, ç¬¬äºŒä¸ªProFormSelect é‡Œé¢å·²ç»é€‰æ‹©çš„å€¼è¿˜å­˜åœ¨æ²¡æœ‰è¢«æ¸…ç©ºã€‚ æ˜¯å¦æ˜¯å› ä¸º form é‡Œé¢ä¹‹å‰é€‰æ‹©çš„æ•°æ®è¿˜å­˜åœ¨ï¼Ÿ è¯¥å¦‚ä½•æ¸…ç†ï¼Ÿ å› ä¸ºåœ¨ProFormDependencyæ— æ³•æ‹¿åˆ°å½“å‰index æ‰€æœ‰ä¹Ÿä¸å¥½åœ¨ form è·å–æ•°æ®æ¥åˆ é™¤ FieldsValue ä¸­çš„æ•°æ®

## chenshuai2144

```
<ProFormList >
   {(filed)=><ProFormDependency />}
</ProFormList >
```

ç”¨è¿™ç§æ–¹å¼å§ï¼Œä¹Ÿæ˜¯æ”¯æŒè‡ªåŠ¨filedæ³¨å…¥çš„

## zanmeipaul

@chenshuai2144 æˆ‘ç›®å‰å°±æ˜¯ç”¨è¿™ç§æ–¹å¼çš„ï¼Œé—®é¢˜åœ¨äºï¼Œæˆ‘æ”¹å˜äº† ProFormDependency é‡Œé¢çš„ ProFormSelect åˆ—è¡¨æ•°æ®ï¼Œå¯æ˜¯ä¹‹å‰é€‰ä¸­çš„æ•°æ®è¿˜åœ¨ï¼Œå¦‚æœProFormDependency é‡Œé¢è¡¨å•çš„ç»„ä»¶æ˜¯æ ¹æ®è”åŠ¨é€‰æ‹©çš„å­—æ®µå˜åŠ¨çš„è¯ã€‚ å› ä¹‹å‰é€‰æ‹©çš„æ•°æ®è¿˜åœ¨ï¼ŒProFormDependencyé‡Œé¢æ”¹å˜æˆæ–°çš„ç»„ä»¶ï¼Œæ•°æ®ä¸å…¼å®¹å°±ä¼šå‡ºé”™ã€‚ æ‰€æœ‰æˆ‘æœ‰ä¸€ä¸ªç–‘é—®ï¼Œå½“ ProFormDependency é‡æ–°æ¸²æŸ“çš„æ—¶å€™ï¼Œä¹‹å‰é€‰æ‹©çš„ form.getFieldValue ä¸­æ•°æ®å¦‚ä½•æŒ‡å®š ProFormList ä¸­æŸä¸€æ¡æ•°æ®æŸä¸€ä¸ªå­—æ®µç½®ç©ºï¼Œè¿™æ ·é¿å…æŠ¥é”™

## zanmeipaul

@chenshuai2144 æˆ‘ä½¿ç”¨ä½ æä¾›çš„ `<ProFormList >
     {(filed)=><ProFormDependency />}
</ProFormList >` åœ¨ ProFormList åµŒå¥—çš„æ—¶å€™ï¼Œå¥½åƒæœ‰é—®é¢˜ï¼Œæ˜¾ç¤ºä¸å‡ºæ¥ã€‚

## LoveEocding

åŒæ ·çš„åœºæ™¯ æœ‰è§£å†³æ–¹æ¡ˆå—ã€‚è¿™ç§åœºæ™¯è¿˜æ˜¯æŒºå¸¸è§çš„å§

## LoveEocding

> ### ğŸ§ é—®é¢˜ ProFormList ç»„ä»¶ä¸­ä½¿ç”¨ProFormDependency åš ProFormSelectè”åŠ¨å¦‚ä½•æ¸…ç†å·²ç»é€‰ä¸­çš„å€¼
>
> ProFormList é‡Œé¢åµŒå¥—äº† ProFormSelect å’Œ ProFormDependency åšè”åŠ¨ï¼Œ å½“ç¬¬ä¸€ä¸ªProFormSelect æ”¹å˜é€‰æ‹©å€¼çš„æ—¶å€™, ç¬¬äºŒä¸ªProFormSelect é‡Œé¢å·²ç»é€‰æ‹©çš„å€¼è¿˜å­˜åœ¨æ²¡æœ‰è¢«æ¸…ç©ºã€‚ æ˜¯å¦æ˜¯å› ä¸º form é‡Œé¢ä¹‹å‰é€‰æ‹©çš„æ•°æ®è¿˜å­˜åœ¨ï¼Ÿ è¯¥å¦‚ä½•æ¸…ç†ï¼Ÿ å› ä¸ºåœ¨ProFormDependencyæ— æ³•æ‹¿åˆ°å½“å‰index æ‰€æœ‰ä¹Ÿä¸å¥½åœ¨ form è·å–æ•°æ®æ¥åˆ é™¤ FieldsValue ä¸­çš„æ•°æ®

è¯·é—®æ‰¾åˆ°è§£å†³æ–¹æ¡ˆäº†å— åŒæ ·çš„åœºæ™¯ã€‚

## darkfiredarkhalo

çš„ç¡®æ˜¯ä¸ªæ¯”è¾ƒéº»çƒ¦çš„é—®é¢˜, å®˜ç½‘çš„ä¾‹å­ä¹Ÿä¸èƒ½åšåˆ°Dependencyå˜åŒ–æ¸…ç©ºåŸå€¼, åªèƒ½æŠŠselectçš„valueè®¾ç½®ä¸ºå—æ§çš„, æŒºéº»çƒ¦çš„

## darkfiredarkhalo

> ```
> <ProFormList >
>      {(filed)=><ProFormDependency />}
> </ProFormList >
> ```
>
> ç”¨è¿™ç§æ–¹å¼å§ï¼Œä¹Ÿæ˜¯æ”¯æŒè‡ªåŠ¨filedæ³¨å…¥çš„

å®ç°ä¸äº†`Dependencyå˜åŒ–æ¸…ç©ºåŸå€¼`çš„éœ€æ±‚

## Eileen-v

é‡åˆ°äº†åŒæ ·çš„é—®é¢˜ï¼Œè¯·é—®å¤§å®¶æ˜¯å¦‚ä½•è§£å†³çš„å‘€

## zanmeipaul

> é‡åˆ°åŒæ ·çš„é—®é¢˜ï¼Œè¯·é—®å¤§å®¶æ˜¯å¦‚ä½•è§£å†³çš„å‘€
> æˆ‘å¿˜äº†æ€ä¹ˆè§£å†³äº†ï¼Œæ—¶é—´æ¯”è¾ƒé•¿äº†ã€‚ æˆ‘æŠŠä»£ç ç²˜è´´ç»™ä½ ï¼Œä½ æœ‰éœ€è¦å°±çœ‹ä¸€ä¸‹æ‰¾æ‰¾çµæ„Ÿ

```
<ProForm.Group>
          <ProFormList
            name="rules"
            label="è§„åˆ™"
            creatorButtonProps={{
              creatorButtonText: 'æ–°å¢ORå…³ç³»è§„åˆ™',
            }}
            itemRender={({ listDom, action }, { record, fields, index }) => {
              return (
                <>
                  <ProCard
                    bordered
                    extra={action}
                    title={record?.name}
                    style={{
                      marginBottom: 8,
                    }}
                  >
                    {listDom}
                  </ProCard>
                  {fields.length !== index + 1 && <span style={{ color: 'red' }}>OR</span>}
                </>
              );
            }}
          >
            <></>
            {(filedOr, indexOr: any) => {
              return (
                <ProFormList
                  name="or"
                  label="ANDè§„åˆ™ä¿¡æ¯"
                  copyIconProps={{
                    tooltipText: 'å¤åˆ¶',
                  }}
                  deleteIconProps={{
                    tooltipText: 'åˆ é™¤',
                  }}
                  creatorButtonProps={{
                    creatorButtonText: 'æ–°å¢ANDå…³ç³»è§„åˆ™',
                  }}
                  itemContainerRender={(doms) => {
                    return <ProForm.Group>{doms}</ProForm.Group>;
                  }}
                >
                  <ProFormSelect
                    name="decisionCode"
                    label="å†³ç­–å˜é‡"
                    request={async () => {
                      return props?.initDecisionData?.map((d: any) => {
                        return { label: d?.decisionName, value: d?.decisionCode };
                      });
                    }}
                    placeholder="è¯·é€‰æ‹©å†³ç­–å˜é‡"
                    rules={[{ required: true, message: 'è¯·é€‰æ‹©å†³ç­–å˜é‡' }]}
                  />
                  {(filed: any, index: any) => {
                    let isRow: boolean = false;
                    if (
                      rulesIndex.length > indexOr &&
                      rulesIndex[indexOr].length > index &&
                      rulesIndex[indexOr][index] === filed?.key
                    ) {
                      // æœ¬è¡Œæ”¹å˜
                      isRow = true;
                    } else {
                      if (rulesIndex.length > indexOr && rulesIndex[indexOr].length > index) {
                        rulesIndex[indexOr][index] = filed?.key;
                      } else if (rulesIndex.length > indexOr) {
                        rulesIndex[indexOr].splice(index, 0, filed?.key);
                      } else {
                        const d = [filed?.key];
                        rulesIndex.splice(indexOr, 0, d);
                      }
                    }

                    return (
                      <>
                        <ProFormDependency name={['decisionCode']}>
                          {(_, form) => {
                            const ruleItem = form.getFieldValue('rules')[indexOr]?.or[index];

                            return (
                              <ProFormSelect
                                name="operator"
                                label="ç¬¦å·"
                                params={{
                                  rulesOrIndex: indexOr,
                                  rulesAndIndex: index,
                                  decisionCode: ruleItem?.decisionCode,
                                }}
                                request={(value) => {
                                  console.log('operator request æ‰§è¡Œ;', isRow, value);
                                  if (isRow) {
                                    const rulesData = form.getFieldValue('rules');
                                    rulesData[value?.rulesOrIndex]['or'][value?.rulesAndIndex][
                                      'operator'
                                    ] = undefined;
                                    rulesData[value?.rulesOrIndex]['or'][value?.rulesAndIndex][
                                      'value'
                                    ] = undefined;
                                    form.setFieldsValue({ rules: rulesData });
                                  }

                                  if (value?.decisionCode) {
                                    const ar = props?.initDecisionData?.find(
                                      (elem: any) => elem?.decisionCode === value?.decisionCode,
                                    );

                                    return JSON.parse(ar?.operator);
                                  } else {
                                    return [];
                                  }
                                }}
                                placeholder="è¯·é€‰æ‹©ç¬¦å·"
                                rules={[{ required: true, message: 'è¯·é€‰æ‹©ç¬¦å·' }]}
                              />
                            );
                          }}
                        </ProFormDependency>

                        <ProFormDependency name={['decisionCode']}>
                          {(_, form) => {
                            const ruleItem = form.getFieldValue('rules')[indexOr]?.or[index];
                            const ar = props?.initDecisionData?.find(
                              (elem: any) => elem?.decisionCode === ruleItem?.decisionCode,
                            );

                            if (ar?.valueType === '00') {
                              //æ–‡æœ¬
                              return (
                                <ProFormText
                                  name="value"
                                  label="å€¼"
                                  rules={[{ required: true, message: 'è¯·è¾“å…¥å€¼' }]}
                                />
                              );
                            } else if (ar?.valueType === '01') {
                              //è¾“å…¥æ•°å­—
                              return (
                                <ProFormDigit
                                  name="value"
                                  label="å€¼"
                                  rules={[{ required: true, message: 'è¯·è¾“å…¥å€¼' }]}
                                />
                              );
                            } else if (ar?.valueType === '02') {
                              // ä¸‹æ‹‰é€‰æ‹©
                              return (
                                <ProFormSelect
                                  name="value"
                                  label="å€¼"
                                  rules={[{ required: true, message: 'è¯·è¾“å…¥å€¼' }]}
                                  placeholder="è¯·é€‰æ‹©å€¼"
                                  params={{
                                    decisionCode: ar?.decisionCode,
                                    valueSource: ar?.valueSource,
                                  }}
                                  request={async (value) => {
                                    return await getChannelDecisionValues(value);
                                  }}
                                />
                              );
                            } else if (ar?.valueType === '03') {
                              console.log('moment', moment('12:08:23', 'HH:mm:ss'));
                              // æ—¥æœŸ
                              return (
                                <ProFormTimePicker.RangePicker
                                  name="value"
                                  label="å€¼"
                                  rules={[{ required: true, message: 'è¯·è¾“å…¥å€¼' }]}
                                  fieldProps={{
                                    format: 'HH:mm:ss',
                                  }}
                                />
                              );
                            } else if (ar?.valueType === '04') {
                              // å¤šä¸ªè¾“å…¥å€¼æ–‡æœ¬æ¡†
                              return (
                                <ProFormSelect
                                  name="value"
                                  label="å€¼"
                                  mode="tags"
                                  width="sm"
                                  fieldProps={{
                                    open: false,
                                  }}
                                />
                              );
                            } else if (ar?.valueType === '05') {
                              // å¤šä¸ªè¾“å…¥å€¼ä¸‹æ‹‰æ¡†
                              return (
                                <ProFormSelect
                                  name="value"
                                  label="å€¼"
                                  mode="multiple"
                                  rules={[{ required: true, message: 'è¯·è¾“å…¥å€¼' }]}
                                  placeholder="è¯·é€‰æ‹©å€¼"
                                  params={{
                                    decisionCode: ar?.decisionCode,
                                    valueSource: ar?.valueSource,
                                  }}
                                  request={async (value) => {
                                    return await getChannelDecisionValues(value);
                                  }}
                                />
                              );
                            }

                            return (
                              <ProFormText
                                name="value"
                                label="å€¼"
                                rules={[{ required: true, message: 'è¯·è¾“å…¥å€¼' }]}
                              />
                            );
                          }}
                        </ProFormDependency>
                      </>
                    );
                  }}
                </ProFormList>
              );
            }}
          </ProFormList>
        </ProForm.Group>
```

æ•ˆæœå°±æ˜¯è¿™æ ·
<img width="723" alt="image" src="https://github.com/ant-design/pro-components/assets/20592867/cfcd1a8f-6d18-4b16-8bdc-d63b73442a23">

## ScotchPie

é‡åˆ°äº†ç±»ä¼¼çš„é—®é¢˜ï¼Œè§£å†³æ€è·¯å¤§è‡´å¦‚ä¸‹ï¼Œå¯ä»¥å‚è€ƒä¸€ä¸‹
![æ— æ ‡é¢˜](https://github.com/ant-design/pro-components/assets/109577566/ceee16ae-0d50-4739-8133-574d7ae62986)
