# ğŸ§[é—®é¢˜] SchemaForm layoutType="StepsForm"æ—¶ï¼Œå®˜æ–¹æ–‡æ¡£å¹¶ä¸æ”¯æŒstepsFormRenderï¼Œsubmitterå±æ€§ ä½†æ˜¯æˆ‘å†™å‡ºæ¥åç”Ÿæ•ˆäº†

`ğŸ–ï¸  featrue`,`AI Reply`

æé—®å‰å…ˆçœ‹çœ‹ï¼š

https://github.com/ryanhanwu/How-To-Ask-Questions-The-Smart-Way/blob/main/README-zh_CN.md

### ğŸ§ é—®é¢˜æè¿°

SchemaForm layoutType="StepsForm"æ—¶ï¼Œå®˜æ–¹æ–‡æ¡£å¹¶ä¸æ”¯æŒstepsFormRenderï¼Œsubmitterå±æ€§ ä½†æ˜¯æˆ‘å†™å‡ºæ¥åç”Ÿæ•ˆäº†
åœ¨SchemaForm å†™å‡ºStepsFormçš„å±æ€§èƒ½å¤Ÿç”Ÿæ•ˆï¼Œå› ä¸ºå®˜æ–¹æ–‡æ¡£æ²¡å†™å‡ºæ¥ï¼Œå¹¶ä¸”tsæ£€æµ‹æŠ¥é”™ï¼Œçœ‹ä¸€å±‚æºç ï¼Œå¹¶æ²¡æœ‰è¿™ä¸ªå±æ€§ï¼Œè¯·é—®åé¢çš„ç‰ˆæœ¬è·Ÿæ–°ä¼šä¸ä¼šåˆ°æ—¶æˆ‘è¿™ç§å†™æ³•ä¸ç”Ÿæ•ˆï¼Ÿ

### ğŸ’» ç¤ºä¾‹ä»£ç 

```
  <BetaSchemaForm
          layoutType="StepsForm"
          steps={[
            {
              title: 'ç¬¬ä¸€æ­¥',
            },
            {
              title: 'ç¬¬äºŒæ­¥',
            },
            {
              title: 'ç¬¬ä¸‰æ­¥',
            },
          ]}

          submitter={{
            render: (
              props: SubmitterProps<Record<string, any>> & {
                step: number;
                onPre: () => void;
                form?: FormInstance<any> | undefined;
              } & {
                submit: () => void;
                reset: () => void;
              },
            ) => {
              if (props.step === 0) {
                return (
                  <Button type="primary" onClick={() => props.onSubmit?.()}>
                    å»ç¬¬äºŒæ­¥ {'>'}
                  </Button>
                );
              }
            stepsFormRender={(dom, submitter) => {
                return (
                  <Modal
                    title="åˆ†æ­¥è¡¨å•"
                    width={800}
                    onCancel={() => setVisible(false)}
                    visible={visible}
                    footer={submitter}
                    destroyOnClose
                  >
                    {dom}
                  </Modal>
                );
              }}
              if (props.step === 1) {
                return [
                  <Button key="pre" onClick={() => props.onPre?.()}>
                    è¿”å›ç¬¬ä¸€æ­¥
                  </Button>,
                  <Button type="primary" key="goToTree" onClick={() => props.onSubmit?.()}>
                    å»ç¬¬ä¸‰æ­¥ {'>'}
                  </Button>,
                ];
              }

              return [
                <Button key="gotoTwo" onClick={() => props.onPre?.()}>
                  {'<'} è¿”å›ç¬¬äºŒæ­¥
                </Button>,
                <Button type="primary" key="goToTree" onClick={() => props.onSubmit?.()}>
                  æäº¤ âˆš
                </Button>,
              ];
            },
          }}
          onFinish={async (values) => {
            console.log(values);
          }}
          columns={columnSteps}
        />
```

### ğŸš‘ å…¶ä»–ä¿¡æ¯

![image](https://user-images.githubusercontent.com/61341868/142750212-e81174be-4384-48ca-90c0-e5d687ebeb48.png)

## Lands-1203

æˆ‘ä¸å¤ªå–œæ¬¢ç”¨htmlæ–¹å¼å†™è¡¨å•ï¼Œè€Œæ˜¯å€¾å‘äºjsoné…ç½®è¡¨å•

## chenshuai2144

ä½ å¯ä»¥å¸®å¿™å†™ä¸ªç±»å‹å’Œæµ‹è¯•ç”¨ä¾‹ã€‚æœ‰äº†æµ‹è¯•ç”¨ä¾‹çš„åŠŸèƒ½å°±åˆ é™¤ä¸äº†äº†

## Lands-1203

> ä½ å¯ä»¥å¸®å¿™å†™ä¸ªç±»å‹å’Œæµ‹è¯•ç”¨ä¾‹ã€‚æœ‰äº†æµ‹è¯•ç”¨ä¾‹çš„åŠŸèƒ½å°±åˆ é™¤ä¸äº†äº†

https://codesandbox.io/s/schema-biao-dan-forked-x8xon?file=/App.tsx
æ—¶è¿™ä¸ªæ„æ€å˜›ï¼Ÿ

## chenshuai2144

æ˜¯æŠŠæˆ‘ä»¬çš„é¡¹ç›®æ‹‰ä¸‹æ¥ï¼Œå¢åŠ ä¸ªåŠŸèƒ½è¿›å»

## 8283792

@chenshuai2144 ä½ å¥½ï¼Œ
![image](https://user-images.githubusercontent.com/23225531/154624061-fe983d9c-253b-418d-b40d-849f0067b15d.png)
ä¸Šè¿°ä¾‹å­ä¸­æ·»åŠ formRefå±æ€§ï¼ŒformRefé‡Œé¢çš„æ–¹æ³•ä¸ç”Ÿæ•ˆ

## 8283792

@chenshuai2144 æˆ‘éœ€è¦å®ç°åœ¨æ­¥éª¤è¡¨å•ä¸­æ¯æ¬¡ç‚¹å‡»ä¸‹ä¸€æ­¥è·å–å½“å‰è¡¨å•çš„å€¼

## chenshuai2144

å¸®å¿™å†™ä¸ªæµ‹è¯•ç”¨ä¾‹æŠŠï¼Œæ²¡æœ‰è¿™ä¸ªæµ‹è¯•ç”¨ä¾‹ï¼Œä¿®æ”¹çš„æ—¶å€™å°±ä¸ä¸€å®šèƒ½æ”¹å¯¹

## Lands-1203

> @chenshuai2144 æˆ‘éœ€è¦å®ç°åœ¨æ­¥éª¤è¡¨å•ä¸­æ¯æ¬¡ç‚¹å‡»ä¸‹ä¸€æ­¥è·å–å½“å‰è¡¨å•çš„å€¼

å†™é”™äº†

åœ¨layoutype=â€œstepsFormâ€æ—¶ï¼Œåªæœ‰é€šè¿‡

```
const formMapRef = useRef<React.MutableRefObject<ProFormInstance<any> | undefined>[]>([]);
  <BetaSchemaForm<Record<string, any>>
      formMapRef={formMapRef}
```

è¿™æ ·æ‰èƒ½æ‹¿åˆ°å€¼ï¼ŒformMapRef.currentè¿™é‡Œé¢æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œæ¯ä¸ªæ•°ç»„å¯¹åº”æ¯ä¸ªåˆ†å¸ƒè¡¨å•formRef

## chenshuai2144

> TAutomatically replying with ChatGPT can be attempted, but it cannot be guaranteed to be completely accurate and may not fully address all issues. Please feel free to reply if you have any further questions or concerns.
> æ­¤å›å¤åŸºäº ChatGPT è‡ªåŠ¨ç”Ÿæˆï¼Œå¯ä»¥å°è¯•ä¸‹æ–¹æ¡ˆï¼Œå®˜æ–¹äººå‘˜ä¼šåœ¨ä¸€å®šæ—¶é—´åç»§ç»­ç»§ç»­å¤„ç†ã€‚

å¥½çš„ï¼Œé‚£æˆ‘è¿™é‡Œæä¾›ä¸€ä¸ªæµ‹è¯•ç”¨ä¾‹ï¼Œä½ å¯ä»¥åœ¨è‡ªå·±çš„é¡¹ç›®é‡Œé¢è¯•è¯•çœ‹ã€‚

```typescript
import React from "react";
import { mount } from "enzyme";
import { BetaSchemaForm } from "@ant-design/pro-form";
import { Steps } from "antd";

const { Step } = Steps;

describe("BetaSchemaForm StepsForm", () => {
  it("should submit and got all steps form values", async () => {
    const wrapper = mount(
      <BetaSchemaForm
        layoutType="StepsForm"
        steps={[
          {
            title: "Step 1",
            description: "This is a description.",
            // eslint-disable-next-line react/display-name
            subTitleRender: () => {
              return <>Custom SubTitle</>;
            },
          },
          {
            title: "Step 2",
            description: "This is a description.",
          },
          {
            title: "Step 3",
            description: "This is a description.",
          },
        ]}
        onFinish={async (values) => {
          expect(values[0]).toEqual({ name: "name1" });
          expect(values[1]).toEqual({ name: "name2" });
          expect(values[2]).toEqual({ name: "name3" });
        }}
      >
        <Step key="first" name="1">
          <BetaSchemaForm.Item
            name="name"
            index={0}
            label="Step 1"
            rules={[{ required: true }]}
          />
        </Step>
        <Step key="second" name="2">
          <BetaSchemaForm.Item
            name="name"
            index={1}
            label="Step 2"
            rules={[{ required: true }]}
          />
        </Step>
        <Step key="third" name="3">
          <BetaSchemaForm.Item
            name="name"
            index={2}
            label="Step 3"
            rules={[{ required: true }]}
          />
        </Step>
      </BetaSchemaForm>
    );

    const form = wrapper.find('form').at(0);

    // submit first form, check the first value
    wrapper
      .find(".ant-steps-item-title[title='Step 1']")
      .simulate("click");

    form.simulate("submit");
    await new Promise((resolve) => setTimeout(resolve, 0));
    expect(wrapper.find(".ant-form-item-explain").at(0).text()).toContain(
      "è¯·è¾“å…¥ name"
    );

    wrapper
      .find("input")
      .at(0)
      .simulate("change", { target: { value: "name1" } });

    // submit second form, check the second value
    wrapper
      .find(".ant-steps-item-title[title='Step 2']")
      .simulate("click");

    form.simulate("submit");
    await new Promise((resolve) => setTimeout(resolve, 0));
    expect(wrapper.find(".ant-form-item-explain").at(0).text()).toContain(
      "è¯·è¾“å…¥ name"
    );

    wrapper
      .find("input")
      .at(1)
      .simulate("change", { target: { value: "name2" } });

    // submit third form, check the third value
    wrapper
      .find(".ant-steps-item-title[title='Step 3']")
      .simulate("click");

    form.simulate("submit");
    await new Promise((resolve) => setTimeout(resolve, 0));
    expect(wrapper.find(".ant-form-item-explain").at(0).text()).toContain(
      "è¯·è¾“å…¥ name"
    );

    wrapper
      .find("input")
      .at(2)
      .simulate("change", { target: { value: "name3" } });
  });
});
```

å¦‚æœä½ çš„æµ‹è¯•ç”¨ä¾‹èƒ½å¤Ÿé€šè¿‡äº†ï¼Œå°±ä»£è¡¨ç›®å‰ BetaSchemaForm çš„ `StepsForm` æ˜¯ ok çš„ã€‚

åœ¨æµ‹è¯•ç”¨ä¾‹é‡Œæˆ‘ä»¬é€šè¿‡ Mock çš„æ–¹å¼ï¼Œå¡«å…¥æ¯ä¸ªæ­¥éª¤çš„ Form.Itemï¼Œç„¶åè®¾ç½® `onFinish` æ–¹æ³•å»è·å–æ¯ä¸€ä¸ªæ­¥éª¤è¡¨å•çš„å€¼ï¼Œå¹¶è¿›è¡Œæ ¡éªŒã€‚
