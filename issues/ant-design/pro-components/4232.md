# ProTableçš„æœç´¢è¾“å…¥æ¡†å®ç°onChangeå’Œvalueä¹‹åï¼Œæ— æ³•ä½¿ç”¨æ’¤é”€ï¼ˆcommand/ctrl+zï¼‰è·å¾—ä¸Šä¸€æ¬¡è¾“å…¥çš„å†…å®¹ğŸ›[BUG]

`AI Reply`

### ğŸ› bug æè¿°

æ­£å¸¸æƒ…å†µä¸‹ï¼Œè¾“å…¥æ¡†å…ˆè¾“å…¥123ï¼Œè¿‡ä¸¤ç§’åè¾“å…¥456ï¼Œé‚£ä¹ˆæœ€ç»ˆç»“æœæ˜¯123456ï¼Œæ­¤æ—¶æ’¤é”€(command+z)ï¼Œä¼šä½¿ç»“æœå˜æˆ123ã€‚
åœ¨ProTableä¸­å®šä¹‰äº†è¾“å…¥æ¡†æœç´¢åŸŸä¹‹åï¼Œå¦‚æœåœ¨filedPropsä¸­åŒæ—¶å®ç°äº†onChangeå’Œvalueæ–¹æ³•ï¼Œå‘ç°å°±æ— æ³•æ’¤é”€äº†ã€‚

### ğŸ’» å¤ç°ä»£ç 

const [username, setUsername] = useState();
æœç´¢çš„columnå®šä¹‰å¦‚ä¸‹ï¼š
{
title: 'ç”¨æˆ·å',
dataIndex: 'username',
fieldProps: {
onChange: (e) => {
setUsername(e.target.value.replace(/\s+/g, ""));
},
value: username
}

### Â© ç‰ˆæœ¬ä¿¡æ¯

- chromeæµè§ˆå™¨
- mac OS 11.6
- @ant-design/pro-table: ^2.26.1
- @ant-design/pro-form: ^1.13.7,
- antd: ^4.17.0-alpha.7,
- react: ^17.0.1,

  ## colorbeach

  > ### ğŸ› bug æè¿°
  >
  > æ­£å¸¸æƒ…å†µä¸‹ï¼Œè¾“å…¥æ¡†å…ˆè¾“å…¥123ï¼Œè¿‡ä¸¤ç§’åè¾“å…¥456ï¼Œé‚£ä¹ˆæœ€ç»ˆç»“æœæ˜¯123456ï¼Œæ­¤æ—¶æ’¤é”€(command+z)ï¼Œä¼šä½¿ç»“æœå˜æˆ123ã€‚ åœ¨ProTableä¸­å®šä¹‰äº†è¾“å…¥æ¡†æœç´¢åŸŸä¹‹åï¼Œå¦‚æœåœ¨filedPropsä¸­åŒæ—¶å®ç°äº†onChangeå’Œvalueæ–¹æ³•ï¼Œå‘ç°å°±æ— æ³•æ’¤é”€äº†ã€‚
  >
  > ### ğŸ’» å¤ç°ä»£ç 
  >
  > const [username, setUsername] = useState(); æœç´¢çš„columnå®šä¹‰å¦‚ä¸‹ï¼š { title: 'ç”¨æˆ·å', dataIndex: 'username', fieldProps: { onChange: (e) => { setUsername(e.target.value.replace(/\s+/g, "")); }, value: username }
  >
  > ### Â© ç‰ˆæœ¬ä¿¡æ¯
  >
  > - chromeæµè§ˆå™¨
  > - mac OS 11.6
  > - @ant-design/pro-table: ^2.26.1
  > - @ant-design/pro-form: ^1.13.7,
  > - antd: ^4.17.0-alpha.7,
  > - react: ^17.0.1,

åé¢ç”¨codesandboxè¯•äº†ä¸€ä¸‹ï¼Œå±…ç„¶æ˜¯å¥½çš„ã€‚

ç”¨Safariå°è¯•ï¼Œç»“æœå’ŒChromeä¸å¤ªä¸€æ ·ã€‚Safariåœ¨å¤±å»è¾“å…¥æ¡†ç„¦ç‚¹ä¹‹åï¼Œæ— è®ºæ˜¯å¦å®ç°valueå’ŒonChangeæ–¹æ³•ï¼Œéƒ½æ— æ³•æ’¤é”€ï¼›è€Œå­˜åœ¨ç„¦ç‚¹æ—¶ï¼Œä»…ä¸å®ç°valueå’ŒonChangeæ‰èƒ½æ’¤é”€ã€‚

## chenshuai2144

> TAutomatically replying with ChatGPT can be attempted, but it cannot be guaranteed to be completely accurate and may not fully address all issues. Please feel free to reply if you have any further questions or concerns.
> æ­¤å›å¤åŸºäº ChatGPT è‡ªåŠ¨ç”Ÿæˆï¼Œå¯ä»¥å°è¯•ä¸‹æ–¹æ¡ˆï¼Œå®˜æ–¹äººå‘˜ä¼šåœ¨ä¸€å®šæ—¶é—´åç»§ç»­ç»§ç»­å¤„ç†ã€‚

è¿™å¯èƒ½æ˜¯æµè§ˆå™¨çš„ä¸€ä¸ªbugï¼Œä¸åŒçš„æµè§ˆå™¨å¯èƒ½ä¼šæœ‰ä¸åŒçš„è¡¨ç°ã€‚ä¸è¿‡ï¼Œå¯ä»¥å°è¯•åœ¨ProTableçš„æœç´¢æ¡†ä¸­ä½¿ç”¨React-Reduxæˆ–Context APIæ¥ç®¡ç†æœç´¢æ¡†çš„å€¼ï¼Œé¿å…ç›´æ¥é€šè¿‡useStateè¿›è¡ŒçŠ¶æ€ç®¡ç†ã€‚è¿™æ ·åšå¯ä»¥é¿å…æµè§ˆå™¨å’ŒReactä¹‹é—´çš„å·®å¼‚å¯¼è‡´çš„é—®é¢˜ã€‚

å…·ä½“åœ°ï¼Œå¯ä»¥åˆ›å»ºä¸€ä¸ªå…¨å±€çš„æœç´¢æ¡†çŠ¶æ€ç®¡ç†ï¼Œå°†æœç´¢æ¡†çš„å€¼ä½œä¸ºçŠ¶æ€çš„ä¸€éƒ¨åˆ†ï¼Œç„¶åå°†è¿™ä¸ªçŠ¶æ€æä¾›ç»™ProTableçš„æœç´¢æ¡†ç»„ä»¶ã€‚è¿™æ ·ï¼Œå³ä½¿åœ¨å¤±å»ç„¦ç‚¹ä¹‹åä¹Ÿèƒ½å¤Ÿä¿ç•™æœç´¢æ¡†çš„å€¼ï¼Œå¹¶å¯ä»¥é€šè¿‡Redux DevToolsç­‰å·¥å…·æ¥è°ƒè¯•é—®é¢˜ã€‚

ä¸‹é¢æ˜¯ä»£ç ç¤ºä¾‹ï¼š

```jsx
// æœç´¢æ¡†çŠ¶æ€ç®¡ç†
import { createContext, useContext, useReducer } from "react";

const SearchContext = createContext();

export function SearchProvider({ children }) {
  const [state, dispatch] = useReducer(
    (prevState, action) => {
      switch (action.type) {
        case "SET_KEYWORD":
          return { ...prevState, keyword: action.payload };
        default:
          return prevState;
      }
    },
    { keyword: "" },
  );

  return (
    <SearchContext.Provider value={{ state, dispatch }}>
      {children}
    </SearchContext.Provider>
  );
}

export function useSearch() {
  return useContext(SearchContext);
}

// ä½¿ç”¨æœç´¢æ¡†
import { useSearch } from "./search";

// ...

const { state, dispatch } = useSearch();
const handleChange = (e) => {
  dispatch({
    type: "SET_KEYWORD",
    payload: e.target.value.replace(/\s+/g, ""),
  });
};

return (
  <ProTable
    // ...
    columns={[
      // ...
      {
        title: "ç”¨æˆ·å",
        dataIndex: "username",
        fieldProps: { onChange: handleChange, value: state.keyword },
      },
      // ...
    ]}
    // ...
  />
);
```

éœ€è¦æ³¨æ„ï¼Œè¯¥ä»£ç å¯èƒ½éœ€è¦è°ƒæ•´ä½ çš„ç°æœ‰ä»£ç ï¼Œç‰¹åˆ«æ˜¯åœ¨ç»„ä»¶å±‚æ¬¡ç»“æ„æ–¹é¢ã€‚
