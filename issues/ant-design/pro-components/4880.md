# [plugin:vite:css] '~antd/es/style/themes/index.less' wasn't found.ğŸ›[BUG]

æé—®å‰å…ˆçœ‹çœ‹ï¼š

https://github.com/ryanhanwu/How-To-Ask-Questions-The-Smart-Way/blob/main/README-zh_CN.md

### ğŸ› bug æè¿°

æˆ‘ç»™Reactä¸­å¼•å…¥viteè„šæ‰‹æ¶ï¼Œç„¶åé…ç½®äº†

<!--
è¯¦ç»†åœ°æè¿° bugï¼Œè®©å¤§å®¶éƒ½èƒ½ç†è§£
-->

### ğŸ“· å¤ç°æ­¥éª¤

**ç¬¬ä¸€æ­¥é¦–å…ˆå°†é¡¹ç›®æ¢æˆvite+reactï¼Œæ­¤æ—¶é¡¹ç›®æ­£å¸¸è¿è¡Œ**
ç¬¬äºŒæ­¥ï¼šå‚è€ƒè¿™é‡Œantdçš„æ¡ˆä¾‹ä»£ç https://procomponents.ant.design/components/layout
[æ‰¾åˆ°è¿™é‡Œçš„è‡ªå®šä¹‰menuæ¡ˆä¾‹ï¼Œå¤åˆ¶è¿™é‡Œçš„ä»£ç ï¼Œæƒ³è¦çœ‹çœ‹viteè„šæ‰‹æ¶åé¢çš„æ•ˆæœ](https://procomponents.ant.design/components/layout)
![image](https://user-images.githubusercontent.com/34833782/158972520-7d6d1cb9-3f0c-404b-aa53-3a2a92f4b08e.png)
ç¬¬ä¸‰æ­¥ï¼šå†æ¬¡å¯åŠ¨ï¼Œè¿™é‡Œå‡ºç°äº†æŠ¥é”™
[plugin:vite:css] '~antd/es/style/themes/index.less' wasn't found. Tried - D:\002Code\02myCodeResearch\my-react-first-app\node_modules\@ant-design\pro-layout\es\components\PageContainer\~antd\es\style\themes\index.less
ç¬¬å››æ­¥ï¼šå¯¹äºè¿™äº›æŠ¥é”™ï¼Œå› ä¸ºæ˜¯æ‰¾ä¸åˆ°æ–‡ä»¶ï¼Œviteç›¸å…³ï¼Œäºæ˜¯é…ç½®äº†ä¸¤ä¸ªæ’ä»¶
import NpmImport from 'less-plugin-npm-import';
import postcss from 'rollup-plugin-postcss';
ä½†æ˜¯è¿˜æ˜¯ä¸è¡Œï¼Œå¢åŠ äº†å®˜ç½‘babelä¸­çš„importçš„é…ç½®è¿˜æ˜¯ä¸è¡Œï¼Œæ‰€æœ‰çš„viteé…ç½®å’Œbabelæ±‡æ€»å¦‚ä¸‹ï¼Œéº»çƒ¦çœ‹çœ‹å§ï¼Œè°¢è°¢ï¼ˆæ„Ÿè§‰åƒæ˜¯viteçš„å½±å“ï¼Œä½†æ˜¯ä¸çŸ¥é“ä¸ºä»€ä¹ˆï¼‰
viteå®Œæ•´é…ç½®
import { defineConfig } from 'vite';
// æ”¯æŒviteçš„çƒ­æ›´æ–°
import NpmImport from 'less-plugin-npm-import';
import postcss from 'rollup-plugin-postcss';
import react from '@vitejs/plugin-react';
// è‡ªåŠ¨å¯¼å…¥UIæ ·å¼åº“
import vitePluginImp from 'vite-plugin-imp';
// import path from 'path';
// import fs from 'fs';
// import lessToJS from 'less-vars-to-js';

// const themeVariables = lessToJS(
// fs.readFileSync(
// path.resolve(\_\_dirname, './src/assets/css/variables.less'),
// 'utf8',
// ),
// );

export default defineConfig({
server: {
host: true,
port: 8080,
},
plugins: [
react(),
vitePluginImp({
libList: [
{
libName: 'antd',
style: (name) => `antd/lib/${name}/style/index.less`,
},
],
}),
postcss({
use: [['less', {
        plugins: [new NpmImport({prefix: '~'})],
      }]],
}),
],
css: {
preprocessorOptions: {
// lessé¢„å¤„ç†å™¨
less: {
charset: false,
// æ”¯æŒå†…è” JavaScript
javascriptEnabled: true,
// é‡å†™ less å˜é‡ï¼Œå®šåˆ¶æ ·å¼
// modifyVars: themeVariables,
},
},
},
resolve: {
// alias: [
// {
// find: /@\//,
// replacement: path.join(__dirname, './src/'),
// },
// ],
},
});
ç›¸å…³babel
{
"presets": ["env"],
"plugins": [
[
"import",
{
"libraryName": "antd",
"libraryDirectory": "es",
"style": "css" // `style: true` ä¼šåŠ è½½ less æ–‡ä»¶
}
]
]
}

<!--
æ¸…æ™°æè¿°å¤ç°æ­¥éª¤ï¼Œè®©åˆ«äººä¹Ÿèƒ½çœ‹åˆ°é—®é¢˜ï¼Œå¦‚æœå¯èƒ½ï¼Œå°½é‡æä¾›å¯æ‰§è¡Œä»£ç ï¼Œ
å¦‚ï¼šhttps://codesandbox.io/ åœ¨æ­¤å¤„åˆ›å»ºä¸€ä¸ª codesandboxï¼Œæ–¹ä¾¿æˆ‘ä»¬æ›´å¿«çš„æ’æŸ¥å’Œå¤ç°é—®é¢˜
-->

### ğŸ æœŸæœ›ç»“æœ

viteè„šæ‰‹æ¶å’Œreactç»“åˆåï¼Œå¯ä»¥æ­£å¸¸çœ‹åˆ°å½“å‰çš„èœå•å†…å®¹

<!--
æè¿°ä½ åŸæœ¬æœŸæœ›çœ‹åˆ°çš„ç»“æœ
-->

### ğŸ’» å¤ç°ä»£ç 

é‡‡ç”¨æ¡ˆä¾‹ï¼Œbabelå’Œviteçš„é…ç½®å¦‚ä¸‹
ç›¸å…³babel
{
"presets": ["env"],
"plugins": [
[
"import",
{
"libraryName": "antd",
"libraryDirectory": "es",
"style": "css" // `style: true` ä¼šåŠ è½½ less æ–‡ä»¶
}
]
]
}
ç›¸å…³çš„viteé…ç½®
import { defineConfig } from 'vite';
import NpmImport from 'less-plugin-npm-import';
import postcss from 'rollup-plugin-postcss';
import react from '@vitejs/plugin-react';
// è‡ªåŠ¨å¯¼å…¥UIæ ·å¼åº“
import vitePluginImp from 'vite-plugin-imp';
// import path from 'path';
// import fs from 'fs';
// import lessToJS from 'less-vars-to-js';

// const themeVariables = lessToJS(
// fs.readFileSync(
// path.resolve(\_\_dirname, './src/assets/css/variables.less'),
// 'utf8',
// ),
// );

export default defineConfig({
server: {
host: true,
port: 8080,
},
plugins: [
react(),
vitePluginImp({
libList: [
{
libName: 'antd',
style: (name) => `antd/lib/${name}/style/index.less`,
},
],
}),
postcss({
use: [['less', {
        plugins: [new NpmImport({prefix: '~'})],
      }]],
}),
],
css: {
preprocessorOptions: {
// lessé¢„å¤„ç†å™¨
less: {
charset: false,
// æ”¯æŒå†…è” JavaScript
javascriptEnabled: true,
// é‡å†™ less å˜é‡ï¼Œå®šåˆ¶æ ·å¼
// modifyVars: themeVariables,
},
},
},
resolve: {
// alias: [
// {
// find: /@\//,
// replacement: path.join(__dirname, './src/'),
// },
// ],
},
});

### Â© ç‰ˆæœ¬ä¿¡æ¯

- ProComponents ç‰ˆæœ¬: [e.g. 4.0.0]
  "@ant-design/pro-layout": "^6.34.4",
- umi ç‰ˆæœ¬
  æœªå®‰è£…
- æµè§ˆå™¨ç¯å¢ƒ
  Microsoft Edge
  ç‰ˆæœ¬ 99.0.1150.39 (æ­£å¼ç‰ˆæœ¬) (64 ä½)
- å¼€å‘ç¯å¢ƒ [e.g. mac OS]
  window11+node14.7.0

### ğŸš‘ å…¶ä»–ä¿¡æ¯

![image](https://user-images.githubusercontent.com/34833782/158973821-07e9017f-858e-437d-83f3-6ce2e0ad8314.png)

<!--
å¦‚æˆªå›¾ç­‰å…¶ä»–ä¿¡æ¯å¯ä»¥è´´åœ¨è¿™é‡Œ
-->

## nyhxiaoning

æ‰¾åˆ°åŸå› äº†ï¼Œæ˜¯å› ä¸ºè§£æä¸äº†~ï¼Œæ‰“æ‰°äº†

## sineava

è§£å†³äº†å—?æˆ‘è·Ÿä½ é‡åˆ°ç›¸åŒçš„é—®é¢˜

## chengdick

æ€ä¹ˆè§£å†³å•Š

## blackstoneblackstone

å…ˆå®‰è£… less
npm i less -D

ç„¶åé…ç½® vite.config.ts é‡ç‚¹æ˜¯ css å’Œ alias çš„é…ç½®

```
 css: {
    preprocessorOptions: {
      less: {
        javascriptEnabled: true,
      },
    },
  },
  resolve: {
    alias: [
      {
        find: /^~/,
        replacement: '',
      },
      {
        find: '@',
        replacement: path.resolve(__dirname, './src')
      }
    ],
  }
```

## httol

> æ‰¾åˆ°åŸå› äº†ï¼Œæ˜¯å› ä¸ºè§£æä¸äº†~ï¼Œæ‰“æ‰°äº†

ä»€ä¹ˆè§£æä¸äº†ï¼Œé‡åˆ°åŒæ ·é—®é¢˜

## LYLSir

> æ‰¾åˆ°åŸå› äº†ï¼Œæ˜¯å› ä¸ºè§£æä¸äº†~ï¼Œæ‰“æ‰°äº†

æœ€åæ˜¯æ€ä¹ˆè§£å†³çš„å‘¢ï¼Ÿ

## perintery

```ts
 css: {
    preprocessorOptions: {
      less: {
        javascriptEnabled: true,
      },
    },
  },
  resolve: {
    alias: [
      {
        find: /^~/,
        replacement: '',
      },
    ],
  }

```

å°±æ˜¯ä¸Šé¢çš„ä»£ç çš„æ–¹æ³•è§£å†³çš„,
å…³æ³¨ä¸€ä¸‹, è‡ªå·±çš„antd ä¸èƒ½æ˜¯v5ç‰ˆæœ¬~

@LYLSir

## perintery

> > æ‰¾åˆ°åŸå› äº†ï¼Œæ˜¯å› ä¸ºè§£æä¸äº†~ï¼Œæ‰“æ‰°äº†
>
> æœ€åæ˜¯æ€ä¹ˆè§£å†³çš„å‘¢ï¼Ÿ

```ts
 css: {
    preprocessorOptions: {
      less: {
        javascriptEnabled: true,
      },
    },
  },
  resolve: {
    alias: [
      {
        find: /^~/,
        replacement: '',
      },
    ],
  }

```

å°±æ˜¯ä¸Šé¢çš„ä»£ç çš„æ–¹æ³•è§£å†³çš„,
å…³æ³¨ä¸€ä¸‹, è‡ªå·±çš„antd ä¸èƒ½æ˜¯v5ç‰ˆæœ¬~

@LYLSir
