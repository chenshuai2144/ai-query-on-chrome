# 🧐[问题] 请问在刚进入页面时useEffect中调用actionRef.current.reload为什么不能触发request？

提问前先看看：

https://github.com/ryanhanwu/How-To-Ask-Questions-The-Smart-Way/blob/main/README-zh_CN.md

### 🧐 问题描述

在刚进入页面时useEffect中调用actionRef.current.reload不能触发request，而通过settimeout(() => { actionRef.current.reload() }, 500)延迟500ms左右才能触发

<!--
详细地描述问题，让大家都能理解
-->

### 💻 示例代码

```JavaScript
 useEffect(() => {
    setTimeout(() => console.log('actionRef.current.timeout', actionRef.current), 500) // 可以触发request
    actionRef.current.reload() // 不能触发request
  }, [history.location.query])

return <ProTable
        columns={columns}
        actionRef={actionRef}
        manualRequest={true}
        request={(params = {}, sort, filter) => {
          console.log('sort & filter', sort, filter);
          const { current, ...other } = Object.assign({}, params, {
            ...history.location.query,
            current: history.location.query.pageNumber
          })
          const _params = {
            pageNumber: current,
            ...other
          }
          return enterprise.queryList(_params)
            .then(res => {
              return {
                data: res.data.data,
                success: res.success,
                total: res.data.total
              }
            })
        }}
        debounceTime={200}
        rowKey="id"
        pagination={{
          onChange: (pageNumber, pageSize) => {
            history.push({ pathname: history.location.pathname, query: {...history.location.query, pageSize, pageNumber }})
          },
          showSizeChanger: true,
          showQuickJumper: true,
          defaultPageSize: history.location.query.pageSize || 10,
          defaultCurrent: history.location.query.pageNumber || 1
        }}
      />
```

<!--
如果你有解决方案，在这里清晰地阐述
-->

### 🚑 其他信息

<!--
如截图等其他信息可以贴在这里
-->

## JoeyYoung1997

经测试，通过取消manualRequest时可触发request，那这样其实就是我的思维误区，我本想在每次跳转页面后push({pathname: 'xx', query: { pageNumber： xx, pageSize: xx }})，然后useEffect中actionRef.current.reload()调用后触发request，以此达到记忆分页参数的目的，现在来看还是让proTable自行触发吧。。。

## studyyiran

> 经测试，通过取消manualRequest时可触发request，那这样其实就是我的思维误区，我本想在每次跳转页面后push({pathname: 'xx', query: { pageNumber： xx, pageSize: xx }})，然后useEffect中actionRef.current.reload()调用后触发request，以此达到记忆分页参数的目的，现在来看还是让proTable自行触发吧。。。

hello @JoeyYoung1997 ，我觉得你这个思路没问题呀~~
你是直接解决了这个问题，然是绕过去了

## Dunqing

ProTable有个onLoad事件在这里里面触发reload()试试

## JoeyYoung1997

> ProTable有个onLoad事件在这里里面触发reload()试试

这个是数据加载完成后触发，但是我是需要先加载数据的

## JoeyYoung1997

> > 经测试，通过取消manualRequest时可触发request，那这样其实就是我的思维误区，我本想在每次跳转页面后push({pathname: 'xx', query: { pageNumber： xx, pageSize: xx }})，然后useEffect中actionRef.current.reload()调用后触发request，以此达到记忆分页参数的目的，现在来看还是让proTable自行触发吧。。。
>
> hello @JoeyYoung1997 ，我觉得你这个思路没问题呀~~ 你是直接解决了这个问题，然是绕过去了

思路是这样，就是刚进页面useEffect调用reload触发不了request，要么延迟调用，要么等下一次页面路由push

## chenshuai2144

loading 的时候是不能触发的，要等第一次请求结束了才行
