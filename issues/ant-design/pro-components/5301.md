# 🧐[问题] 如何封装 ProFormText 和 ProFormUploadButton 组件

提问前先看看：

https://github.com/ryanhanwu/How-To-Ask-Questions-The-Smart-Way/blob/main/README-zh_CN.md

### 🧐 问题描述

使用 ProFormText 和 ProFormUploadButton 组件封装的 ImageInput 在上传图片成功后，ProFormText自动填入了上传图片的链接，但提交时，该 ImageInput依然未通过必填验证。

### 💻 示例代码

```typescript
export const ImageInput = (props: any) => {
  const [value, setValue] = useState('');

  const uploadProps = {
    accept: 'image/*',
    action: '/api/admin/qiniu/upload',
    beforeUpload: (file: any) => {
      const isImage = file.type.startsWith('image');
      if (!isImage) {
        message.error(`${file.name} is not a image file`);
      }
      return isImage || Upload.LIST_IGNORE;
    },
    onChange: (info: any) => {
      if (info.file.status === 'done') {
        setValue(info.file.response.data);
        props.onChange?.(info.file.response.data);
      }
    },
    showUploadList: false,
  };

  const handleChange = (e: ChangeEvent<HTMLInputElement>) => {
    const v = e.target.value;
    setValue(v);
    props.onChange?.(v ?? props.value);
  };

  return (
    <div className={styles.imageInput}>
      <ProFormText {...props} value={props.value ?? value} onChange={handleChange} />
      <ProFormUploadButton fieldProps={{ ...uploadProps }} />
    </div>
  );
};
```

```typescript
const AddForm = () => (
  <Collapse>
    <Panel header="图片信息" key="2">
      <ProForm.Group>
        <ImageInput
          width="md"
          name="logoUrl"
          label="logoUrl"
          tooltip="tooltip"
          placeholder="请输入logoUrl"
        />
      </ProForm.Group>
    </Panel>
  </Collapse>
)

const Page = () => (
  <ModalForm
      visible={addVisible}
      onVisibleChange={setAddVisible}
      title="新增"
      onFinish={handleAdd}
      width={1300}
  >
    <AddForm />
  </ModalForm>
)
```

### 🚑 其他信息

![imageInput](https://user-images.githubusercontent.com/53958427/170620404-18ad6e82-c296-4068-b646-1c5543351b41.gif)

## Dunqing

https://procomponents.ant.design/components/field-set#proformfields-%E8%A1%A8%E5%8D%95%E9%A1%B9

## abiaqiou

问题已解决，关键是要通过 setFieldsValue 来给 input 赋值

## vaynevayne

> 问题已解决，关键是要通过 setFieldsValue 来给 input 赋值

同样的问题, 请问 form 对象从哪里拿呢?
