# 👑 [需求]ProTable filter 提供转换方法

### 🔩 所属模块或组件

ProTable filter

### 🥰 需求描述

比如很多时候筛选接口参数和dataIndex不一样，还有单选时值要求是字符串不是数组，在request那里处理filter虽然可以，但是要map每个dataIndex替换key和value很不方便

### ⛰ 功能需求适用场景

自定义filter参数

### 🧐 解决方案

需要一个类似search.transform的方法转化request的filter

### 🚑 其他信息

<!--
如截图等其他信息可以贴在这里
-->

## chenshuai2144

filter 一般都是单行吧，为什么需要复杂的转化？

## tong233

> filter 一般都是单行吧，为什么需要复杂的转化？

不复杂但是多个filter放到request里处理就复杂了，比如后端filter查询接口，key和dataIndex字段不一致。value默认值要传null，数组要转字符串等等。

## tong233

例子

```ts
const tableOptions  = {
  rowKey: 'id',
  request: async (params, sorter, filter) => {
    const { current, ...rest } = params;
    const transformFilter: Record<string, any> = {};

    for (const [key, value] of Object.entries(filter)) {
     // 这种需要判断是某个key再去改对应格式过于繁琐
      if (key === 'x_xxx') {
        transformFilter.xxx = value;
        if (!value) {
          transformFilter.xxx = null;
        } else {
          transformFilter.xxx = Array.isArray(value) ? value[0] : value;
        }
      } else if (key === 'a_a_aaa') {
        transformFilter.aAaa = value;
        if (!value) {
          transformFilter.aAaa = null;
        } else {
          transformFilter.aAaa = Array.isArray(value) ? value[0] : value;
        }
      }
    } else {
      transformFilter[key] === value
    }
   }
    const { data, code } = await getData({
      ...rest,
      pageIndex: current,
      ...transformFilter,
    });

    return { data: data?.results, total: data?.total, success: code === '0' };
  },
}
```

## chenshuai2144

放在一起转我感觉更好，不然联动也太麻烦了
