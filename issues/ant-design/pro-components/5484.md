# ProFormList的子元素的rules校验不生效 🐛[BUG]

`form`,`📦  Need to reproduce`

### 🐛 bug 描述

@ant-design/pro-form 从1.18.3 升级1.52.0后，ProFormList的子元素的rules校验不生效了，被迫调整回来了。

### 📷 复现步骤

第一步：package.json

```"dependencies": {
    "@ant-design/icons": "^4.7.0",
    "@ant-design/pro-card": "^1.13.0",
    "@ant-design/pro-descriptions": "^1.10.0",
    "@ant-design/pro-form": "^1.52.0",
    "@ant-design/pro-layout": "^6.32.0",
    "@ant-design/pro-table": "^2.61.0",
    "@ant-design/pro-list": "^1.11.0",
    "@umijs/route-utils": "^2.0.0",
```

第二步：表单

```<ProForm form={form} name="basic" layout="vertical" autoComplete="off" submitter={false}>
  <ProFormList
    name="input"
    copyIconProps={false}
    creatorButtonProps={{ creatorButtonText: '新增一行' }}
  >
    <ProFormGroup>
      <ProFormText
        width="md"
        name="name"
        label="参数名"
        allowClear={false}
        rules={nameRules}
        tooltip="不能重复"
      />
    </ProFormGroup>
  </ProFormList>
</ProForm>
```

第三步：触发校验
form.validateFields()

### 🏞 期望结果

form.validateFields() 希望能够校验出来

## xingzhuJ

@chenshuai2144 我也出现了相同问题～～

## JackRoy1992

@chenshuai2144 感觉是namePath只能到ProFormList的name，但是要精准到ProFormList的子元素的name就不知道怎么写namePath了

## chenshuai2144

能提供一个复现让我看看吗

## JackRoy1992

> 能提供一个复现让我看看吗
> @chenshuai2144

用demo简单写了个需求，真实需求校验更复杂，就希望有个外部按钮去触发校验

```
import React, { useRef } from 'react'
import {
  ProCard,
  ProForm,
  ProFormGroup,
  ProFormList,
  ProFormText,
  ProFormInstance,
  ProFormDependency
} from '@ant-design/pro-components';
import { Button } from 'antd'

const Demo = () => {
  const formRef = useRef<ProFormInstance>()
  const check = () => {
    // 因为某些原因，需要在list里面校验部分数据，只校验值
    formRef?.current?.validateFields() //TODO: 这个的namePath应该怎么写
  }
  return (
    <>
      <ProForm onFinish={async (e) => console.log(e)} formRef={formRef}>
        <ProFormText name="name" label="姓名" />
        <ProFormList
          name="users"
          label="用户信息"
          initialValue={[
            {
              name: '1111',
            },
          ]}
          itemRender={({ listDom, action }, { record }) => {
            return (
              <ProCard
                bordered
                extra={action}
                title={record?.name}
                style={{
                  marginBlockEnd: 8,
                }}
              >
                {listDom}
              </ProCard>
            );
          }}
        >
          <ProFormGroup>
            <ProFormText name="name" label="姓名" rules={[{
              required: true, message: '请输入姓名'
            }]} />
            <ProFormText name="nickName" label="昵称" />
          </ProFormGroup>
          <ProFormList
            name="labels"
            label="用户信息"
            initialValue={[
              {
                value: '333',
                value2: '333',
              },
            ]}
            copyIconProps={{
              tooltipText: '复制此行到末尾',
            }}
            deleteIconProps={{
              tooltipText: '不需要这行了',
            }}
            itemRender={({ listDom, action }, { record }) => {
              return (
                <ProCard
                  bordered
                  extra={action}
                  title={record?.name}
                  style={{
                    marginBlockEnd: 8,
                  }}
                >
                  <>
                    {listDom}
                    <Button onClick={check}>校验值</Button>
                  </>
                </ProCard>
              );
            }}
          >
            <ProFormGroup key="group">
              <ProFormDependency name={['value2']}>
                {({ value2 }) => (
                  <ProFormText name="value" label="值1" rules={[{
                    required: true, message: '请输入值'
                  }, {
                    validator: (_, value) => {
                      if (+value > +value2) {
                        return Promise.reject(new Error(`值1不能大于值2`))
                      }
                      return Promise.resolve()
                    }
                  }]} />
                )}
              </ProFormDependency>
             <ProFormText name="value2" label="值2" />
            </ProFormGroup>
          </ProFormList>
        </ProFormList>
      </ProForm>

    </>
  );
};

export default Demo;
```

## chenshuai2144

提供一个能运行的demo而不是代码片段
