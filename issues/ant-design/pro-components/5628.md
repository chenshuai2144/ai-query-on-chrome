# protable 分页功能，切换分页的时候，页码一直被重置为1🐛[BUG]

提问前先看看：

https://github.com/ryanhanwu/How-To-Ask-Questions-The-Smart-Way/blob/main/README-zh_CN.md

### 🐛 bug 描述

protable pagination里面的onchange事件执行了两次，第一次是我点击的页码，第二次的时候当前一直被重置回1，导致无法切换分页，请问可能是哪里的问题

### 📷 复现步骤

<!--
清晰描述复现步骤，让别人也能看到问题，如果可能，尽量提供可执行代码，
如：https://codesandbox.io/ 在此处创建一个 codesandbox，方便我们更快的排查和复现问题
-->

### 🏞 期望结果

翻页的onchang事件，只执行一次

<!--
描述你原本期望看到的结果
-->

### 💻 复现代码

<!--
提供可复现的代码，仓库，或线上示例
-->

const [params, setParamDatas] = useState({
platform_id:"",
page_size: 10,
current:1,
ipaddress:'',
host_name:""
})
const onChangePagination = (page, pageSize) => {
console.log(page, pageSize);
setParamDatas(val => {
return {...val, current: page, page_size: pageSize,}
})
}
return (
<PageContainer>
<ProTable
columns={columns}
// rowKey="vm_uuid"
rowKey={record => record.vm_id}
params={params}
request={(par) => {
return getSourceVmList(params)
}}
pagination={{
          position: ['bottomCenter'],
          showQuickJumper: true,
          onChange: onChangePagination,
          pageSize: 10,
        }}
/>
）

### © 版本信息

- "@ant-design/pro-table": "^2.77.0",
- umi 版本
- 浏览器环境
- 开发环境 [e.g. mac OS]

### 🚑 其他信息

<!--
如截图等其他信息可以贴在这里
-->

## lcc908

该问题我用其他方案解决了，然后看源码发现这段代码，为什么要重置current呢？：  
useDeepCompareEffect(() => {
// request 存在且params不为空，且已经请求过数据才需要设置。
if (props.request && params && action.dataSource && action?.pageInfo?.current !== 1) {
action.setPageInfo({
current: 1,
});
}
// eslint-disable-next-line react-hooks/exhaustive-deps
}, [params]);

## youtiao66

虽然这个 Issue 已经被关闭，但对我却起到了很大的作用。主要因为新增了以下功能：

[fix(table): table 的 param发生变化时重置分页为1 #4648](https://github.com/ant-design/pro-components/pull/4648)

既解答了 @lcc908 的疑惑，同时也希望遇到相同问题的开发者能够快速定位并解决问题。

## gezichenshan

是啊，^2.80.8问题还是有！
