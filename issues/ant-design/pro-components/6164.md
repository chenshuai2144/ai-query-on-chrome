# ğŸ›[BUG]Uncaught ReferenceError: process is not defined

### ğŸ› bug æè¿°

```
Uncaught ReferenceError: process is not defined
    at openVisibleCompatible2 (openVisibleCompatible.js:5:31)
    at SiderMenuWrapper2 (index.js:51:25)
    at renderWithHooks (react-dom.development.js:16305:18)
    at mountIndeterminateComponent (react-dom.development.js:20074:13)
    at beginWork (react-dom.development.js:21587:16)
    at HTMLUnknownElement.callCallback2 (react-dom.development.js:4164:14)
    at Object.invokeGuardedCallbackDev (react-dom.development.js:4213:16)
    at invokeGuardedCallback (react-dom.development.js:4277:31)
    at beginWork$1 (react-dom.development.js:27451:7)
    at performUnitOfWork (react-dom.development.js:26557:12)
```

### ğŸ“· å¤ç°æ­¥éª¤

å‘½ä»¤è¡Œè¿è¡Œ `vite` ã€‚

### ğŸ æœŸæœ›ç»“æœ

æ­£å¸¸æ¸²æŸ“ ProLayout

### ğŸ’» å¤ç°ä»£ç 

```jsx
function App() {
  const { pathname } = useLocation();
  const main = useRoutes(route.routes);

  return (
    <ProLayout
      layout="mix"
      fixSiderbar
      fixHeader
      route={route}
      location={{ pathname }}
      menu={{ autoClose: false }}
      menuItemRender={(item, dom) => <Link to={item.path}>{dom}</Link>}
      className="min-vh-100"
    >
      {main}
    </ProLayout>
  );
}
```

### Â© ç‰ˆæœ¬ä¿¡æ¯

- ProComponents ç‰ˆæœ¬: 2.3.28
- Ant Design ç‰ˆæœ¬: 4.24.0
- node ç‰ˆæœ¬: v18.12.0
- vite ç‰ˆæœ¬: 3.2.2
- pnpm ç‰ˆæœ¬: 7.14.2
- æµè§ˆå™¨ç¯å¢ƒ Microsoft Edge ç‰ˆæœ¬ 107.0.1418.26 (æ­£å¼ç‰ˆæœ¬) (64 ä½)
- å¼€å‘ç¯å¢ƒ Windows 11

### ğŸš‘ å…¶ä»–ä¿¡æ¯

## xezzon

https://github.com/ant-design/pro-components/blob/a853c53a3f4bb5c850da9cd176c5399d13e9a15f/packages/utils/src/compareVersions/openVisibleCompatible.ts#L7

## Kaby-Lake

åŒæ ·çš„é—®é¢˜ï¼Œåœ¨webpackä¸‹ä¹Ÿå‡ºç°äº†

## macjohson

vite.config.ts ä¸‹åŠ å…¥

```ts
define: {
    'process.env': {}
  }
```

## nhatncb

> vite.config.ts ä¸‹åŠ å…¥
>
> ```ts
> define: {
>     'process.env': {}
>   }
> ```

This will lead to another bug related to useSWR

## Jungzl

```typescript
// vite.config.ts

import { version } from "antd";

export default defineConfig(() => ({
  define: {
    "process.env.ANTD_VERSION": `"${version}"`,
  },
}));
```

## xezzon

ç”¨æˆ·ä¾§å¤„ç†ä¸å¤ªå‹å¥½å§ï¼Ÿèƒ½ä¸èƒ½ä»ä»£ç å±‚é¢è§£å†³ï¼Œæ¯”å¦‚é“¾å¼æ“ä½œç¬¦ã€‚

## Lucien-X

> ç”¨æˆ·ä¾§å¤„ç†ä¸å¤ªå‹å¥½å§ï¼Ÿèƒ½ä¸èƒ½ä»ä»£ç å±‚é¢è§£å†³ï¼Œæ¯”å¦‚é“¾å¼æ“ä½œç¬¦ã€‚

Same issue here...
æˆ‘è¿˜ä»¥ä¸ºviteå‡ºé—®é¢˜äº†ï¼Œå‡äº†ä¸ªviteç‰ˆæœ¬è¿˜æ˜¯è¿™ä¸ªé—®é¢˜

## abdeljalil09

this bug has come back

## abdeljalil09

> ```ts
> // vite.config.ts
>
> import { version } from "antd";
>
> export default defineConfig(() => ({
>   define: {
>     "process.env.ANTD_VERSION": `"${version}"`,
>   },
> }));
> ```

this work only in dev mode when shipping to production it comes back again

## abdeljalil09

package is fully broken

## abdeljalil09

this is my workaround the problem because the above work only in dev mode , to make it work in production

![image](https://user-images.githubusercontent.com/101262837/235758241-fdc5a13d-932e-47aa-a925-6d9fb38e03e4.png)
