# ğŸ›[BUG] [ProLayout] ç‚¹å‡»å³ä¾§çš„ç°è‰²åŒºåŸŸæ—¶æ— æ³•æ”¶èµ·èœå•

æé—®å‰å…ˆçœ‹çœ‹ï¼š

https://github.com/ryanhanwu/How-To-Ask-Questions-The-Smart-Way/blob/main/README-zh_CN.md

### ğŸ› bug æè¿°

<!--
è¯¦ç»†åœ°æè¿° bugï¼Œè®©å¤§å®¶éƒ½èƒ½ç†è§£
-->

è§å®˜æ–¹æ–‡æ¡£ä¸Šçš„[Demo](https://procomponents.ant.design/~demos/layout-customizemenu)ï¼Œåœ¨2.3.26ç‰ˆæœ¬ä¸Šï¼Œç‚¹å‡»å³ä¾§ç°è‰²åŒºåŸŸï¼Œå¯ä»¥æ”¶èµ·èœå•çš„ï¼Œä½†æ˜¯ä¹‹åçš„ç‰ˆæœ¬å°±ä¸èƒ½äº†ï¼Œå¸Œæœ›èƒ½æ¢å¤æ­¤åŠŸèƒ½ï½

<img width="576" alt="image" src="https://user-images.githubusercontent.com/16148054/200979544-fa110641-fc9d-46e2-9be9-8b51ddf82792.png">

### ğŸ“· å¤ç°æ­¥éª¤

<!--
æ¸…æ™°æè¿°å¤ç°æ­¥éª¤ï¼Œè®©åˆ«äººä¹Ÿèƒ½çœ‹åˆ°é—®é¢˜ï¼Œå¦‚æœå¯èƒ½ï¼Œå°½é‡æä¾›å¯æ‰§è¡Œä»£ç ï¼Œ
å¦‚ï¼šhttps://codesandbox.io/ åœ¨æ­¤å¤„åˆ›å»ºä¸€ä¸ª codesandboxï¼Œæ–¹ä¾¿æˆ‘ä»¬æ›´å¿«çš„æ’æŸ¥å’Œå¤ç°é—®é¢˜
-->

### ğŸ æœŸæœ›ç»“æœ

<!--
æè¿°ä½ åŸæœ¬æœŸæœ›çœ‹åˆ°çš„ç»“æœ
-->

### ğŸ’» å¤ç°ä»£ç 

<!--
æä¾›å¯å¤ç°çš„ä»£ç ï¼Œä»“åº“ï¼Œæˆ–çº¿ä¸Šç¤ºä¾‹
-->

### Â© ç‰ˆæœ¬ä¿¡æ¯

- ProComponents ç‰ˆæœ¬: [e.g. 4.0.0] 2.3.30
- umi ç‰ˆæœ¬
- æµè§ˆå™¨ç¯å¢ƒ chrome 107.0.5304.87
- å¼€å‘ç¯å¢ƒ [e.g. mac OS] macos

### ğŸš‘ å…¶ä»–ä¿¡æ¯

<!--
å¦‚æˆªå›¾ç­‰å…¶ä»–ä¿¡æ¯å¯ä»¥è´´åœ¨è¿™é‡Œ
-->

## xXAvoraXx

è¿™ä¸ªé—®é¢˜æœ‰ä»€ä¹ˆè§£å†³åŠæ³•å—ï¼Ÿ

## mashirozx

åœ¨initialStateé‡Œé¢è®¾ç½®ä¸€ä¸ªBooleanå˜é‡ï¼Œä¼ ç»™ProLayoutçš„collapseé€‰é¡¹ä»¥æ§åˆ¶èœå•å±•å¼€ï¼Œæœ€åè‡ªå·±å†™ä¸€ä¸ªz-index=999çš„å…¨å±å…ƒç´ ï¼Œç‚¹å‡»æ—¶è§¦å‘æ”¶èµ·èœå•

## xXAvoraXx

"åœ¨initialStateé‡Œé¢è®¾ç½®ä¸€ä¸ªBooleanå˜é‡ï¼Œä¼ ç»™ProLayoutçš„collapseé€‰é¡¹ä»¥æ§åˆ¶èœå•å±•å¼€" <-- æˆ‘ç…§ä½ è¯´çš„åšäº†ã€‚
"æœ€åè‡ªå·±å†™ä¸€ä¸ªz-index=999çš„å…¨å±å…ƒç´ ï¼Œç‚¹å‡»æ—¶è§¦å‘æ”¶èµ·èœå•" <--- æˆ‘ä¸æ˜ç™½è¿™éƒ¨åˆ†ã€‚

## mashirozx

å°±æ˜¯è‡ªå·±å†™ä¸€ä¸ªå…ƒç´ å åœ¨ç°è‰²åŒºåŸŸ

## xXAvoraXx

å®šä¹‰layoutçš„éƒ¨åˆ†æ²¡æœ‰maskClosableå±æ€§ï¼Œæ€ä¹ˆå†™ç‚¹å‡»ç°è‰²åŒºåŸŸåº”è¯¥å…³é—­å‘¢ï¼Ÿ

```
export const layout: RunTimeLayoutConfig = ({ initialState, setInitialState }) => {
  const { collapsed } = initialState ?? {};

  return {
    rightContentRender: () => <RightContent />,
    waterMarkProps: {
      content: initialState?.currentUser?.name,
    },
    collapsed: collapsed,
    onCollapse: (val) => {
      setInitialState((preInitialState) => ({
        ...preInitialState,
        collapsed: val,
      }));
    },
    collapsedButtonRender: (col?, defaultDom?) => {
      return (
        <Button
          onClick={() => {
            setInitialState((preInitialState) => ({
              ...preInitialState,
              collapsed: !col,
            }));
          }}
        >
          {collapsed ? <MenuUnfoldOutlined /> : <MenuFoldOutlined />}
        </Button>
      );
    },
    footerRender: () => <Footer />,
    onPageChange: () => {
      const { location } = history;
      // å¦‚æœæ²¡æœ‰ç™»å½•ï¼Œé‡å®šå‘åˆ° login
      if (!initialState?.currentUser && location.pathname !== loginPath) {
        history.push(loginPath);
      }
    },
    menuHeaderRender: undefined,
    // è‡ªå®šä¹‰ 403 é¡µé¢
    // unAccessible: <div>unAccessible</div>,
    // å¢åŠ ä¸€ä¸ª loading çš„çŠ¶æ€
    childrenRender: (children, props) => {
      // if (initialState?.loading) return <PageLoading />;
      return (
        <>
          {children}
          {!props.location?.pathname?.includes('/login') && (
            <SettingDrawer
              disableUrlParams
              enableDarkTheme
              settings={initialState?.settings}
              onSettingChange={(settings) => {
                setInitialState((preInitialState) => ({
                  ...preInitialState,
                  settings,
                }));
              }}
            />
          )}
        </>
      );
    },
    ...initialState?.settings,
  };
};
```

## mashirozx

æˆ‘æ„æ€å°±æ˜¯ä¸è¦å®ƒçš„ï¼Œè‡ªå·±å†™ä¸€ä¸ªç‚¹å‡»åŒºåŸŸå‘€
<img width="1624" alt="image" src="https://user-images.githubusercontent.com/16148054/203981025-db441ce3-d7d4-4277-b9bc-92322a004a01.png">

<img width="535" alt="image" src="https://user-images.githubusercontent.com/16148054/203981136-c28676cf-9aa9-4e85-8906-19a2163a599c.png">

## hinego

æœ‰è§£å†³æ–¹æ¡ˆäº†å—

## xXAvoraXx

> æœ‰è§£å†³æ–¹æ¡ˆäº†å—
> æˆ‘æ‰¾ä¸åˆ°è§£å†³æ–¹æ¡ˆï¼Œæ‰€ä»¥æˆ‘å°†ä½¿ç”¨æ—§ä¸»é¢˜ã€‚
> I couldn't find a solution so I'm going with the old theme.

## mashirozx

æˆ‘å¸–çš„ä¸å°±æ˜¯è§£å†³æ–¹æ¡ˆä¹ˆâ€¦

## xXAvoraXx

> æˆ‘å¸–çš„ä¸å°±æ˜¯è§£å†³æ–¹æ¡ˆä¹ˆâ€¦

è¿™ä¸æ˜¯æè¿°æ€§çš„ã€‚

## mashirozx

å°±å·®æŠŠé¡¹ç›®æºç ç»™ä½ äº†ğŸ‘
