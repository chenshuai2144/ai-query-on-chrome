# ğŸ›[BUG]å¯ç¼–è¾‘è¡¨æ ¼çš„æ—¥æœŸåˆ—ï¼Œè·å–æ ¼å¼åŒ–æ•°æ®æ—¶æ²¡æŒ‰ç…§æŒ‡å®šçš„æ—¥æœŸæ ¼å¼

`form`,`ğŸ“¦  Need to reproduce`,`AI Reply`

æé—®å‰å…ˆçœ‹çœ‹ï¼š

https://github.com/ryanhanwu/How-To-Ask-Questions-The-Smart-Way/blob/main/README-zh_CN.md

### ğŸ› bug æè¿°

å¯ç¼–è¾‘è¡¨æ ¼çš„æ—¥æœŸåˆ—ï¼Œç”¨fieldProps.formatæŒ‡å®šäº†æ—¥æœŸæ ¼å¼ï¼Œä½†æ˜¯ä½¿ç”¨formçš„getFieldsFormatValueå’Œtableçš„getRowsDataè·å–æ•°æ®æ—¶ï¼Œæ‹¿åˆ°çš„éƒ½æ˜¯æ ‡å‡†æ—¶é—´æ ¼å¼çš„æ•°æ®ï¼Œä¸æ˜¯æŒ‡å®šçš„æ—¥æœŸæ ¼å¼

### ğŸ“· å¤ç°æ­¥éª¤

æ ·ä¾‹ä»£ç ä¸­ï¼Œç‚¹å‡»â€œè·å–tableæ•°æ®â€æŸ¥çœ‹æç¤ºä¿¡æ¯ã€ç‚¹å‡»â€œæäº¤â€æŸ¥çœ‹æ§åˆ¶å°

### ğŸ æœŸæœ›ç»“æœ

æ—¥æœŸåˆ—updDateæŒ‰ç…§æŒ‡å®šçš„æ—¥æœŸæ ¼å¼è¿›è¡Œæ ¼å¼åŒ–

### ğŸ’» å¤ç°ä»£ç 

import { useRef } from 'react';
import { message, Button } from 'antd';
import type { ProFormInstance} from '@ant-design/pro-form';
import { ProForm } from '@ant-design/pro-form';
import type { EditableFormInstance, ProColumns } from '@ant-design/pro-table';
import { EditableProTable } from '@ant-design/pro-table';

const BasicTest: React.FC = () => {
const formRef = useRef<ProFormInstance>();

// å¯ç»´æŠ¤åˆ—è¡¨
type TestModel = {
rowIndex: number;
code: string;
name: string;
updDate?: string;
desc: string;
};
const columns: ProColumns<TestModel>[] = [
{
title: 'ä»£ç ',
dataIndex: 'code',
formItemProps: {
rules: [{ required: true }],
},
},
{
title: 'åç§°',
dataIndex: 'name',
},
{
title: 'ä¿®æ”¹æ—¥æœŸ',
dataIndex: 'updDate',
valueType: 'date',
fieldProps: {
format: 'YYYYMMDD',
}
},
{
title: 'è¯´æ˜',
dataIndex: 'desc',
},
{
title: 'æ“ä½œ',
valueType: 'option',
width: 200,
render: (\_1, record, \_2, action) => [
<a
key="editable"
onClick={() => {
const obj: any = action;
if (obj.editableKeys.length <= 0) {
action?.startEditable?.(record.rowIndex || 0);
} else {
message.warning('å­˜åœ¨æ­£åœ¨ç¼–è¾‘è¡Œï¼Œè¯·å®Œæˆæ­£åœ¨ç¼–è¾‘è¡Œ');
}
}}
>
ç¼–è¾‘
</a>,
],
},
];
const dataSource: TestModel[] = [
{ rowIndex: 2, code: 'code1', name: 'name1', desc: 'desc1' },
{ rowIndex: 3, code: 'code2', name: 'name2', desc: 'desc2' },
];
// å¯ç¼–è¾‘è¡¨æ ¼formä½¿ç”¨æ ·ä¾‹
const editorFormRef = useRef<EditableFormInstance<TestModel>>();

return (
<ProForm<{
table: TestModel[];
}>
initialValues={{
                table: dataSource,
              }}
validateTrigger="onBlur"
formRef={formRef}
onFinish={async () => {
console.log(formRef.current?.getFieldsFormatValue?.());
}} >
<EditableProTable<TestModel>
name="table"
rowKey="rowIndex"
toolBarRender={() => [
<Button
key="rows"
onClick={() => {
const rows = editorFormRef.current?.getRowsData?.();
alert(JSON.stringify(rows));
}}
>
è·å– table çš„æ•°æ®
</Button>,
]}
columns={columns}
editableFormRef={editorFormRef}
recordCreatorProps={{
                  record: () => {
                    return {
                      rowIndex: Date.now(),
                    } as unknown as TestModel;
                  },
                }}
editable={{
                  saveText: 'ç¡®å®š',
                }}
/>
</ProForm>
);
};

export default BasicTest;

### Â© ç‰ˆæœ¬ä¿¡æ¯

- ProComponents ç‰ˆæœ¬:2.3.46
- umi ç‰ˆæœ¬
- æµè§ˆå™¨ç¯å¢ƒ
- å¼€å‘ç¯å¢ƒ [e.g. mac OS]

### ğŸš‘ å…¶ä»–ä¿¡æ¯

## chenshuai2144

ä¿®å¤äº†ï¼Œå› ä¸ºdayjs çš„ç‰ˆæœ¬é‡å¤å¯¼è‡´çš„
