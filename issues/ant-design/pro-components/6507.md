# 🐛[BUG]内网pro-table查询表格报错es_form.a.useFormInstance is not a function

`AI Reply`

提问前先看看：

https://github.com/ryanhanwu/How-To-Ask-Questions-The-Smart-Way/blob/main/README-zh_CN.md

### 🐛 bug 描述

内网环境 使用pro-table查询表格报错（外网查询表格不会报错）（内网无查询表单不会报错）

es_form.a.useFormInstance is not a function
<img width="635" alt="微信截图_20230112174007" src="https://user-images.githubusercontent.com/41141486/212032299-aeb780a9-79af-4311-ac10-9163473914e4.png">
![Uploading 微信截图_20230112174007.png…]()

本来应该是这个demo
<img width="603" alt="微信截图_20230112174136" src="https://user-images.githubusercontent.com/41141486/212032543-0e914fa6-b82a-4c75-9b9f-21386ba2ef4f.png">

### 📷 复现步骤

用的是官网Protable查询表格的案例 [查询表格](https://procomponents.ant.design/components/table#%E6%9F%A5%E8%AF%A2%E8%A1%A8%E6%A0%BC)
只是把@ant-design/pro-components的引用修改为@ant-design/pro-table

"umi": "^3.5.23",
"antd": "4.18.7",
"@ant-design/pro-table": "^2.80.8",

import ProTable, { ProColumns, ActionType, TableDropdown } from '@ant-design/pro-table';

### © 版本信息

- ProComponents 版本: [e.g. 4.0.0]
- umi 版本
- 浏览器环境
- 开发环境 [e.g. mac OS]

  ## lonllua

  https://ant.design/components/form-cn#formuseforminstance
  <img width="670" alt="image" src="https://user-images.githubusercontent.com/5119408/216314292-93f2c4c3-ed47-4eee-96e6-34067f1ae3a9.png">

  ## chenshuai2144

> TAutomatically replying with ChatGPT can be attempted, but it cannot be guaranteed to be completely accurate and may not fully address all issues. Please feel free to reply if you have any further questions or concerns.
> 此回复基于 ChatGPT 自动生成，可以尝试下方案，官方员会在一定时间后继续继续处理。

从报错信息来看，似乎是使用了一个名为 `useFormInstance` 的函数，但是该函数未被定义。因此，可能是由于在内网环境下对 `@ant-design/pro-form` 的引用有问题。你可以参照官方文档了解使用 `@ant-design/pro-form` 时如何使用 `useFormInstance` 函数。

首先，确保已按照官方文档的要求正确引用 `@ant-design/pro-table`，在组件中正确地使用 `ProTable` 和 `ProColumns`。

然后，你需要引入 `@ant-design/pro-form` 并正确初始化 `FormProvider`。我推荐使用 `useForm` hook 获取一个 `form` 对象的引用，而不使用 `useFormInstance` 函数。

代码示例：

```jsx
import React from 'react';
import { FormProvider, useForm } from 'antd';
import ProTable, { ProColumns } from '@ant-design/pro-table';

// 定义表格列类型
type DataType = {
  name: string;
  age: number;
  address: string;
};

// 定义表格列
const columns: ProColumns<DataType>[] = [
  {
    title: '姓名',
    dataIndex: 'name',
    search: false,
  },
  {
    title: '年龄',
    dataIndex: 'age',
  },
  {
    title: '住址',
    dataIndex: 'address',
    search: false,
  },
];

// 定义数据
const data: DataType[] = [
  {
    name: 'John Doe',
    age: 25,
    address: 'New York',
  },
  {
    name: 'Jane Doe',
    age: 30,
    address: 'Los Angeles',
  },
];

export default function MyTable() {
  const [form] = useForm(); // 获取 form 对象的引用
  return (
    <FormProvider {...form}>
      <ProTable<DataType>
        columns={columns}
        dataSource={data}
        search={false}
      />
    </FormProvider>
  );
}
```

你也可以尝试更新 `@ant-design/pro-table` 和 `@ant-design/pro-form` 来解决问题。

也可以通过清除项目依赖重新安装解决问题：

1. 删除 `node_modules` 目录
2. 删除 `package-lock.json` 或 `yarn.lock` 文件
3. 运行 `npm cache clean --force` 或 `yarn cache clean`
4. 运行 `npm install` 或 `yarn install` 重新安装依赖

如果这些方法都没有解决问题，你可以查看你的项目是否有与 `useFormInstance` 重名的函数或方法。
