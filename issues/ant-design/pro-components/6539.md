# ğŸ›[BUG]EditableProTable ä½¿ç”¨editableFormRefåï¼Œæ— æ³•ç”¨formRef.current.setFieldsValueæ”¹å˜tableçš„å€¼

`AI Reply`

### ğŸ› bug æè¿°

ä½¿ç”¨editableFormRefåï¼Œæ— æ³•ç”¨formRef.current.setFieldsValueæ”¹å˜tableçš„å€¼ï¼š

![1](https://user-images.githubusercontent.com/29675005/214486640-2b9af0d0-b3b2-476a-9d1a-a455c4e89996.gif)

### ğŸ“· å¤ç°æ­¥éª¤

https://codesandbox.io/s/edittable-7ih3ww?file=/App.tsx

å¤ç°ä»£ç ï¼š

```
import { EditableFormInstance, ProColumns, ProFormInstance, ProFormItem } from '@ant-design/pro-components';
import { EditableProTable, ProForm, ProFormTextArea, ProFormRadio } from '@ant-design/pro-components';
import React, { useRef, useState } from 'react';
import { Button } from 'antd';

const defaultData: any = [
  {
    id: 624748504,
    title: 'æ´»åŠ¨åç§°ä¸€',
    decs: 'è¿™ä¸ªæ´»åŠ¨çœŸå¥½ç©',
    state: 'open',
    created_at: '1590486176000',
    update_at: '1590486176000',
  },
  {
    id: 624748505,
    title: 'æ´»åŠ¨åç§°ä¸€2',
    decs: 'è¿™ä¸ªæ´»åŠ¨çœŸå¥½ç©',
    state: 'open',
    created_at: '1590486176000',
    update_at: '1590486176000',
  },
];

export default () => {
  const [editableKeys, setEditableRowKeys] = useState<React.Key[]>(() => [624748504]);
  const formRef = useRef<any>();
  const editorFormRef = useRef<EditableFormInstance<any>>();
  const columns: ProColumns<any>[] = [
    {
      title: 'æ´»åŠ¨åç§°',
      dataIndex: 'title',
      formItemProps: () => {
        return {
          rules: [{ required: true, message: 'æ­¤é¡¹ä¸ºå¿…å¡«é¡¹' }],
        };
      },
      width: '30%',
    },
    {
      title: 'çŠ¶æ€',
      key: 'state',
      dataIndex: 'state',
      valueType: 'select',
      valueEnum: {
        all: { text: 'å…¨éƒ¨', status: 'Default' },
        open: {
          text: 'æœªè§£å†³',
          status: 'Error',
        },
        closed: {
          text: 'å·²è§£å†³',
          status: 'Success',
        },
      },
    },
    {
      title: 'æè¿°',
      dataIndex: 'decs',
    },
    {
      title: 'æ´»åŠ¨æ—¶é—´',
      dataIndex: 'created_at',
      valueType: 'date',
    },
  ];
  return (
    <>
      {' '}
      <Button
        onClick={() => {
          const rowId = Date.now();
          //é€šè¿‡formRefæ”¹å˜å€¼
          formRef.current.setFieldsValue({
            data: [
              {
                id: rowId,
                title: rowId.toString(),
                decs: 'è¿™ä¸ªæ´»åŠ¨çœŸå¥½ç©',
                state: 'open',
                created_at: '1590486176000',
                update_at: '1590486176000',
              },
            ],
          });
          setEditableRowKeys([rowId]);
        }}
      >
        è®¾ç½®Editableå€¼
      </Button>
      <ProForm<{
        table: any;
      }>
        formRef={formRef}
        submitter={false}
        initialValues={{ data: defaultData }}
      >
          <EditableProTable<any>
            rowKey="id"
            scroll={{
              x: 960,
            }}
            editableFormRef={editorFormRef}
            headerTitle="å¯ç¼–è¾‘è¡¨æ ¼"
            maxLength={5}
            name="data"
            toolBarRender={false}
            columns={columns}
            editable={{
              type: 'multiple',
              editableKeys,
              onChange: setEditableRowKeys,
              actionRender: (row, _, dom) => {
                return [dom.delete];
              },
            }}
          />
      </ProForm>
    </>
  );
};

```

### ğŸ æœŸæœ›ç»“æœ

èƒ½å¤Ÿæ”¹å˜å…¶å€¼

### Â© ç‰ˆæœ¬ä¿¡æ¯

- ProComponents ç‰ˆæœ¬: [2.3.52]

### ğŸš‘ å…¶ä»–ä¿¡æ¯

## XueMeijing

Tableå¤–å±‚å¢åŠ ProFormItemï¼ŒProFormItemä½¿ç”¨name="data"å¯ä»¥è§£å†³è¿™ä¸ªé—®é¢˜

```
<ProFormItem name="data">
  <EditableProTable<any>
    rowKey="id"
    scroll={{
      x: 960
    }}
    editableFormRef={editorFormRef}
    headerTitle="å¯ç¼–è¾‘è¡¨æ ¼"
    maxLength={5}
    toolBarRender={false}
    columns={columns}
    editable={{
      type: "multiple",
      editableKeys,
      onChange: setEditableRowKeys,
      actionRender: (row, _, dom) => {
        return [dom.delete];
      }
    }}
  />
</ProFormItem>
```

## chenshuai2144

> TAutomatically replying with ChatGPT can be attempted, but it cannot be guaranteed to be completely accurate and may not fully address all issues. Please feel free to reply if you have any further questions or concerns.
> æ­¤å›å¤åŸºäº ChatGPT è‡ªåŠ¨ç”Ÿæˆï¼Œå¯ä»¥å°è¯•ä¸‹æ–¹æ¡ˆï¼Œå®˜æ–¹å‘˜ä¼šåœ¨ä¸€å®šæ—¶é—´åç»§ç»­ç»§ç»­å¤„ç†ã€‚

æ„Ÿè°¢æ‚¨æä¾›äº†è§£å†³æ–¹æ¡ˆï¼Œæ‚¨æä¾›çš„æ–¹æ³•å¯ä»¥é€šè¿‡åœ¨ Table å¤–å±‚å°è£…ä¸€ä¸ª ProFormItemï¼Œå°† Table ç»‘å®šåˆ°æŒ‡å®š name ä¸Šï¼Œè®© formRef åˆå§‹åŒ–æ—¶åˆå§‹åŒ–å¯¹åº”çš„æ•°æ®ï¼Œä½†æ˜¯è¿™ç§æ–¹å¼ä¼šå¢åŠ ä»£ç çš„åµŒå¥—å±‚æ¬¡ï¼Œä¸è¿‡èƒ½å¤Ÿè§£å†³æ‚¨çš„é—®é¢˜ï¼Œä»£ç å¦‚ä¸‹ï¼š

```
<ProForm>
  <ProFormItem name="data">
    <EditableProTable<any>
      // çœç•¥å…¶ä»–ä»£ç ...
    />
  </ProFormItem>
</ProForm>
```

è¿˜æœ‰ä¸€ç§æ–¹æ³•ï¼Œå°±æ˜¯é€šè¿‡å¯¹ EditableProTable ç»„ä»¶çš„å¼€å‘æ—¶åˆå§‹åŒ–è¡¨å•æ•°æ®è¿™ä¸ªé˜¶æ®µç»‘å®šä¸€ä¸ªå›è°ƒå‡½æ•°ï¼Œè®©å›è°ƒå‡½æ•°çš„å‚æ•°å°±æ˜¯ form å¯¹è±¡ï¼Œè¿™åŒºåˆ«æ˜¯ä¸éœ€è¦åœ¨ Table å¤–å¢åŠ  ProFormItem çš„åŒ…è£…å±‚ï¼Œä½†æ˜¯éœ€è¦ä¿®æ”¹ç»„ä»¶æºç ã€‚å¦‚æœæ‚¨æ„Ÿå…´è¶£å¯ä»¥è‡ªè¡Œäº†è§£ã€‚

## chengmaoning

> Tableå¤–å±‚å¢åŠ ProFormItemï¼ŒProFormItemä½¿ç”¨name="data"å¯ä»¥è§£å†³è¿™ä¸ªé—®é¢˜
>
> ```
> <ProFormItem name="data">
>   <EditableProTable<any>
>     rowKey="id"
>     scroll={{
>       x: 960
>     }}
>     editableFormRef={editorFormRef}
>     headerTitle="å¯ç¼–è¾‘è¡¨æ ¼"
>     maxLength={5}
>     toolBarRender={false}
>     columns={columns}
>     editable={{
>       type: "multiple",
>       editableKeys,
>       onChange: setEditableRowKeys,
>       actionRender: (row, _, dom) => {
>         return [dom.delete];
>       }
>     }}
>   />
> </ProFormItem>
> ```

å¤§å“¥ï¼Œå¼ºï¼Œå¼ºçƒˆå»ºè®®å®˜æ–¹ç¤ºä¾‹å¢åŠ ProFormItemåŒ…å›´EditableProTableï¼Œä»¥å…å‡ºç°ä»¥ä¸Šé—®é¢˜åŠå…¶ä»–é—®é¢˜ï¼ˆæˆ‘åœ¨ç¼–è¾‘-cancelæ—¶å€™å‘ç°ï¼Œcanceläº†cellçš„å€¼å°±æ²¡äº†ã€‚ã€‚ã€‚ï¼‰
