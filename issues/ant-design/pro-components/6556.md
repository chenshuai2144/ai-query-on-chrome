# findDOMNode is deprecated in StrictMode.

`AI Reply`

### ğŸ› bug æè¿°

findDOMNode is deprecated in StrictMode.

### ğŸ“· å¤ç°æ­¥éª¤ | Recurrence steps

åœ¨ä¸¥æ ¼æ¨¡å¼ä¸‹ä½¿ç”¨ ant-design-pro ä¼šå‡ºç° warning: findDOMNode is deprecated in StrictMode.
è¿™ä¸ªæŠ¥é”™ä¸»è¦ç”± @ant-design/pro-form å¯¼è‡´

### ğŸ æœŸæœ›ç»“æœ | Expected results

react å¯èƒ½åœ¨æŸä¸ªç‰ˆæœ¬çš„ä¸¥æ ¼æ¨¡å¼ä¸‹æ­£å¼ç§»é™¤ findDOMNodeï¼Œ å¦‚æœå¯ä»¥çš„è¯ä½¿ç”¨ ref ä»£æ›¿

### ğŸ’» å¤ç°ä»£ç  | Recurrence code

![image](https://user-images.githubusercontent.com/30885718/216213189-40b62b4e-1e17-48ae-bb03-67e62d724c40.png)

### Â© ç‰ˆæœ¬ä¿¡æ¯

- ProComponents ç‰ˆæœ¬: latest
- umi ç‰ˆæœ¬
- æµè§ˆå™¨ç¯å¢ƒ
- å¼€å‘ç¯å¢ƒ: every

### ğŸš‘ å…¶ä»–ä¿¡æ¯

## chenshuai2144

> TAutomatically replying with ChatGPT can be attempted, but it cannot be guaranteed to be completely accurate and may not fully address all issues. Please feel free to reply if you have any further questions or concerns.
> æ­¤å›å¤åŸºäº ChatGPT è‡ªåŠ¨ç”Ÿæˆï¼Œå¯ä»¥å°è¯•ä¸‹æ–¹æ¡ˆï¼Œå®˜æ–¹å‘˜ä¼šåœ¨ä¸€å®šæ—¶é—´åç»§ç»­ç»§ç»­å¤„ç†ã€‚

æ­¤é—®é¢˜æ˜¯ç”±äº React å®˜æ–¹åœ¨ Strict Mode ä¸‹å‡ºäºæ€§èƒ½å’Œç¨³å®šæ€§è€ƒè™‘ï¼Œä¸å»ºè®®ä½¿ç”¨ `findDOMNode` APIï¼Œå¹¶ä¸”å¯èƒ½åœ¨æœªæ¥çš„ç‰ˆæœ¬ä¸­å®Œå…¨ç§»é™¤è¯¥ APIã€‚

ä¸ºäº†é¿å…è¿™ä¸ªé—®é¢˜ï¼Œå¯ä»¥å°è¯•ä½¿ç”¨ React çš„ `ref` API æ›¿ä»£ `findDOMNode`ã€‚å…·ä½“åŒ…æ‹¬ï¼š

1. åœ¨ç»„ä»¶ä¸­ä½¿ç”¨ `React.createRef()` åˆ›å»ºä¸€ä¸ª `ref` å¯¹è±¡
2. åœ¨æ¸²æŸ“çš„å…ƒç´ ä¸Šæ·»åŠ  `ref={this.xxxRef}` å±æ€§
3. åœ¨éœ€è¦ä½¿ç”¨ DOM å…ƒç´ æ—¶ï¼Œé€šè¿‡ `this.xxxRef.current` è·å– DOM å…ƒç´ 

ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š

```jsx
import React from "react";

class MyComponent extends React.Component {
  constructor(props) {
    super(props);
    this.myRef = React.createRef();
  }

  componentDidMount() {
    const domNode = this.myRef.current; // è·å– DOM å…ƒç´ 
    // åšä¸€äº›å…³äº DOM å…ƒç´ çš„æ“ä½œ
  }

  render() {
    return <div ref={this.myRef}>Hello, World!</div>;
  }
}
```

å¦å¤–ï¼ŒAnt Design å®˜æ–¹ä¹Ÿæä¾›äº†ä¸€ä¸ªæ›¿ä»£æ–¹æ³•ã€‚æ‚¨å¯ä»¥ä½¿ç”¨ `ReactDOM.findDOMNode()` æ›¿ä»£ `findDOMNode`ï¼Œå¹¶å°†å…¶ä¼ é€’åˆ°ç»„ä»¶çš„ `ref` å±æ€§ä¸­ã€‚ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š

```jsx
import React from "react";
import ReactDOM from "react-dom";
import { Form, Input, Button } from "antd";

const MyForm = () => {
  const [form] = Form.useForm();
  const inputRef = React.useRef(null);

  React.useEffect(() => {
    const inputNode = ReactDOM.findDOMNode(inputRef.current); // è·å– DOM å…ƒç´ 
    // åšä¸€äº›å…³äº DOM å…ƒç´ çš„æ“ä½œ
  }, []);

  return (
    <Form form={form}>
      <Form.Item name="username" label="Username">
        <Input ref={inputRef} />
      </Form.Item>
      <Form.Item>
        <Button type="primary" htmlType="submit">
          Submit
        </Button>
      </Form.Item>
    </Form>
  );
};
```

å‚è€ƒæ–‡æ¡£ï¼š

- [React æ–‡æ¡£ï¼šRefs and the DOM](https://zh-hans.reactjs.org/docs/refs-and-the-dom.html)
- [Ant Design Pro Issue #1375: findDOMNode is deprecated in StrictMode with ProForm](https://github.com/ant-design/ant-design-pro/issues/1375)

  ## chenshuai2144

  antdæ­£åœ¨å¤„ç†è¿™ä¸ªäº‹æƒ…ï¼Œç­‰ antd å¤„ç†å§

  ## imoxuan

  ç›®å‰è¿™ä¸ªæƒ…å†µè¿˜å­˜åœ¨ï¼Œé™å€™ä½³éŸ³ã€‚

  ## InfernalAzazel

  > antdæ­£åœ¨å¤„ç†è¿™ä¸ªäº‹æƒ…ï¼Œç­‰antdå¤„ç†å§

ProTable ä¹Ÿè¿™æ ·

```shell
 "@ant-design/icons": "^5.2.6",
 "@ant-design/pro-components": "^2.6.18",
 "antd": "^5.9.0",
```

```shell
Warning: findDOMNode is deprecated in StrictMode. findDOMNode was passed an instance of DomWrapper4 which is inside StrictMode. Instead, add a ref directly to the element you want to reference. Learn more about using refs safely here: https://reactjs.org/link/strict-mode-find-node
span
node_modules/.pnpm/@ant-design+icons@5.2.6_biqbaboplfbrettd7655fr4n2y/node_modules/@ant-design/icons/es/components/AntdIcon.js/Icon<@http://localhost:5173/node_modules/.vite/deps/chunk-FVA6KA4L.js?v=1d334a01:1948:23
ColumnHeightOutlined
node_modules/.pnpm/@rc-component+trigger@1.15.6_biqbaboplfbrettd7655fr4n2y/node_modules/@rc-component/trigger/es/TriggerWrapper.js/TriggerWrapper<@http://localhost:5173/node_modules/.vite/deps/chunk-TFK7O3NU.js?v=1d334a01:19721:22
DomWrapper4@http://localhost:5173/node_modules/.vite/deps/chunk-TFK7O3NU.js?v=1d334a01:432:24
SingleObserver@http://localhost:5173/node_modules/.vite/deps/chunk-TFK7O3NU.js?v=1d334a01:482:18
ResizeObserver2@http://localhost:5173/node_modules/.vite/deps/chunk-TFK7O3NU.js?v=1d334a01:570:18
generateTrigger/Trigger<@http://localhost:5173/node_modules/.vite/deps/chunk-TFK7O3NU.js?v=1d334a01:19742:28
Tooltip2@http://localhost:5173/node_modules/.vite/deps/chunk-TFK7O3NU.js?v=1d334a01:25102:30
node_modules/.pnpm/antd@5.9.0_biqbaboplfbrettd7655fr4n2y/node_modules/antd/es/tooltip/index.js/Tooltip3<@http://localhost:5173/node_modules/.vite/deps/chunk-TFK7O3NU.js?v=1d334a01:25807:11
node_modules/.pnpm/@rc-component+trigger@1.15.6_biqbaboplfbrettd7655fr4n2y/node_modules/@rc-component/trigger/es/TriggerWrapper.js/TriggerWrapper<@http://localhost:5173/node_modules/.vite/deps/chunk-TFK7O3NU.js?v=1d334a01:19721:22
DomWrapper4@http://localhost:5173/node_modules/.vite/deps/chunk-TFK7O3NU.js?v=1d334a01:432:24
SingleObserver@http://localhost:5173/node_modules/.vite/deps/chunk-TFK7O3NU.js?v=1d334a01:482:18
ResizeObserver2@http://localhost:5173/node_modules/.vite/deps/chunk-TFK7O3NU.js?v=1d334a01:570:18
generateTrigger/Trigger<@http://localhost:5173/node_modules/.vite/deps/chunk-TFK7O3NU.js?v=1d334a01:19742:28
Dropdown@http://localhost:5173/node_modules/.vite/deps/chunk-TFK7O3NU.js?v=1d334a01:27520:22
Dropdown2@http://localhost:5173/node_modules/.vite/deps/chunk-TFK7O3NU.js?v=1d334a01:31793:11
DensityIcon2@http://localhost:5173/node_modules/.vite/deps/@ant-design_pro-components.js?v=45887203:37844:49
node_modules/.pnpm/@rc-component+trigger@1.15.6_biqbaboplfbrettd7655fr4n2y/node_modules/@rc-component/trigger/es/TriggerWrapper.js/TriggerWrapper<@http://localhost:5173/node_modules/.vite/deps/chunk-TFK7O3NU.js?v=1d334a01:19721:22
DomWrapper4@http://localhost:5173/node_modules/.vite/deps/chunk-TFK7O3NU.js?v=1d334a01:432:24
SingleObserver@http://localhost:5173/node_modules/.vite/deps/chunk-TFK7O3NU.js?v=1d334a01:482:18
ResizeObserver2@http://localhost:5173/node_modules/.vite/deps/chunk-TFK7O3NU.js?v=1d334a01:570:18
generateTrigger/Trigger<@http://localhost:5173/node_modules/.vite/deps/chunk-TFK7O3NU.js?v=1d334a01:19742:28
Tooltip2@http://localhost:5173/node_modules/.vite/deps/chunk-TFK7O3NU.js?v=1d334a01:25102:30
node_modules/.pnpm/antd@5.9.0_biqbaboplfbrettd7655fr4n2y/node_modules/antd/es/tooltip/index.js/Tooltip3<@http://localhost:5173/node_modules/.vite/deps/chunk-TFK7O3NU.js?v=1d334a01:25807:11
span
div
div
div
div
div
DomWrapper4@http://localhost:5173/node_modules/.vite/deps/chunk-TFK7O3NU.js?v=1d334a01:432:24
SingleObserver@http://localhost:5173/node_modules/.vite/deps/chunk-TFK7O3NU.js?v=1d334a01:482:18
ResizeObserver2@http://localhost:5173/node_modules/.vite/deps/chunk-TFK7O3NU.js?v=1d334a01:570:18
ListToolBar2@http://localhost:5173/node_modules/.vite/deps/@ant-design_pro-components.js?v=45887203:37656:28
ToolBar@http://localhost:5173/node_modules/.vite/deps/@ant-design_pro-components.js?v=45887203:37968:21
ToolbarRender2@http://localhost:5173/node_modules/.vite/deps/@ant-design_pro-components.js?v=45887203:38050:20
div
div
Card<@http://localhost:5173/node_modules/.vite/deps/@ant-design_pro-components.js?v=45887203:14710:19
div
TableRender@http://localhost:5173/node_modules/.vite/deps/@ant-design_pro-components.js?v=45887203:39078:16
ProTable2@http://localhost:5173/node_modules/.vite/deps/@ant-design_pro-components.js?v=45887203:39268:22
ErrorBoundary2@http://localhost:5173/node_modules/.vite/deps/@ant-design_pro-components.js?v=45887203:10759:20
ProConfigProvider2@http://localhost:5173/node_modules/.vite/deps/@ant-design_pro-components.js?v=45887203:10629:18
Container2@http://localhost:5173/node_modules/.vite/deps/@ant-design_pro-components.js?v=45887203:36913:15
ProviderTableContainer2@http://localhost:5173/node_modules/.vite/deps/@ant-design_pro-components.js?v=45887203:39643:52
@http://localhost:5173/src/pages/admin/system/menu.tsx?t=1694235281363:25:27
Suspense
RenderedRoute@http://localhost:5173/node_modules/.vite/deps/react-router-dom.js?v=9f973f5f:3330:7
Outlet@http://localhost:5173/node_modules/.vite/deps/react-router-dom.js?v=9f973f5f:3720:3
div
div
Card<@http://localhost:5173/node_modules/.vite/deps/@ant-design_pro-components.js?v=45887203:14710:19
div
div
div
GridContent2@http://localhost:5173/node_modules/.vite/deps/@ant-design_pro-components.js?v=45887203:28974:46
div
PageContainerBase2@http://localhost:5173/node_modules/.vite/deps/@ant-design_pro-components.js?v=45887203:29598:18
ProConfigProvider2@http://localhost:5173/node_modules/.vite/deps/@ant-design_pro-components.js?v=45887203:10629:18
PageContainer2
main
node_modules/.pnpm/antd@5.9.0_biqbaboplfbrettd7655fr4n2y/node_modules/antd/es/layout/layout.js/Basic<@http://localhost:5173/node_modules/.vite/deps/chunk-TFK7O3NU.js?v=1d334a01:29632:11
Content
ErrorBoundary2@http://localhost:5173/node_modules/.vite/deps/@ant-design_pro-components.js?v=45887203:10759:20
WrapContent2@http://localhost:5173/node_modules/.vite/deps/@ant-design_pro-components.js?v=45887203:34933:52
div
div
node_modules/.pnpm/antd@5.9.0_biqbaboplfbrettd7655fr4n2y/node_modules/antd/es/layout/layout.js/BasicLayout<@http://localhost:5173/node_modules/.vite/deps/chunk-TFK7O3NU.js?v=1d334a01:29647:20
Layout
div
BaseProLayout2@http://localhost:5173/node_modules/.vite/deps/@ant-design_pro-components.js?v=45887203:35058:7
MotionWrapper@http://localhost:5173/node_modules/.vite/deps/chunk-TFK7O3NU.js?v=1d334a01:5179:7
ProviderChildren@http://localhost:5173/node_modules/.vite/deps/chunk-TFK7O3NU.js?v=1d334a01:5370:11
ConfigProvider@http://localhost:5173/node_modules/.vite/deps/chunk-TFK7O3NU.js?v=1d334a01:5543:31
SWRConfig@http://localhost:5173/node_modules/.vite/deps/@ant-design_pro-components.js?v=45887203:7296:21
ConfigProviderContainer2@http://localhost:5173/node_modules/.vite/deps/@ant-design_pro-components.js?v=45887203:10540:18
LocaleProvider@http://localhost:5173/node_modules/.vite/deps/chunk-TFK7O3NU.js?v=1d334a01:2890:11
MotionWrapper@http://localhost:5173/node_modules/.vite/deps/chunk-TFK7O3NU.js?v=1d334a01:5179:7
ProviderChildren@http://localhost:5173/node_modules/.vite/deps/chunk-TFK7O3NU.js?v=1d334a01:5370:11
ConfigProvider@http://localhost:5173/node_modules/.vite/deps/chunk-TFK7O3NU.js?v=1d334a01:5543:31
ProConfigProvider2@http://localhost:5173/node_modules/.vite/deps/@ant-design_pro-components.js?v=45887203:10629:18
MotionWrapper@http://localhost:5173/node_modules/.vite/deps/chunk-TFK7O3NU.js?v=1d334a01:5179:7
ProviderChildren@http://localhost:5173/node_modules/.vite/deps/chunk-TFK7O3NU.js?v=1d334a01:5370:11
ConfigProvider@http://localhost:5173/node_modules/.vite/deps/chunk-TFK7O3NU.js?v=1d334a01:5543:31
ProLayout2@http://localhost:5173/node_modules/.vite/deps/@ant-design_pro-components.js?v=45887203:35320:22
div
AdminLayout@http://localhost:5173/src/layouts/AdminLayout.tsx:28:20
Auth@http://localhost:5173/src/router/auth.tsx:20:14
RenderedRoute@http://localhost:5173/node_modules/.vite/deps/react-router-dom.js?v=9f973f5f:3330:7
RenderErrorBoundary@http://localhost:5173/node_modules/.vite/deps/react-router-dom.js?v=9f973f5f:3287:5
DataRoutes@http://localhost:5173/node_modules/.vite/deps/react-router-dom.js?v=9f973f5f:3650:7
Router@http://localhost:5173/node_modules/.vite/deps/react-router-dom.js?v=9f973f5f:3733:7
RouterProvider@http://localhost:5173/node_modules/.vite/deps/react-router-dom.js?v=9f973f5f:3600:7
RecoilRoot_INTERNAL@http://localhost:5173/node_modules/.vite/deps/recoil.js?v=3c32fb34:2817:29
RecoilRoot@http://localhost:5173/node_modules/.vite/deps/recoil.js?v=3c32fb34:2938:7
QueryClientProvider@http://localhost:5173/node_modules/.vite/deps/@tanstack_react-query.js?v=6f65ce68:2700:27 react-dom.development.js:86:29
    React 4
    findDOMNode findDOMNode.js:17
    getDom2 index.js:31
    SingleObserver index.js:34
    React 12
    workLoop scheduler.development.js:266
    flushWork scheduler.development.js:239
    performWorkUntilDeadline scheduler.development.js:533
    (Async: EventHandlerNonNull)
    js scheduler.development.js:571
    js scheduler.development.js:633
    __require chunk-ROME4SDB.js:11
    js index.js:6
    __require chunk-ROME4SDB.js:11
    React 2
    __require chunk-ROME4SDB.js:11
    js React
    __require chunk-ROME4SDB.js:11
    js React
    __require chunk-ROME4SDB.js:11
    <anonymous> react-dom_client.js:38

```
