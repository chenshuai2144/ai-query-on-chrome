# 🧐[问题]EditableProTable不更新数据

`AI Reply`

### 🧐 问题描述

使用EditableProTable实时保存编辑表格,当前月编辑了数据保存,按照月份切换下个月request返回的list只有两列数据,没有返回的列仍然显示刚编辑过的数据

### 💻 示例代码

这是刚编辑好的2月份的数据
![微信截图_20230210100450](https://user-images.githubusercontent.com/38517426/217981887-a1758b92-c43b-4240-a8a9-98304acb5d38.png)

切换到3月返回的数据
![image](https://user-images.githubusercontent.com/38517426/217982068-4fed88eb-aa60-4e77-b88a-810e4f2b45f0.png)

在表格中3月仍然显示了2月份编辑的内容,数据都是request返回的,并没有更新
![20230210100722](https://user-images.githubusercontent.com/38517426/217982278-a9c3d602-a5d6-4c29-b939-2b1fdf885ac9.png)

### 🚑 其他信息

## EcoIris

切换到3月返回的数据是这样的,图没贴上去
![微信截图_20230210100555](https://user-images.githubusercontent.com/38517426/217982625-d7fb749d-76e8-4eca-8b3e-d66ad2983063.png)

## chenshuai2144

> TAutomatically replying with ChatGPT can be attempted, but it cannot be guaranteed to be completely accurate and may not fully address all issues. Please feel free to reply if you have any further questions or concerns.
> 此回复基于 ChatGPT 自动生成，可以尝试下方案，官方员会在一定时间后继续继续处理。

### 🤔 问题分析

根据您提供的信息，我对您的问题进行分析。根据您的描述，在切换月份后，看起来第三列数据的值没有更新，但是从后端返回的数据中仍然能够看到这个字段被更新了。因此，这个问题可能是由于异步更新组件导致的，例如前一次更新仍然在进行中，导致您看不到数据的更新。

### 🖊️ 解决方案

为了确定这个问题的确切原因，您可以尝试在更新数据时使用 await 语句等待数据返回后再更新组件，以确保组件在更新时没有抵触。同时，建议您检查组件的 ref 是否正确地绑定到 EditableProTable 上，并且在更新 ref 时没有出现错误。

可以参考下面的代码：

```javascript
async handleSave(rows, form) {
  // 等待数据更新后再更新组件
  const newData = await asyncSaveData(rows);
  setDataSource(newData);

  // 手动重置表单
  form.resetFields();
}

<EditableProTable
  rowKey="id"
  onSubmit={this.handleSave}
  columns={this.columns}
  dataSource={dataSource}
  editable={{
    onSave: async (key, row) => {
      await asyncSaveData([row]); // 保存一条数据
    },
    onDelete: async key => {
      await asyncDeleteData(key); // 删除一条数据
    },
  }}
  ...
/>
```

另外，如果您使用了类似翻页等操作，建议您使用 `dataSource` 的方式来更新组件，而不是在状态中保存数据。同时，组件的 `loading` 状态也应该正确地处理，以避免更新组件时的冲突。

希望这些提示对您有所帮助，如有其他问题，请随时联系我。
