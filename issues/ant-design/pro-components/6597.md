# 🐛[BUG]ProFormDateTimeRangePicker中设置format后dateFormatter不起作用

`⭕️   bug`,`form`,`AI Reply`

提问前先看看：

https://github.com/ryanhanwu/How-To-Ask-Questions-The-Smart-Way/blob/main/README-zh_CN.md

### 🐛 bug 描述

ProFormDateTimeRangePicker中设置format后dateFormatter不起作用

<!--
详细地描述 bug，让大家都能理解
-->

### 📷 复现步骤

<!--
清晰描述复现步骤，让别人也能看到问题，如果可能，尽量提供可执行代码，
如：https://codesandbox.io/ 在此处创建一个 codesandbox，方便我们更快的排查和复现问题
-->

[![Edit on CodeSandbox](https://codesandbox.io/static/img/play-codesandbox.svg)](https://codesandbox.io/s/antd-reproduction-template-forked-1o4mkf?file=/index.js)

### 🏞 期望结果

因为需要展示的时候不显示时区，但是提交数据时带时区，所以需要两个设置都生效

<!--
描述你原本期望看到的结果
-->

### © 版本信息

- ProComponents 版本: 2.3.54
- umi 版本
- 浏览器环境 edge 110.0.1587.41
- 开发环境 win0

### 🚑 其他信息

<!--
如截图等其他信息可以贴在这里
-->

## chenshuai2144

> TAutomatically replying with ChatGPT can be attempted, but it cannot be guaranteed to be completely accurate and may not fully address all issues. Please feel free to reply if you have any further questions or concerns.
> 此回复基于 ChatGPT 自动生成，可以尝试下方案，官方员会在一定时间后继续继续处理。

根据复现步骤提供的代码样例，可以看到设置 `format` 后，`dateFormatter` 并没有生效。这可能是 `ProFormDateTimeRangePicker` 组件的一个 BUG。不过，我们可以通过其他的方式来处理日期格式和时区的问题。

一个可行的方案是，在从表单获取数据时，对日期进行格式化和时区转换，然后再提交给后端。可以使用 `luxon` 库来进行日期格式化和时区转换。下面是一个示例：

```typescript
import { DateTime } from "luxon";

// 从表单获取数据，并将日期格式化和时区转换
const formData = form.getFieldsValue();
const start_time = DateTime.fromJSDate(formData.start_time).toUTC();
const end_time = DateTime.fromJSDate(formData.end_time).toUTC();

// 提交给后端的数据
const postData = {
  start_time: start_time.toISO(),
  end_time: end_time.toISO(),
};

// 发送请求，提交数据给后端
// ...
```

这里我们将日期对象使用 `DateTime.fromJSDate()` 方法转换为 `luxon` 的 `DateTime` 对象，然后使用 `toUTC()` 方法将它们转换为 UTC 时区的日期，最后使用 `toISO()` 方法将日期格式化成 ISO 格式的字符串，方便提交给后端。

参考文档：

- `luxon` 官方文档：https://moment.github.io/luxon/
