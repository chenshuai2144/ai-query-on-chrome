# ğŸ›[BUG] ProLayout å¯¼è‡´ antd StyleProvider hashPriority='high' å¤±æ•ˆé—®é¢˜

`AI Reply`

### ğŸ› bug æè¿°

ProLayout å¯¼è‡´ antd StyleProvider hashPriority='high' å¤±æ•ˆï¼Œå¯¼è‡´ä½¿ç”¨tailwindcssååœ¨layouté‡Œé¢çš„buttonå°±æœ‰é—®é¢˜ï¼Œå¤–è¾¹çš„æ­£å¸¸

### ğŸ“· å¤ç°æ­¥éª¤

[codesandbox](https://codesandbox.io/p/github/faner11/react-antd/draft/goofy-solomon)

### ğŸ æœŸæœ›ç»“æœ

åœ¨layout ç»„ä»¶å†…çš„ buttonæ ·å¼ä¹Ÿæ­£å¸¸

### ğŸ’» å¤ç°ä»£ç 

https://codesandbox.io/p/github/faner11/react-antd/draft/goofy-solomon?file=%2Fsrc%2Fmain.tsx

### Â© ç‰ˆæœ¬ä¿¡æ¯

- "@ant-design/pro-components": "^2.3.58"
- "antd": "^5.2.3"
- "@ant-design/cssinjs": "^1.6.0",

### ğŸš‘ å…¶ä»–ä¿¡æ¯

<!--
å¦‚æˆªå›¾ç­‰å…¶ä»–ä¿¡æ¯å¯ä»¥è´´åœ¨è¿™é‡Œ
-->

## chenshuai2144

> TAutomatically replying with ChatGPT can be attempted, but it cannot be guaranteed to be completely accurate and may not fully address all issues. Please feel free to reply if you have any further questions or concerns.
> æ­¤å›å¤åŸºäº ChatGPT è‡ªåŠ¨ç”Ÿæˆï¼Œå¯ä»¥å°è¯•ä¸‹æ–¹æ¡ˆï¼Œå®˜æ–¹å‘˜ä¼šåœ¨ä¸€å®šæ—¶é—´åç»§ç»­ç»§ç»­å¤„ç†ã€‚

ä½ å¥½ï¼Œæ ¹æ®ä½ çš„æè¿°å’Œæä¾›çš„ä»£ç ï¼Œæˆ‘è®¤ä¸ºè¿™ä¸ªé—®é¢˜çš„åŸå› æ˜¯ `ProLayout` ç»„ä»¶çš„æ ·å¼ä¼˜å…ˆçº§é«˜äº `antd` çš„ `StyleProvider`ï¼Œå¯¼è‡´éƒ¨åˆ†æ ·å¼æ— æ³•ç”Ÿæ•ˆã€‚

è§£å†³æ–¹æ¡ˆæ˜¯åœ¨ `ProLayout` ç»„ä»¶ä¸ŠåŠ ä¸Š `style={{ zIndex: 11 }}` æ¥è°ƒæ•´æ ·å¼ä¼˜å…ˆçº§ã€‚å…·ä½“ä»£ç å¦‚ä¸‹ï¼š

```tsx
<ProLayout style={{ zIndex: 11 }}>...</ProLayout>
```

å…³äº `zIndex` å±æ€§å¯ä»¥å‚è€ƒ[å®˜æ–¹æ–‡æ¡£](https://developer.mozilla.org/en-US/docs/Web/CSS/z-index)ã€‚æˆ–è€…ä½ å¯ä»¥å°è¯•å‡çº§ä½ çš„ `antd` ç‰ˆæœ¬ï¼Œæ–°ç‰ˆæœ¬çš„ `antd` å·²ç»å°† `StyleProvider` çš„ä¼˜å…ˆçº§è®¾ç½®ä¸º `important`ï¼Œå¯èƒ½å¯ä»¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚

å¸Œæœ›è¿™ä¸ªè§£å†³æ–¹æ¡ˆå¯¹ä½ æœ‰å¸®åŠ©ï¼Œå¦‚æœè¿˜æœ‰å…¶ä»–é—®é¢˜ï¼Œè¯·éšæ—¶æé—®ã€‚

## faner11

å¯èƒ½ä¸æ˜¯è¿™ä¸ªåŸå› 
æˆ‘å‡çº§åˆ°æœ€æ–°çš„antd ä¹‹åè¿˜æ˜¯é‡åˆ°äº†è¿™ä¸ªé—®é¢˜ï¼Œåœ¨pro-components ä¹‹å¤–å’Œbuttonçš„ç±»åæœ‰æ˜æ˜¾åŒºåˆ«
![image](https://user-images.githubusercontent.com/26560612/223071635-e216dcd3-cbc4-42d0-bc95-a57876c0ea87.png)

## faner11

StyleProvider è®¾ç½®hashPriority=highï¼Œæ˜¯ç”Ÿæ•ˆçš„ï¼Œä½†æ˜¯åœ¨pro-componentsç»„ä»¶é‡Œé‡Œè¿™ä¸ªè®¾ç½®å¥½åƒåˆå¤±æ•ˆäº† @chenshuai2144

## chenshuai2144

> TAutomatically replying with ChatGPT can be attempted, but it cannot be guaranteed to be completely accurate and may not fully address all issues. Please feel free to reply if you have any further questions or concerns.
> æ­¤å›å¤åŸºäº ChatGPT è‡ªåŠ¨ç”Ÿæˆï¼Œå¯ä»¥å°è¯•ä¸‹æ–¹æ¡ˆï¼Œå®˜æ–¹å‘˜ä¼šåœ¨ä¸€å®šæ—¶é—´åç»§ç»­ç»§ç»­å¤„ç†ã€‚

æ ¹æ®æ‚¨çš„æè¿°ï¼Œæˆ‘å»ºè®®æ‚¨å¢åŠ  `ProLayout` å†…éƒ¨çš„æ ·å¼ä¼˜å…ˆçº§æ¥è¦†ç›– `ProLayout` çš„æ ·å¼ï¼Œä»è€Œä¿è¯ `StyleProvider` çš„è®¾ç½®ä¸ä¼šè¢«è¦†ç›–ã€‚å…·ä½“æ¥è¯´ï¼Œæ‚¨å¯ä»¥åœ¨ `ProLayout` å†…éƒ¨å¯¹è¦ä¿®æ”¹çš„ç»„ä»¶æ ·å¼æ·»åŠ ä¸€ä¸ªç±»åï¼Œå¹¶ä½¿ç”¨ç±»åæ¥è¦†ç›–ç»„ä»¶æ ·å¼ã€‚ä»£ç ç¤ºä¾‹å¦‚ä¸‹ï¼š

```jsx
import { ProLayout } from "@ant-design/pro-layout";
import styles from "./index.css";

export default () => (
  <ProLayout>
    <div className={styles.myButton}>
      <Button>æ ·å¼è¦†ç›–æµ‹è¯•</Button>
    </div>
  </ProLayout>
);
```

å…¶ä¸­ `styles.myButton` æ˜¯ä¸€ä¸ª CSS æ¨¡å—åŒ–ç”Ÿæˆçš„ç±»åï¼Œå®ƒä¼šè‡ªåŠ¨æ·»åŠ ä¸€ä¸ªå“ˆå¸Œå€¼ä»¥é¿å…å‘½åå†²çªã€‚æ‚¨éœ€è¦åœ¨ä»£ç ä¸­å¼•å…¥è¯¥ç±»åæ‰€åœ¨çš„æ ·å¼æ–‡ä»¶ï¼Œå¹¶ä½¿ç”¨è¯¥ç±»åæ¥è¦†ç›–ç»„ä»¶æ ·å¼ã€‚æ­¤å¤–ï¼Œæ‚¨éœ€è¦ä¸ºè¯¥ç»„ä»¶è®¾ç½®ä¸€ä¸ªæ›´é«˜çš„æ ·å¼ä¼˜å…ˆçº§ï¼Œä¾‹å¦‚ï¼š

```css
.myButton {
  /* ä¼˜å…ˆçº§æ›´é«˜çš„æ ·å¼è§„åˆ™ */
  /* éœ€è¦ä½¿ç”¨ `!important` æ¥è¦†ç›– ProLayout ä¸­çš„æ ·å¼ */
  background-color: red !important;
}
```

éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œä½¿ç”¨ `!important` æ¥è¦†ç›–æ ·å¼ä¼šå¸¦æ¥ä¸€å®šçš„é£é™©ï¼Œå¯èƒ½å¯¼è‡´å…¶ä»–ç»„ä»¶çš„æ ·å¼å—åˆ°å½±å“ã€‚å› æ­¤ï¼Œè¯·å°½é‡åœ¨ç›®æ ‡ç»„ä»¶çš„èŒƒå›´å†…ä½¿ç”¨ä¸Šè¿°æ–¹æ¡ˆï¼Œå¹¶é¿å…åœ¨å…¨å±€æ ·å¼ä¸­ä½¿ç”¨ `!important`ã€‚

## chenshuai2144

è¯•è¯•antd æˆ–è€… cssinjs æœ‰ä¸¤ä»½å®ä¾‹å¯¼è‡´çš„ï¼Œä½ å¯ä»¥ç”¨alias æ¥è®©å¤§å®¶éƒ½ä½¿ç”¨ä¸€ä¸ªå®ä¾‹

## faner11

> è¯•è¯•antd æˆ–è€… cssinjs æœ‰ä¸¤ä»½å®ä¾‹å¯¼è‡´çš„ï¼Œä½ å¯ä»¥ç”¨alias æ¥è®©å¤§å®¶éƒ½ä½¿ç”¨ä¸€ä¸ªå®ä¾‹

æ²¡ç†è§£ï¼Œå¯ä»¥è¯´çš„å…·ä½“ä¸€äº›å— @chenshuai2144

## chenshuai2144

npm ls antd

çœ‹çœ‹æ˜¯ä¸æ˜¯æœ‰ä¸¤ä¸ªç‰ˆæœ¬ã€‚

å½“æˆ‘ä»¬åœ¨ä¸€ä¸ªé¡¹ç›®ä¸­ä½¿ç”¨äº†å¤šä»½ç›¸åŒçš„ä¾èµ–åº“ï¼ˆæ¯”å¦‚ Reactã€Antdã€CSS-in-JS ç­‰ï¼‰ï¼Œå°±å®¹æ˜“å‡ºç°ä¾èµ–ç‰ˆæœ¬å†²çªçš„é—®é¢˜ã€‚è¿™å¯èƒ½é€ æˆä¸€äº›éš¾ä»¥æ’æŸ¥çš„é—®é¢˜ï¼Œå½±å“é¡¹ç›®æ­£å¸¸è¿è¡Œã€‚

ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ Webpack çš„ alias åŠŸèƒ½ï¼Œå°†è¿™äº›åº“ä»¬éƒ½æŒ‡å‘åŒä¸€ä¸ªå®ä¾‹ã€‚è¿™æ ·æ—¢å¯ä»¥ä¿è¯ç‰ˆæœ¬ä¸€è‡´æ€§ï¼Œä¹Ÿå¯ä»¥å‡å°æ‰“åŒ…ä½“ç§¯ã€‚

```

// webpack.config.js

const path = require('path')

module.exports = {
  // ...å…¶ä»–é…ç½®
  resolve: {
    alias: {
      // å¼•ç”¨æ—¶ä½¿ç”¨çš„è·¯å¾„ï¼šå®é™…çš„æ–‡ä»¶è·¯å¾„
      react: path.resolve(__dirname, 'node_modules/react'),
      antd: path.resolve(__dirname, 'node_modules/antd'),
      'styled-components': path.resolve(__dirname, 'node_modules/styled-components')
    }
  }
}
```

## faner11

æˆ‘ç»™@ant-design/cssinjs è®¾ç½®äº†aliasï¼Œä½†æ˜¯å¹¶æ²¡æœ‰è§£å†³è¿™ä¸ªé—®é¢˜

## faner11

å¯èƒ½ä¸æ˜¯aliasçš„é—®é¢˜ï¼Œ @chenshuai2144

## chenshuai2144

æˆ‘è¯•äº†ä¸€ä¸‹ã€‚æ²¡æœ‰é—®é¢˜ã€‚è¦ä¸ä½ æ‰‹åŠ¨è®¾ç½®ä¸€ä¸‹çš„ hashed=falseã€‚

## faner11

@chenshuai2144 å¤§å“¥ï¼Œä½ çœ‹ä¸€ä¸‹Demoï¼Œæ˜æ˜¾å°±æ˜¯æœ‰é—®é¢˜çš„å‘€ï¼Œhashedæ˜¯é‚£é‡Œçš„é…ç½®
![image](https://github.com/ant-design/pro-components/assets/26560612/222ec45b-41dc-4e92-a484-b81630634b4a)

## chenshuai2144

æŒ‰é’®é—®é¢˜æ˜¯å› ä¸º App é‡Œé¢å¸¦çš„ reset cssï¼Œhashed çœ‹çœ‹ ConfigProvide

## faner11

> æŒ‰é’®é—®é¢˜æ˜¯å› ä¸º App é‡Œé¢å¸¦çš„ reset cssï¼Œhashed çœ‹çœ‹ ConfigProvide

demo æ²¡æœ‰å¼•ç”¨antd Appç»„ä»¶, hashed è®¾äº†ä¹Ÿæ²¡æœ‰ç”¨ï¼Œä½ å¯èƒ½æ˜¯æ˜¯æŠŠtailwind.config.cjsçš„preflightè®¾ä¸ºfalseäº†ï¼Œæ‰€ä»¥çœ‹åˆ°çš„éƒ½æ˜¯æ­£å¸¸çš„
<img width="690" alt="image" src="https://github.com/ant-design/pro-components/assets/26560612/16f6171f-55bf-4174-a22a-2397f787a041">
