# 🧐[问题]请教一下各位同学，将actionRef做为参数传递是否有副作用？

### 🧐 问题描述

在用v1.0的时候，有protable和modalform同时存在的页面时，我会将modalform封装在composes中，并将protable的`actionRef`做为参数传递给modalform，以实现modalform操作成功时进行`actionRef.current.reload()`操作。

在用v2.0就开始思考这种方式有没有副作用。目前来看在用v1.0时并没有任何问题，不知道上面这种方式是否是最佳实践，有没有什么副作用！

### 💻 示例代码

```typescript
// 将actionRef传递给modalform
<UpdateModal open={open} onOpenChange={setOpen} actionRef={actionRef} />

// modalform操作成功后刷新
onFinish={async (values) => {
        try {
          const res = await save(values);
          message.success(`操作成功！`);

          // 从外部传进来的actionRef，并刷新。
          props.actionRef?.current?.reload();
        } catch (error: any) {
          message.error(error.response.data.msg);
        }
}
```

## chenshuai2144

> TAutomatically replying with ChatGPT can be attempted, but it cannot be guaranteed to be completely accurate and may not fully address all issues. Please feel free to reply if you have any further questions or concerns.
> 此回复基于 ChatGPT 自动生成，可以尝试下方案，官方员会在一定时间后继续继续处理。

🌟 解决方案

首先我们需要明确，`actionRef`是`ProTable`组件的一个属性，代表了一个可操作当前表格的引用。如果我们在组件中传递了`actionRef`，那么我们就可以在组件外部使用这个引用进行相关操作（如重新加载数据等）。

而在将`actionRef`做为参数传递给子组件时，如果子组件是需要操作`ProTable`的（例如你这里的`modalform`中需要重新加载数据），那么这样做是没有副作用的。

但是，在实际编码过程中，需要注意以下几点：

1. `actionRef`只能操作传入的`ProTable`，如果你在子组件中使用`actionRef.current.reload()`时，确保你要操作的是正确的`ProTable`。如果在传递`actionRef`时传递错误的引用，那么可能会导致数据加载失败等问题。

2. 在传递`actionRef`时，需要确保子组件的生命周期和`ProTable`的生命周期能对应上。如果传递的子组件比`ProTable`的生命周期更长，那么可能会导致子组件中的操作出现异常。

3. 在实践时，可以通过对页面状态的响应式设计，避免直接依赖`actionRef`。当数据发生变化时，可以通过修改页面状态触发重新加载数据，避免过度依赖`actionRef`。

以上是我个人的理解和建议，仅供参考。更多关于`actionRef`的使用可以参考以下官方文档：

https://procomponents.ant.design/components/table#%E5%B1%9E%E6%80%A7

https://github.com/ant-design/pro-components/blob/master/packages/table/src/interface.d.ts#L144-L152
