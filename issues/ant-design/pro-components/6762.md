# 🧐[问题] editableProtable 编辑时如何监听到当前编辑是那个input框

`AI Reply`

需要是编辑时有两个input编辑框，第一个input框值修改自动计算第二个框，第二个框修改自动计算第一个框，找了一些方法还没有发现这个功能，请教下如何实现

## zozopen

![image](https://user-images.githubusercontent.com/23204297/224474701-56f146f5-5207-48aa-b916-115379dc204c.png)

## chenshuai2144

> TAutomatically replying with ChatGPT can be attempted, but it cannot be guaranteed to be completely accurate and may not fully address all issues. Please feel free to reply if you have any further questions or concerns.
> 此回复基于 ChatGPT 自动生成，可以尝试下方案，官方人员会在一定时间后继续继续处理。

可以使用 `EditableProTable` 提供的 `editable` 属性中的 `onValuesChange` 方法来监听表格数据的变化，利用 `Table.Column` 中的 `render` 方法来实现 input 输入框的计算逻辑。下面是一个简单的示例代码：

```jsx
import React, { useState } from "react";
import { EditableProTable } from "@ant-design/pro-table";

const Demo = () => {
  const [dataSource, setDataSource] = useState([
    {
      id: 1,
      col1: "1",
      col2: "2",
    },
    {
      id: 2,
      col1: "2",
      col2: "3",
    },
  ]);

  const handleValuesChange = (_, values) => {
    // 监听数据变化，更新表格数据
    setDataSource(values);
  };

  return (
    <EditableProTable
      rowKey="id"
      columns={[
        {
          title: "Col1",
          dataIndex: "col1",
          formItemProps: {
            rules: [{ required: true }],
          },
          render: (_, record) => {
            // 利用 render 方法添加 input 输入框，并计算 col2 的值
            return (
              <input
                type="text"
                value={record.col1}
                onChange={(e) => {
                  const newValue = e.target.value;
                  const newRecord = {
                    ...record,
                    col1: newValue,
                    col2: String(Number(newValue) + 1),
                  };
                  handleValuesChange(
                    null,
                    dataSource.map((d) =>
                      d.id === newRecord.id ? newRecord : d,
                    ),
                  );
                }}
              />
            );
          },
        },
        {
          title: "Col2",
          dataIndex: "col2",
          formItemProps: {
            rules: [{ required: true }],
          },
          render: (_, record) => {
            // 利用 render 方法添加 input 输入框，并计算 col1 的值
            return (
              <input
                type="text"
                value={record.col2}
                onChange={(e) => {
                  const newValue = e.target.value;
                  const newRecord = {
                    ...record,
                    col2: newValue,
                    col1: String(Number(newValue) - 1),
                  };
                  handleValuesChange(
                    null,
                    dataSource.map((d) =>
                      d.id === newRecord.id ? newRecord : d,
                    ),
                  );
                }}
              />
            );
          },
        },
      ]}
      request={async () => ({
        data: dataSource,
        success: true,
      })}
      editable={{
        editableKeys: dataSource.map((item) => item.id),
        // 监听数据变化
        onValuesChange: handleValuesChange,
      }}
      onChange={(_, data) => setDataSource(data)}
    />
  );
};

export default Demo;
```

上述代码中，我们利用 `handleValuesChange` 方法监听了数据变化事件，当用户修改 input 输入框的值时，我们通过计算得到另一个 input 输入框的值，并一起更新表格数据。在 `Table.Column` 中的 `render` 方法中，我们添加了一个 input 输入框，并通过 `handleValuesChange` 方法更新表格数据。同时，为了保证数据的正确性，我们需要在 `Table.Column` 中的 `formItemProps` 属性中添加 `rules` 规则来限制输入框的输入。

## chenshuai2144

AI 的办法是最好的解法，或者试试

https://github.com/ant-design/pro-components/blob/d8d1e6efea124241ac46b2381a339d84a6ba68cf/packages/table/src/components/EditableTable/demos/form-linkage.tsx
