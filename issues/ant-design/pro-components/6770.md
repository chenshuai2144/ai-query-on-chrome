# ğŸ›[BUG] Argument appears to not be a ReactComponent. Keys: forceAlign,forcePopupAlign

`ğŸ“¦  Need to reproduce`,`AI Reply`

æé—®å‰å…ˆçœ‹çœ‹ï¼š

https://github.com/ryanhanwu/How-To-Ask-Questions-The-Smart-Way/blob/main/README-zh_CN.md

### ğŸ› bug æè¿°

Argument appears to not be a ReactComponent. Keys: forceAlign,forcePopupAlign

This error happens after updating Ant Design to v5.3.0 and v5.3.1

![image](https://user-images.githubusercontent.com/96863959/224704781-0e280b3f-a40b-422c-82a8-e42b8b282059.png)

<!--
è¯¦ç»†åœ°æè¿° bugï¼Œè®©å¤§å®¶éƒ½èƒ½ç†è§£
-->

### ğŸ“· å¤ç°æ­¥éª¤

<!--
æ¸…æ™°æè¿°å¤ç°æ­¥éª¤ï¼Œè®©åˆ«äººä¹Ÿèƒ½çœ‹åˆ°é—®é¢˜ï¼Œå¦‚æœå¯èƒ½ï¼Œå°½é‡æä¾›å¯æ‰§è¡Œä»£ç ï¼Œ
å¦‚ï¼šhttps://codesandbox.io/ åœ¨æ­¤å¤„åˆ›å»ºä¸€ä¸ª codesandboxï¼Œæ–¹ä¾¿æˆ‘ä»¬æ›´å¿«çš„æ’æŸ¥å’Œå¤ç°é—®é¢˜
-->

### ğŸ æœŸæœ›ç»“æœ

<!--
æè¿°ä½ åŸæœ¬æœŸæœ›çœ‹åˆ°çš„ç»“æœ
-->

### ğŸ’» å¤ç°ä»£ç 

<!--
æä¾›å¯å¤ç°çš„ä»£ç ï¼Œä»“åº“ï¼Œæˆ–çº¿ä¸Šç¤ºä¾‹
-->

### Â© ç‰ˆæœ¬ä¿¡æ¯

- ProComponents ç‰ˆæœ¬: [e.g. 4.0.0]
- umi ç‰ˆæœ¬
- æµè§ˆå™¨ç¯å¢ƒ
- å¼€å‘ç¯å¢ƒ [e.g. mac OS]

### ğŸš‘ å…¶ä»–ä¿¡æ¯

<!--
å¦‚æˆªå›¾ç­‰å…¶ä»–ä¿¡æ¯å¯ä»¥è´´åœ¨è¿™é‡Œ
-->

## fitterfizzle

All the relevant information is here https://github.com/ant-design/ant-design/issues/41206

## deng-yc

åŒæ ·é—®é¢˜

## chenshuai2144

> TAutomatically replying with ChatGPT can be attempted, but it cannot be guaranteed to be completely accurate and may not fully address all issues. Please feel free to reply if you have any further questions or concerns.
> æ­¤å›å¤åŸºäº ChatGPT è‡ªåŠ¨ç”Ÿæˆï¼Œå¯ä»¥å°è¯•ä¸‹æ–¹æ¡ˆï¼Œå®˜æ–¹äººå‘˜ä¼šåœ¨ä¸€å®šæ—¶é—´åç»§ç»­ç»§ç»­å¤„ç†ã€‚

è¯·æä¾›ä½ çš„é—®é¢˜æè¿°å’Œç›¸å…³ä¿¡æ¯ï¼Œæˆ‘å¯ä»¥ä¸ºä½ æä¾›å¸®åŠ©ã€‚

## hooliy

åŒæ ·çš„é—®é¢˜ï¼Œå‡çº§åé¡¹ç›®è·‘ä¸èµ·æ¥äº†

## hooliy

  <img width="601" alt="image" src="https://user-images.githubusercontent.com/3368691/225806161-a753d4a0-f125-4f90-8875-2430183f1e0c.png">

## deng-yc

> åŒæ ·çš„é—®é¢˜ï¼Œå‡çº§åé¡¹ç›®è·‘ä¸èµ·æ¥äº†

https://github.com/ant-design/ant-design/issues/41206#issuecomment-1472752108

æˆ‘å‚è€ƒè¿™ä¸ªï¼ŒæŠŠ `node_modules` åˆ æ‰é‡æ–° `npm install` åèƒ½è·‘èµ·æ¥äº†

## hooliy

> > åŒæ ·çš„é—®é¢˜ï¼Œå‡çº§åé¡¹ç›®è·‘ä¸èµ·æ¥äº†
>
> [ant-design/ant-design#41206 (comment)](https://github.com/ant-design/ant-design/issues/41206#issuecomment-1472752108)
>
> æˆ‘å‚è€ƒè¿™ä¸ªï¼ŒæŠŠ `node_modules` åˆ æ‰é‡æ–° `npm install` åèƒ½è·‘èµ·æ¥äº†

è¿˜æ˜¯ä¸è¡Œï¼Œå¹¶ä¸”é™åˆ°ä¹‹å‰çš„ç‰ˆæœ¬äº†ï¼Œé‡æ–°å† yarn ä¹Ÿè·‘ä¸èµ·æ¥äº†ï¼ ã€‚ã€‚ã€‚

## hooliy

  <img width="187" alt="image" src="https://user-images.githubusercontent.com/3368691/225809283-a353ed1e-cc35-4fff-b5e8-87a50a692845.png">
åªæœ‰æŠŠ setting: false, è®¾ç½®æˆ false æ‰ä¸æŠ¥é”™ï¼Œ
ä½†æ˜¯é¡¹ç›®ä¸­ setting è¿˜æ˜¯æœ‰ç”¨çš„ã€‚ 

## xuqiang1227

@afc163 @zombieJ
æˆ‘è¿™ä¸ªé—®é¢˜æˆ‘å°è¯•åœ¨codesandboxï¼Œéƒ½æ²¡åŠæ³•å¤ç°ï¼Œä½†æ˜¯æœ¬åœ°ä¾ç„¶å­˜åœ¨é—®é¢˜ã€‚
å°è¯•debugäº†ä¸€ä¸‹å‘ç°åœ¨ `resize-observer` å·¥ç¨‹ä¸­çš„ `src\SingleObserver\index.tsx` æ–‡ä»¶é‡Œç¬¬42è¡Œçš„ `getDom`æ–¹æ³•ä¸­ï¼š

```
  const getDom = () =>
    findDOMNode<HTMLElement>(elementRef.current) || findDOMNode<HTMLElement>(wrapperRef.current);
```

å½“è¿™ä¸ªé—®é¢˜å‡ºç°æ—¶ï¼š`elementRef.current` çš„ å€¼ä¸ºï¼š

```
{
   forceAlign: () => {},
   forcePopupAlign: () => {}
}
```

![image](https://user-images.githubusercontent.com/4525647/227862924-ee36f053-f036-48ba-91e4-1cf8aaea05b3.png)

è¯¥å€¼åº”è¯¥ä¸ºantd ä¸­ `ant-design\components\tooltip\index.tsx` ç¬¬221è¡Œå®šä¹‰çš„ refã€‚
æ‰€ä»¥éº»çƒ¦å†reviewä¸€ä¸‹è¿™é‡Œçš„ä»£ç ï¼Œçœ‹çœ‹æ˜¯å¦å­˜åœ¨bugã€‚

## zombieJ

rc-util çš„ `findDOMNode` æ˜¯ä¼šæ£€æµ‹ ref å†…çš„å…ƒç´ æ˜¯å¦æ˜¯ DOM èŠ‚ç‚¹çš„ï¼Œå¦‚æœä¸æ˜¯åˆ™ä½¿ç”¨åŸç”Ÿçš„ `findDOMNode`ã€‚å¦‚æœæ²¡æœ‰åŠæ³•æä¾›å¤ç°çš„è¯ï¼Œå°±æ— æ³•å®šä½é—®é¢˜äº†ã€‚

## xuqiang1227

ç ´æ¡ˆäº†ï¼Œ@rc-component/triggerä¸­çš„rc-utilçš„ `findDomNode` ç‰ˆæœ¬ä¸ä¸€è‡´ï¼š
![ä¼ä¸šå¾®ä¿¡æˆªå›¾_16800805117292](https://user-images.githubusercontent.com/4525647/228698603-a41d407f-2013-4d81-8144-ee177773130f.png)

@zombieJ æ˜¯å¦å¯ä»¥è€ƒè™‘æ›´æ–°ä¸€ä¸‹è¿™ä¸ªè·¯å¾„ä¸Šçš„ç›¸å…³åº“ç‰ˆæœ¬ï¼š
`\node_modules\@rc-component\trigger\node_modules\rc-resize-observer\node_modules\rc-util`

ä»¥ä¸‹æ˜¯æœ€æ–°ç‰ˆæœ¬çš„rc-util ä¸­çš„ `findDomNode` ä»£ç 

```
export function isDOM(node: any): node is HTMLElement | SVGElement {
  // https://developer.mozilla.org/en-US/docs/Web/API/Element
  // Since XULElement is also subclass of Element, we only need HTMLElement and SVGElement
  return node instanceof HTMLElement || node instanceof SVGElement;
}

/**
 * Return if a node is a DOM node. Else will return by `findDOMNode`
 */
export default function findDOMNode<T = Element | Text>(
  node: React.ReactInstance | HTMLElement | SVGElement,
): T {
  if (isDOM(node)) {
    return (node as unknown) as T;
  }

  if (node instanceof React.Component) {
    return (ReactDOM.findDOMNode(node) as unknown) as T;
  }

  return null;
}
```

`yarn list rc-uitl`åï¼Œè¿™æ˜¯ä¸€ä¸ª@umijs/maxé¡¹ç›®ï¼š
![ä¼ä¸šå¾®ä¿¡æˆªå›¾_16801377743081](https://user-images.githubusercontent.com/4525647/228700561-aa8584df-d8b4-4892-98b7-56187c08ad09.png)

## zombieJ

`rc-util` ç‰ˆæœ¬æ˜¯ä¸é”çš„ï¼Œåˆ é™¤ä¸€ä¸‹ lock æ–‡ä»¶é‡æ–°å®‰è£…å°±ä¼šæ˜¯æœ€æ–°çš„å“ˆ

## Asanio06

Thanks, delete yarn.lock and install again work for me
