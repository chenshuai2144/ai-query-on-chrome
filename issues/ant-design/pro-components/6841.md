# ğŸ§[é—®é¢˜]è¡¨å•é‡å¤æäº¤é—®é¢˜

`AI Reply`

æé—®å‰å…ˆçœ‹çœ‹ï¼š

https://github.com/ryanhanwu/How-To-Ask-Questions-The-Smart-Way/blob/main/README-zh_CN.md

### ğŸ§ é—®é¢˜æè¿°

è¡¨å•é‡å¤æäº¤

ahooks useRequestè¿›è¡Œæäº¤é˜²æŠ–
ç»“åˆModalFormè¿›è¡Œæäº¤

### ğŸ’» ç¤ºä¾‹ä»£ç 

https://codesandbox.io/s/repeat-phdsc0?file=/submit.tsx

### ğŸš‘ å…¶ä»–ä¿¡æ¯

## chenshuai2144

> TAutomatically replying with ChatGPT can be attempted, but it cannot be guaranteed to be completely accurate and may not fully address all issues. Please feel free to reply if you have any further questions or concerns.
> æ­¤å›å¤åŸºäº ChatGPT è‡ªåŠ¨ç”Ÿæˆï¼Œå¯ä»¥å°è¯•ä¸‹æ–¹æ¡ˆï¼Œå®˜æ–¹äººå‘˜ä¼šåœ¨ä¸€å®šæ—¶é—´åç»§ç»­ç»§ç»­å¤„ç†ã€‚

### è§£å†³æ–¹æ¡ˆ

è¡¨å•é‡å¤æäº¤é—®é¢˜å¯ä»¥é€šè¿‡ä»¥ä¸‹å‡ ç§æ–¹å¼è§£å†³ï¼š

#### 1. å‰ç«¯å¤„ç†

å‰ç«¯å¯ä»¥é€šè¿‡å°†æäº¤æŒ‰é’®è®¾ç½®ä¸º disabledï¼Œåœ¨æäº¤è¯·æ±‚å‘é€ä¹‹å‰æ·»åŠ ä¸€ä¸ªé”æ¥é˜²æ­¢é‡å¤æäº¤ã€‚ä¹Ÿå¯ä»¥åœ¨å‘é€è¯·æ±‚åï¼Œåˆ¤æ–­æœåŠ¡å™¨ç«¯å“åº”çš„çŠ¶æ€ç ï¼Œå¦‚æœä¸ºæˆåŠŸçŠ¶æ€ç å†è¿›è¡Œä¸‹ä¸€æ­¥æ“ä½œã€‚

```jsx
import { useState } from "react";
import { useRequest } from "ahooks";
import { Modal, Button } from "antd";

export default function ModalForm() {
  const [isModalVisible, setIsModalVisible] = useState(false);
  const [submitting, setSubmitting] = useState(false);
  const [form] = Form.useForm();

  const { run } = useRequest(
    (values) =>
      new Promise((resolve) => {
        setTimeout(() => {
          resolve(values);
        }, 2000);
      }),
    {
      manual: true,
      onSuccess: () => {
        setIsModalVisible(false);
        setSubmitting(false);
        form.resetFields();
      },
    },
  );

  const handleSubmit = (values) => {
    setSubmitting(true);
    run(values);
  };

  return (
    <>
      <Button onClick={() => setIsModalVisible(true)}>æ‰“å¼€ Modal</Button>
      <Modal
        title="è¡¨å•"
        visible={isModalVisible}
        onCancel={() => setIsModalVisible(false)}
        footer={[
          <Button key="back" onClick={() => setIsModalVisible(false)}>
            å–æ¶ˆ
          </Button>,
          <Button
            key="submit"
            type="primary"
            onClick={() => form.submit()}
            disabled={submitting} // æ·»åŠ æäº¤æŒ‰é’®çš„ disabled å±æ€§
          >
            æäº¤
          </Button>,
        ]}
      >
        <Form
          form={form}
          onFinish={handleSubmit}
          // åœ¨æäº¤å‡½æ•°ä¸­æ·»åŠ é”ï¼Œç¦æ­¢é‡å¤æäº¤
          onFinishFailed={() => {
            setSubmitting(false);
          }}
        >
          <Form.Item
            label="ç”¨æˆ·å"
            name="username"
            rules={[{ required: true, message: "è¯·è¾“å…¥ç”¨æˆ·å" }]}
          >
            <Input />
          </Form.Item>
          <Form.Item
            label="å¯†ç "
            name="password"
            rules={[{ required: true, message: "è¯·è¾“å…¥å¯†ç " }]}
          >
            <Input.Password />
          </Form.Item>
        </Form>
      </Modal>
    </>
  );
}
```

#### 2. åç«¯å¤„ç†

åç«¯å¯ä»¥åœ¨æ¥æ”¶åˆ°æäº¤è¯·æ±‚æ—¶ï¼Œç”Ÿæˆä¸€ä¸ªå”¯ä¸€æ ‡è¯†ç¬¦ï¼Œå°†è¯¥æ ‡è¯†ç¬¦å­˜å‚¨åœ¨æœåŠ¡å™¨ç«¯ï¼ŒåŒæ—¶å°†å…¶ä½œä¸ºå“åº”çš„ä¸€éƒ¨åˆ†è¿”å›ç»™å‰ç«¯ã€‚

å‰ç«¯åœ¨æ¥æ”¶åˆ°å“åº”åï¼Œåœ¨ä¸‹ä¸€æ¬¡å‘é€è¯·æ±‚æ—¶ï¼Œå°†è¯¥æ ‡è¯†ç¬¦ä½œä¸ºå‚æ•°æ·»åŠ åˆ°è¯·æ±‚ä¸­ï¼Œåç«¯æ”¶åˆ°è¯·æ±‚åï¼Œåˆ¤æ–­è¯¥æ ‡è¯†ç¬¦æ˜¯å¦å·²ç»å­˜åœ¨ï¼Œä»¥æ­¤åˆ¤æ–­æ˜¯å¦ä¸ºé‡å¤æäº¤ã€‚

```jsx
import { useState } from "react";
import { useRequest } from "ahooks";
import { Modal, Button } from "antd";

export default function ModalForm() {
  const [isModalVisible, setIsModalVisible] = useState(false);
  const [submitting, setSubmitting] = useState(false);
  const [form] = Form.useForm();
  const [submitId, setSubmitId] = useState(null); // æ·»åŠ æ ‡è¯†ç¬¦çš„çŠ¶æ€

  const { run } = useRequest(
    (values, submitId) =>
      new Promise((resolve) => {
        setTimeout(() => {
          resolve(values);
        }, 2000);
      }).then((res) => {
        setSubmitId(null);
        return res;
      }),
    {
      manual: true,
      onSuccess: () => {
        setIsModalVisible(false);
        setSubmitting(false);
        form.resetFields();
      },
    },
  );

  const handleSubmit = (values) => {
    if (!submitId) {
      // æ ‡è¯†ç¬¦ä¸å­˜åœ¨æ‰è¿›è¡Œæäº¤
      setSubmitting(true);
      setSubmitId(Date.now()); // è®¾ç½®æ ‡è¯†ç¬¦ä¸ºå½“å‰æ—¶é—´æˆ³
      run(values, submitId);
    }
  };

  return (
    <>
      <Button onClick={() => setIsModalVisible(true)}>æ‰“å¼€ Modal</Button>
      <Modal
        title="è¡¨å•"
        visible={isModalVisible}
        onCancel={() => setIsModalVisible(false)}
        footer={[
          <Button key="back" onClick={() => setIsModalVisible(false)}>
            å–æ¶ˆ
          </Button>,
          <Button
            key="submit"
            type="primary"
            onClick={() => form.submit()}
            disabled={submitting} // æ·»åŠ æäº¤æŒ‰é’®çš„ disabled å±æ€§
          >
            æäº¤
          </Button>,
        ]}
      >
        <Form
          form={form}
          onFinish={handleSubmit}
          // åœ¨æäº¤å‡½æ•°ä¸­æ·»åŠ é”ï¼Œç¦æ­¢é‡å¤æäº¤
          onFinishFailed={() => {
            setSubmitting(false);
            setSubmitId(null);
          }}
        >
          <Form.Item
            label="ç”¨æˆ·å"
            name="username"
            rules={[{ required: true, message: "è¯·è¾“å…¥ç”¨æˆ·å" }]}
          >
            <Input />
          </Form.Item>
          <Form.Item
            label="å¯†ç "
            name="password"
            rules={[{ required: true, message: "è¯·è¾“å…¥å¯†ç " }]}
          >
            <Input.Password />
          </Form.Item>
          <input type="hidden" name="submitId" value={submitId} /> //
          å°†æ ‡è¯†ç¬¦ä½œä¸ºå‚æ•°æ·»åŠ åˆ°è¯·æ±‚ä¸­
        </Form>
      </Modal>
    </>
  );
}
```

#### å‚è€ƒæ–‡æ¡£

- [é˜²æ­¢é‡å¤æäº¤çš„æ–¹æ³•](https://cn.bing.com/search?q=%E9%98%B2%E6%AD%A2%E9%87%8D%E5%A4%8D%E6%8F%90%E4%BA%A4%E7%9A%84%E6%96%B9%E6%B3%95&cvid=ac5e191bfdd14a43b2a99622555df1a3&aqs=edge..69i57.299j0j1&FORM=ANAB01&PC=EDGEDBB)
