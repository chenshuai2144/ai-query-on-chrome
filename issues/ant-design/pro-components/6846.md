# 👑 [需求]希望在右上角头像位置放置切换主题按钮 而不是在SettingDrawer

`AI Reply`

提问前先看看：

https://github.com/ryanhanwu/How-To-Ask-Questions-The-Smart-Way/blob/main/README-zh_CN.md

### 🔩 所属模块或组件

<!--
如果你的功能需求率属于某个功能模块或者是组件的，请在此处标明，如对`table`组件有功能需求，则注明：率属组件：ProTable
 -->

### 🥰 需求描述

<!--
详细地描述需求，让大家都能理解
-->

### ⛰ 功能需求适用场景

<!--
请简单描述一下这个新功能通常或可以应用在哪些场景下
-->

### 🧐 解决方案

<!--
如果你有解决方案，在这里清晰地阐述
-->

### 🚑 其他信息

<!--
如截图等其他信息可以贴在这里
-->

## chenshuai2144

> TAutomatically replying with ChatGPT can be attempted, but it cannot be guaranteed to be completely accurate and may not fully address all issues. Please feel free to reply if you have any further questions or concerns.
> 此回复基于 ChatGPT 自动生成，可以尝试下方案，官方人员会在一定时间后继续继续处理。

### 🔩 所属模块或组件

此需求涉及到界面布局以及主题切换功能，可归属于整个前端项目。

### 🥰 需求描述

希望在当前页面的右上角头像位置增加切换主题的按钮，方便用户快速切换主题，而不必打开SettingDrawer。

### ⛰ 功能需求适用场景

主题切换功能通常应用于需要切换主题的应用场景，比如需要在不同的主题下进行设计稿的预览和对比。

### 🧐 解决方案

实现该需求可以按照以下步骤：

#### 1. 在头像位置添加按钮元素

在头像位置添加一个按钮，用于切换主题。可以使用 Ant Design 的 `Button` 组件，将其放置在当前页面的头像位置。

```jsx
import { Button } from "antd";
import { ChangeThemeOutlined } from "@ant-design/icons";

function Header() {
  return (
    <div>
      <Avatar />
      <Button
        type="link"
        shape="circle"
        icon={<ChangeThemeOutlined />}
        onClick={() => {
          // 未实现
        }}
      />
    </div>
  );
}
```

#### 2. 实现主题切换逻辑

当用户点击主题切换按钮时，应该修改当前页面的主题。这里我们可以使用 Ant Design 提供的主题切换工具 `less.modifyVars`，它可以在运行时通过修改 less 变量来动态切换主题。

```jsx
import { Button } from "antd";
import { ChangeThemeOutlined } from "@ant-design/icons";

function Header() {
  const handleThemeChange = () => {
    const theme = "dark"; // 假设要切换成的主题
    less
      .modifyVars({
        "@primary-color": "#1890ff", // 修改 primary 颜色
        "@layout-header-background": "#001529", // 修改 header 背景色
        "@layout-footer-background": "#001529", // 修改 footer 背景色
        "@menu-dark-bg": "#001529", // 修改侧边栏背景颜色
        "@menu-dark-submenu-bg": "#000c17", // 修改侧边栏子菜单背景颜色
      })
      .then(() => {
        console.log("theme changed successfully");
      })
      .catch(() => {
        console.log("theme changed failed");
      });
  };

  return (
    <div>
      <Avatar />
      <Button
        type="link"
        shape="circle"
        icon={<ChangeThemeOutlined />}
        onClick={handleThemeChange}
      />
    </div>
  );
}
```

#### 3. 处理主题切换的持久化

当用户切换主题时，该主题应该被持久化保存下来，以方便下次打开应用时使用。这里可以使用 localStorage 来保存主题类型。

在主题切换逻辑中添加保存当前主题的代码，如下所示：

```jsx
const handleThemeChange = () => {
  const theme = 'dark';
  less.modifyVars({
    ...
  }).then(() => {
    console.log('theme changed successfully');
    localStorage.setItem('theme', theme); // 保存当前主题
  }).catch(() => {
    console.log('theme changed failed');
  });
};
```

在应用初始化时，应该从 localStorage 中读取已保存的主题，并恢复应用的主题。

```jsx
function App() {
  const [theme, setTheme] = useState("light");

  useEffect(() => {
    const savedTheme = localStorage.getItem("theme");
    if (savedTheme) {
      setTheme(savedTheme);
      less.modifyVars({
        "@primary-color": "#1890ff",
        "@layout-header-background": "#fff",
        "@layout-footer-background": "#f0f2f5",
        "@menu-dark-bg": "#001529",
        "@menu-dark-submenu-bg": "#000c17",
        ...(savedTheme === "dark"
          ? {
              "@primary-color": "#1890ff",
              "@layout-header-background": "#001529",
              "@layout-footer-background": "#001529",
              "@menu-dark-bg": "#001529",
              "@menu-dark-submenu-bg": "#000c17",
            }
          : {}),
      });
    }
  }, []);

  // 省略其它代码
}
```

当从 localStorage 中读取到保存的主题时，应该使用 `less.modifyVars` 来动态切换主题。

### 🚑 其他信息

无。

## chenshuai2144

根据 AI 的提示来自己实现把，我们暂时不会改
