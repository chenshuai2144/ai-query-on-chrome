# ğŸ›[BUG]protable å½“æ¥å£è¯·æ±‚httpçŠ¶æ€ç é200æ—¶ï¼Œrequestè¢«ä¸€ç›´è°ƒç”¨

`AI Reply`

æé—®å‰å…ˆçœ‹çœ‹ï¼š

https://github.com/ryanhanwu/How-To-Ask-Questions-The-Smart-Way/blob/main/README-zh_CN.md

### protable å½“æ¥å£è¯·æ±‚httpçŠ¶æ€ç é200æ—¶ï¼Œrequestè¢«ä¸€ç›´è°ƒç”¨

### ğŸ“· å¤ç°æ­¥éª¤

request={async (params: ParamsType = {}, sort: any, filter: any) => {
const res: any = await é”™è¯¯è¯·æ±‚;
return {
data: res?.list || [],
// success è¯·è¿”å› trueï¼Œ
// ä¸ç„¶ table ä¼šåœæ­¢è§£ææ•°æ®ï¼Œå³ä½¿æœ‰æ•°æ®
success: true,
// ä¸ä¼ ä¼šä½¿ç”¨ data çš„é•¿åº¦ï¼Œå¦‚æœæ˜¯åˆ†é¡µä¸€å®šè¦ä¼ 
total: res?.total || 0,
};
}}
é”™è¯¯è¯·æ±‚http 400

requestä¸€ç›´æ‰§è¡Œ

### ğŸ æœŸæœ›ç»“æœ

requestè¯·æ±‚ä¸€æ¬¡

### ğŸ’» å¤ç°ä»£ç 

### Â© ç‰ˆæœ¬ä¿¡æ¯

- ProComponents ç‰ˆæœ¬: [e.g. 4.0.0]
- umi ç‰ˆæœ¬
- æµè§ˆå™¨ç¯å¢ƒ
- å¼€å‘ç¯å¢ƒ [e.g. mac OS]

### ğŸš‘ å…¶ä»–ä¿¡æ¯

<!--
å¦‚æˆªå›¾ç­‰å…¶ä»–ä¿¡æ¯å¯ä»¥è´´åœ¨è¿™é‡Œ
-->

## chenshuai2144

> TAutomatically replying with ChatGPT can be attempted, but it cannot be guaranteed to be completely accurate and may not fully address all issues. Please feel free to reply if you have any further questions or concerns.
> æ­¤å›å¤åŸºäº ChatGPT è‡ªåŠ¨ç”Ÿæˆï¼Œå¯ä»¥å°è¯•ä¸‹æ–¹æ¡ˆï¼Œå®˜æ–¹äººå‘˜ä¼šåœ¨ä¸€å®šæ—¶é—´åç»§ç»­ç»§ç»­å¤„ç†ã€‚

é’ˆå¯¹ä½ çš„é—®é¢˜ï¼Œå»ºè®®ä½ å¯ä»¥å‚è€ƒä»¥ä¸‹æ­¥éª¤æ¥è§£å†³ï¼š

1. åœ¨ ProTable çš„ params é…ç½®é¡¹ä¸­ï¼Œä½¿ç”¨ fetch æ–¹æ³•è¿›è¡Œè¯·æ±‚ã€‚fetch å‡½æ•°æ˜¯åŸºäº Promise è®¾è®¡ï¼Œå¯ä»¥è‡ªåŠ¨ç»ˆæ­¢è¯·æ±‚ã€‚

```typescript
import { request } from 'umi';

const fetchData = async (params: ParamsType = {}, sort: any, filter: any) => {
  const res:any = await request('/api/demo', {
    method: 'GET',
    params,
  });
  return {
    data: res?.data || [],
    success: true,
    total: res?.total || 0,
  };
};

<ProTable
  onRequestError={() => message.error('è¯·æ±‚æ•°æ®å¤±è´¥')}
  params={{
    // é€šè¿‡fetchæ–¹æ³•è¿›è¡Œè¯·æ±‚
    fetch: fetchData,
  }}
  columns={columns}
/>
```

2. åœ¨ request ä¸­å¤„ç†é”™è¯¯çš„è¯·æ±‚ã€‚

```typescript
import { message } from 'antd';
import { request } from 'umi';

const fetchData = async (params: ParamsType = {}, sort: any, filter: any) => {
  try {
    const res:any = await request('/api/demo', {
      method: 'GET',
      params,
    });
    return {
      data: res?.data || [],
      success: true,
      total: res?.total || 0,
    };
  } catch(e) {
    message.error('è¯·æ±‚æ•°æ®å¤±è´¥');
    // æŠ›å‡ºé”™è¯¯ç»ˆæ­¢è¯·æ±‚
    throw new Error('è¯·æ±‚æ•°æ®å¤±è´¥');
  }
};

<ProTable
  onRequestError={() => message.error('è¯·æ±‚æ•°æ®å¤±è´¥')}
  params={{
    // é€šè¿‡fetchæ–¹æ³•è¿›è¡Œè¯·æ±‚
    async request() {
      try {
        const res = await fetchData();
        return res;
      } catch(e) {
        // æŠ›å‡ºé”™è¯¯ï¼Œç»ˆæ­¢è¯·æ±‚
        return {
          data: [],
          success: false,
          total: 0,
        };
      }
    }
  }}
  columns={columns}
/>
```

å¸Œæœ›ä»¥ä¸Šä¸¤ä¸ªæ–¹æ¡ˆå¯ä»¥å¸®åŠ©åˆ°ä½ ã€‚æ­¤å¤–ï¼Œè¿˜å¯ä»¥å‚è€ƒ ProTable çš„å®˜æ–¹æ–‡æ¡£ï¼Œäº†è§£æ›´å¤šç›¸å…³é…ç½®çš„ä½¿ç”¨æ–¹æ³•ã€‚
[ProTable å®˜æ–¹æ–‡æ¡£](https://procomponents.ant.design/components/table)
