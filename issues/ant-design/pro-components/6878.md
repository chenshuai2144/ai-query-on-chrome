# ğŸ›[BUG] NextJs Prolayout Error ã€Unhandled Runtime Error Error: Hydration failed because the initial UI does not match what was rendered on the serverã€‘

`AI Reply`

æé—®å‰å…ˆçœ‹çœ‹ï¼š

https://github.com/ryanhanwu/How-To-Ask-Questions-The-Smart-Way/blob/main/README-zh_CN.md

### ğŸ› bug æè¿°

Unhandled Runtime Error
Error: Hydration failed because the initial UI does not match what was rendered on the server.

See more info here: https://nextjs.org/docs/messages/react-hydration-error

### ğŸ“· å¤ç°æ­¥éª¤

```

import React, {useState} from "react";
import {ProConfigProvider} from "@ant-design/pro-provider";
import {ProLayout} from "@ant-design/pro-layout";

export default function Home() {
  const [pathname, setPathname] = useState('/list/sub-page/sub-sub-page1');

  return (
      <ProLayout />
  );
}

```

### ğŸ æœŸæœ›ç»“æœ

æ— æŠ¥é”™

### ğŸ’» å¤ç°ä»£ç 

```

import React, {useState} from "react";
import {ProConfigProvider} from "@ant-design/pro-provider";
import {ProLayout} from "@ant-design/pro-layout";

export default function Home() {
  const [pathname, setPathname] = useState('/list/sub-page/sub-sub-page1');

  return (
      <ProLayout />
  );
}

```

### Â© ç‰ˆæœ¬ä¿¡æ¯

- ProComponents ç‰ˆæœ¬: [e.g. 4.0.0] 4.2
- umi ç‰ˆæœ¬ nan
- æµè§ˆå™¨ç¯å¢ƒ chrome
- å¼€å‘ç¯å¢ƒ [e.g. mac OS] windows

```
    "@ant-design/pro-components": "^2.4.4",
    "@types/node": "18.15.11",
    "@types/react": "18.0.31",
    "@types/react-dom": "18.0.11",
    "eslint": "8.37.0",
    "eslint-config-next": "13.2.4",
    "next": "13.2.4",
    "react": "18.2.0",
    "react-dom": "18.2.0",
    "typescript": "5.0.3"
```

### ğŸš‘ å…¶ä»–ä¿¡æ¯

```
Unhandled Runtime Error
Error: Hydration failed because the initial UI does not match what was rendered on the server.

See more info here: https://nextjs.org/docs/messages/react-hydration-error

Call Stack
throwOnHydrationMismatch
node_modules\react-dom\cjs\react-dom.development.js (12507:0)
tryToClaimNextHydratableInstance
node_modules\react-dom\cjs\react-dom.development.js (12520:0)
updateHostComponent
node_modules\react-dom\cjs\react-dom.development.js (19902:0)
beginWork
node_modules\react-dom\cjs\react-dom.development.js (21618:0)
HTMLUnknownElement.callCallback
node_modules\react-dom\cjs\react-dom.development.js (4164:0)
Object.invokeGuardedCallbackDev
node_modules\react-dom\cjs\react-dom.development.js (4213:0)
invokeGuardedCallback
node_modules\react-dom\cjs\react-dom.development.js (4277:0)
beginWork$1
node_modules\react-dom\cjs\react-dom.development.js (27451:0)
performUnitOfWork
node_modules\react-dom\cjs\react-dom.development.js (26557:0)
workLoopSync
node_modules\react-dom\cjs\react-dom.development.js (26466:0)
renderRootSync
node_modules\react-dom\cjs\react-dom.development.js (26434:0)
performConcurrentWorkOnRoot
node_modules\react-dom\cjs\react-dom.development.js (25738:0)
workLoop
node_modules\scheduler\cjs\scheduler.development.js (266:0)
flushWork
node_modules\scheduler\cjs\scheduler.development.js (239:0)
performWorkUntilDeadline
node_modules\scheduler\cjs\scheduler.development.js (533:0)
<unknown>
chrome-extension://ibnejdfjmmkpcnlpebklmnkoeoihofec/dist/pageHook.js (22:13552)
h
chrome-extension://ibnejdfjmmkpcnlpebklmnkoeoihofec/dist/pageHook.js (22:13667)
s
chrome-extension://ibnejdfjmmkpcnlpebklmnkoeoihofec/dist/pageHook.js (22:13025)
```

## chenshuai2144

> TAutomatically replying with ChatGPT can be attempted, but it cannot be guaranteed to be completely accurate and may not fully address all issues. Please feel free to reply if you have any further questions or concerns.
> æ­¤å›å¤åŸºäº ChatGPT è‡ªåŠ¨ç”Ÿæˆï¼Œå¯ä»¥å°è¯•ä¸‹æ–¹æ¡ˆï¼Œå®˜æ–¹äººå‘˜ä¼šåœ¨ä¸€å®šæ—¶é—´åç»§ç»­ç»§ç»­å¤„ç†ã€‚

è¿™ä¸ªé”™è¯¯æ˜¯ React çš„æœåŠ¡ç«¯æ¸²æŸ“å’Œå®¢æˆ·ç«¯æ¸²æŸ“å¯¼è‡´çš„ UI ä¸ä¸€è‡´ï¼Œéœ€è¦å¯¹æ¸²æŸ“è¿‡ç¨‹æœ‰ä¸€å®šçš„è®¤è¯†æ‰èƒ½å¤Ÿæ·±åˆ»ç†è§£ã€‚åœ¨ Next.js ä¸­ï¼Œæœ‰æ—¶å€™ç»„ä»¶çš„æ¸²æŸ“æ˜¯åœ¨å®¢æˆ·ç«¯å®Œæˆçš„ï¼Œæœ‰æ—¶å€™åˆ™æ˜¯åœ¨æœåŠ¡å™¨è¿›è¡Œã€‚è¿™ç§æƒ…å†µç§°ä¸ºæœåŠ¡ç«¯æ¸²æŸ“å’Œå®¢æˆ·ç«¯æ¸²æŸ“ã€‚

é€šå¸¸æ¥è¯´ï¼Œä½¿ç”¨æœåŠ¡ç«¯æ¸²æŸ“çš„æƒ…å†µå¤šæ˜¯ç”¨äºæ›´å¥½çš„ SEOã€‚è€Œå®¢æˆ·ç«¯æ¸²æŸ“åˆ™å¯ä»¥å¸¦æ¥è‰¯å¥½çš„ç”¨æˆ·ä½“éªŒå’Œé™ä½æœåŠ¡å™¨è´Ÿè½½ã€‚

å›åˆ°é”™è¯¯æœ¬èº«ï¼Œè¿™ç§é”™è¯¯é€šå¸¸æ˜¯ç”±å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯æ¸²æŸ“å‡ºç°äº†å·®å¼‚è€Œå¯¼è‡´çš„ï¼Œå®¢æˆ·ç«¯è¡¥å……äº†æ¸²æŸ“è¿‡ç¨‹ä¸­ç¼ºå¤±çš„éƒ¨åˆ†ã€‚é€šå¸¸æ˜¯å› ä¸ºå®¢æˆ·ç«¯æ¸²æŸ“çš„ç»„ä»¶éƒ¨åˆ†ä¸æœåŠ¡ç«¯æ¸²æŸ“çš„ç»„ä»¶ä¸åŒï¼Œå¯¼è‡´å®¢æˆ·ç«¯çš„æ¸²æŸ“ç»“æœå’ŒæœåŠ¡ç«¯ä¸åŒï¼Œä»è€Œå¼•èµ·äº†è¿™ä¸ªé”™è¯¯ã€‚

è§£å†³æ–¹æ³•ï¼š

1. å°è¯•å°è¯•å‡å°‘å®¢æˆ·ç«¯æ¸²æŸ“ç»„ä»¶çš„å·®å¼‚ï¼Œå»ºè®®ä½¿ç”¨ç›¸åŒçš„ä¾èµ–ç¯å¢ƒï¼Œä»¥åŠåœ¨æ¸²æŸ“æ—¶ä¼ å…¥å®Œå…¨ç›¸åŒçš„ propsã€‚

2. å°è¯•ä½¿ç”¨ noSsr ç»„ä»¶æˆ–è€… disableHydrationï¼Œè¿™ä¸¤ç§æ–¹å¼å¯ä»¥æ§åˆ¶åœ¨å®¢æˆ·ç«¯æ¸²æŸ“çš„æ—¶å€™ï¼Œæ˜¯å¦å¿½ç•¥æŸäº›ç»†èŠ‚ï¼Œç›´æ¥æ¸²æŸ“å‡ºæ­£ç¡®çš„ç»“æœã€‚å…·ä½“ä½¿ç”¨æ–¹æ³•åŠç¤ºä¾‹å¯ä»¥å‚è€ƒå®˜æ–¹æ–‡æ¡£ï¼šhttps://nextjs.org/docs/api-reference/next/head

3. å¦‚æœä»¥ä¸Šæ–¹å¼å‡æœªèƒ½è§£å†³é—®é¢˜ï¼Œå¯ä»¥è€ƒè™‘å¯¹ä»£ç åšå‡ºé‡æ„ï¼Œè°ƒæ•´æœåŠ¡ç«¯æ¸²æŸ“å’Œå®¢æˆ·ç«¯æ¸²æŸ“çš„æ–¹å¼ã€‚

ä»¥ä¸‹æ˜¯ç¤ºä¾‹ä»£ç ï¼š

```jsx
import React, { useState } from "react";
import dynamic from "next/dynamic";
// ä½¿ç”¨åŠ¨æ€åŠ è½½çš„æ–¹å¼ï¼Œå¯ä»¥ä½¿éƒ¨åˆ†ç»„ä»¶åœ¨å®¢æˆ·ç«¯æ¸²æŸ“å®Œæˆåå†æ‰§è¡Œ
const ProLayout = dynamic(() => import("@ant-design/pro-layout"), {
  ssr: false,
});

export default function Home() {
  const [pathname, setPathname] = useState("/list/sub-page/sub-sub-page1");

  return <ProLayout />;
}
```

æ³¨æ„ï¼šä»¥ä¸Šä»£ç æ— æ³•ç›´æ¥åœ¨æµè§ˆå™¨ç«¯æ‰§è¡Œï¼Œéœ€è¦ä½¿ç”¨ Next.js è¿›è¡ŒæœåŠ¡ç«¯æ¸²æŸ“ã€‚

å‚è€ƒæ–‡æ¡£ï¼š

1. Next.js å®˜æ–¹æ–‡æ¡£ https://nextjs.org/docs/messages/react-hydration-error
2. React çš„åŒæ„æ¸²æŸ“ç­–ç•¥ https://www.javascriptcn.com/read-14190.html
3. Using Dynamic imports with next/dynamic https://nextjs.org/docs/advanced-features/dynamic-import

## DirectStack

è¿™ä¸ªæ–¹æ³•è§£å†³äº†æˆ‘çš„é—®é¢˜ï¼Œä½¿ç”¨nextjså¼€å‘spaåº”ç”¨ï¼Œæ„Ÿè°¢ï¼
