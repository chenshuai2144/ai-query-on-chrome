# ğŸ§[é—®é¢˜] proTable: toolbar setting æ”¯æŒè‡ªå®šä¹‰columnså—?

`AI Reply`

æ¯”å¦‚æˆ‘æä¾›ä¸€ä¸ªå…¨é‡çš„columnsç»™toobar,ä½†æ˜¯ tableä½¿ç”¨çš„columnsåªå‰è€…çš„ä¸€ä¸ªå­é›†

## chenshuai2144

> TAutomatically replying with ChatGPT can be attempted, but it cannot be guaranteed to be completely accurate and may not fully address all issues. Please feel free to reply if you have any further questions or concerns.
> æ­¤å›å¤åŸºäº ChatGPT è‡ªåŠ¨ç”Ÿæˆï¼Œå¯ä»¥å°è¯•ä¸‹æ–¹æ¡ˆï¼Œå®˜æ–¹äººå‘˜ä¼šåœ¨ä¸€å®šæ—¶é—´åç»§ç»­ç»§ç»­å¤„ç†ã€‚

æ‚¨å¥½ï¼Œæ„Ÿè°¢æ‚¨æå‡ºé—®é¢˜ã€‚å¦‚æœæˆ‘ç†è§£æ‚¨çš„é—®é¢˜æ­£ç¡®ï¼Œæ‚¨æƒ³åœ¨ proTable çš„ toolbar ä¸­æ·»åŠ ä¸€ä¸ªä¸‹æ‹‰åˆ—è¡¨ï¼Œç„¶åå¯ä»¥ç”¨äºé€‰æ‹©å½“å‰è¡¨æ ¼è¦æ˜¾ç¤ºå“ªäº›åˆ—ã€‚å¦‚æœæˆ‘æè¿°çš„ä¸æ­£ç¡®ï¼Œè¯·å‘Šè¯‰æˆ‘ã€‚

å¯ä»¥ä½¿ç”¨ `columnSetting` çš„æ–¹å¼æ¥å¤„ç†è¿™ä¸ªé—®é¢˜ã€‚æ‚¨éœ€è¦ä¸º `columnSetting` æä¾›ä¸¤ä¸ªå‚æ•°ï¼šä¸€ä¸ªæ˜¯æ‰€æœ‰å¯é€‰æ‹©çš„åˆ—çš„åˆ—è¡¨ï¼ˆ`options`ï¼‰ï¼Œå¦ä¸€ä¸ªæ˜¯å½“å‰è¡¨æ ¼è¦æ˜¾ç¤ºå“ªäº›åˆ—çš„åˆ—è¡¨ï¼ˆ`value`ï¼‰ã€‚

é¦–å…ˆï¼Œåœ¨ ProTable ç»„ä»¶çš„ `columns` å±æ€§ä¸­å®šä¹‰æ‰€æœ‰å¯é€‰æ‹©çš„åˆ—çš„åˆ—è¡¨ã€‚å‡è®¾åœ¨ `columns` ä¸­å®šä¹‰äº†ä»¥ä¸‹ä¸¤ä¸ªæ•°æ®åˆ—ï¼š

```javascript
const columns = [
  {
    title: "Name",
    dataIndex: "name",
    key: "name",
    width: 100,
  },
  {
    title: "Age",
    dataIndex: "age",
    key: "age",
    width: 100,
  },
];
```

æ¥ä¸‹æ¥ï¼Œåœ¨ ProTable çš„ toolbar ä¸­æ·»åŠ ä¸‹æ‹‰åˆ—è¡¨ï¼Œä»¥ä¾›ç”¨æˆ·é€‰æ‹©è¦æ˜¾ç¤ºçš„åˆ—ã€‚å¯ä»¥ä½¿ç”¨ `FormItem`ã€`Select` å’Œ `ProForm` ç»„ä»¶æ¥å®Œæˆæ­¤æ“ä½œã€‚ä¸‹é¢æ˜¯å®Œæ•´çš„ä»£ç ç¤ºä¾‹ã€‚

```javascript
import ProTable, { ProColumns } from '@ant-design/pro-table';
import React, { useState } from 'react';
import { Form, Select } from 'antd';
import type { FormInstance } from 'antd/lib/form';
import { useLocalStorageState } from '@umijs/hooks';
import '@ant-design/pro-table/dist/table.css';

const TableDemo: React.FC = () => {
  const [columns, setColumns] = useLocalStorageState('pro-table-columns-demo', [
    {
      title: 'Name',
      dataIndex: 'name',
      key: 'name',
      width: 100,
    },
    {
      title: 'Age',
      dataIndex: 'age',
      key: 'age',
      width: 100,
    },
    {
      title: 'Address',
      dataIndex: 'address',
      key: 'address',
      width: 200,
    },
    {
      title: 'Phone',
      dataIndex: 'phone',
      key: 'phone',
      width: 150,
    },
  ]);
  const [selectedColumns, setSelectedColumns] = useState<
    { title: string; dataIndex: string }[]
  >(() =>
    columns.filter((column) => column.key !== 'option' && column.key !== 'selection')
  );

  const columnsWithoutSelection = columns.filter(
    (column) => column.key !== 'option' && column.key !== 'selection'
  );
  const options = columnsWithoutSelection.map((column) => ({
    value: column.dataIndex,
    label: column.title,
  }));

  const formRef = React.useRef<FormInstance>();
  const onFormReset = () => formRef.current?.resetFields();
  const onFormSubmit = async () => {
    const values = await formRef.current?.validateFields();
    if (values) {
      const newColumns = columnsWithoutSelection.filter((column) =>
        values.columns.includes(column.dataIndex)
      );
      setColumns([...newColumns, { title: 'Option', key: 'option', fixed: 'right' }]);
      setSelectedColumns(newColumns);
    }
  };

  const columns: ProColumns[] = [
    ...selectedColumns,
    {
      title: 'Operation',
      valueType: 'option',
      key: 'option',
      fixed: 'right',
      render: () => [<a key="editable">Edit</a>, <a key="delete">Delete</a>],
    },
  ];

  return (
    <div style={{ padding: 24 }}>
      <ProTable
        columns={columns}
        rowKey="key"
        dataSource={[
          { key: 1, name: 'John Brown', age: 32, address: 'New York No. 1 Lake Park', phone: '1234567890' },
          { key: 2, name: 'Jim Green', age: 42, address: 'London No. 1 Lake Park', phone: '1234567891' },
          { key: 3, name: 'Joe Black', age: 32, address: 'Sidney No. 1 Lake Park', phone: '1234567892' },
        ]}
        search={false}
        toolbar={{
          actions: [
            <Button
              key="reset"
              onClick={onFormReset}
            >
              Reset
            </Button>,
            <Button
              key="submit"
              type="primary"
              onClick={onFormSubmit}
            >
              Submit
            </Button>,
          ],
          content: (
            <>
              <Form
                ref={formRef}
              >
                <Form.Item
                  noStyle
                  name="columns"
                >
                  <Select
                    mode="multiple"
                    options={options}
                    placeholder="Please select columns to display"
                    style={{ minWidth: 280, maxWidth: 600 }}
                    allowClear
                    maxTagCount={3}
                  />
                </Form.Item>
              </Form>
            </>
          ),
        }}
        options={{
          density: true,
          fullScreen: true,
          setting: true,
        }}
        headerTitle="Basic Table"
        style={{ width: '100%' }}
      />
    </div>
  );
};

export default TableDemo;
```

æ­¤ä»£ç ç¤ºä¾‹ä¸­ï¼Œé¦–å…ˆå®šä¹‰äº† `columns`ï¼Œå…¶ä¸­åŒ…æ‹¬ä¸¤ä¸ªåˆå§‹åˆ—ä»¥åŠä¸¤ä¸ªå¯ä»¥é€‰æ‹©çš„åˆ—ï¼Œå³ Address å’Œ Phoneã€‚ç„¶åï¼Œåœ¨ç»„ä»¶ä¸­å®šä¹‰äº†ä¸¤ä¸ªçŠ¶æ€ï¼š`columns` å’Œ `selectedColumns`ï¼Œä½œä¸ºå½“å‰è¡¨æ ¼è¦æ˜¾ç¤ºçš„æ‰€æœ‰åˆ—å’Œç”¨æˆ·é€‰æ‹©çš„åˆ—ã€‚åœ¨ ProTable çš„ `columns` å±æ€§ä¸­åªæ˜¾ç¤º `selectedColumns` åˆ—ï¼Œå…¶ä¸­åŒ…æ‹¬æ“ä½œåˆ—ã€‚

åœ¨è¡¨æ ¼çš„ toolbar ä¸­æ·»åŠ äº†ä¸€ä¸ªè¡¨å•ï¼Œå…¶åŒ…å«ä¸€ä¸ªå¤šé€‰çš„ä¸‹æ‹‰åˆ—è¡¨ã€‚è¯¥ä¸‹æ‹‰åˆ—è¡¨çš„é€‰é¡¹æ¥è‡ªäº `options`ï¼Œå…¶å®šä¹‰ä¸º `columns` ä¸­é™¤äº†æ“ä½œåˆ—å’Œé€‰æ‹©åˆ—ä¹‹å¤–çš„æ‰€æœ‰åˆ—ã€‚ä½¿ç”¨è¡¨å•çš„ `onFormSubmit` æ–¹æ³•å¯ä»¥æ ¹æ®ç”¨æˆ·é€‰æ‹©çš„åˆ—æ›´æ–°è¡¨æ ¼çš„ `columns` å’Œ `selectedColumns`ã€‚åœ¨è¿™ä¸ªå‡½æ•°ä¸­ï¼Œæ ¹æ® `columns` çš„é€‰æ‹©æ›´æ–° `selectedColumns`ï¼Œç„¶åå°†æ›´æ–°åçš„ `columns` æ›´æ–°åˆ°çŠ¶æ€ä¸­ã€‚

æœ€åï¼Œå°†æ›´æ–°åçš„ `selectedColumns` å’Œæ“ä½œåˆ—å®šä¹‰ä¸º ProTable ç»„ä»¶çš„ `columns` å±æ€§ã€‚å³ï¼ŒProTable å°†åªæ˜¾ç¤ºç”¨æˆ·é€‰æ‹©çš„åˆ—å’Œæ“ä½œåˆ—ã€‚

## chenshuai2144

å¯ä»¥çœ‹æºç è‡ªå·±å®ç°ä¸€ä¸‹ï¼Œæœ¬æ¥åªæ˜¯ä¸ªè¾…åŠ©å°å·¥ä½œï¼Œä¸å¸Œæœ›å¤ªå¤æ‚
