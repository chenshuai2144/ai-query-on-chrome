# 🧐[问题] ProFormSelect 选中item为什么会触发onSearch方法

https://codesandbox.io/s/biao-dan-xiang-forked-xbm68h?file=/App.tsx:964-972

## thinkasany

在组件pro-components/packages/field/src/components/Select/SearchSelect/index.tsx 下，将搜索框置空 和 antd 行为保持一致, 做了一个 setSearchValue(undefined);和 onSearch?.(''); 的操作，就是当你选中选项的时候，会清空输入框，因为proselect组件在onSearch的时候操作了setSearchValue和fetchData了，如果不清空，就会导致行为和select组件不一，必须你手动清空输入的值，才能选择其他选项。

<img width="615" alt="image" src="https://user-images.githubusercontent.com/117748716/229862427-d1d4dede-0ac5-44c5-aa2b-b49840e934ae.png">

## datoou

> 在组件pro-components/packages/field/src/components/Select/SearchSelect/index.tsx 下，将搜索框置空 和 antd 行为保持一致, 做了一个 setSearchValue(undefined);和 onSearch?.(''); 的操作，就是当你选中选项的时候，会清空输入框，因为proselect组件在onSearch的时候操作了setSearchValue和fetchData了，如果不清空，就会导致行为和select组件不一，必须你手动清空输入的值，才能选择其他选项。
>
> <img alt="image" width="615" src="https://user-images.githubusercontent.com/117748716/229862427-d1d4dede-0ac5-44c5-aa2b-b49840e934ae.png">

好像和antd 不一致
https://codesandbox.io/s/biao-dan-xiang-forked-4uw0c8?file=/App.tsx

## thinkasany

能具体的描述一下你说的不一致么，你说antd选中options的时候并不会打印你的console.log("antd search：" + v)么，如果说这样子的话，就是我说的那个因为他调用了一下onSearch，所以执行了你传入的这个函数，他要保持的一致是如果搜索了一个options的时候点击选中了之后清空，可以再选所有的options，如果注释了下面这个onsearch的话，那么在onSearch那些步骤的操作没有清空会导致行为不一致，就是过滤条件还显示在输入框

## datoou

> 能具体的描述一下你说的不一致么，你说antd选中options的时候并不会打印你的console.log("antd search：" + v)么，如果说这样子的话，就是我说的那个因为他调用了一下onSearch，所以执行了你传入的这个函数，他要保持的一致是如果搜索了一个options的时候点击选中了之后清空，可以再选所有的options，如果注释了下面这个onsearch的话，那么在onSearch那些步骤的操作没有清空会导致行为不一致，就是过滤条件还显示在输入框

就是我在ProFormSelect里面写了onSearch方法，然后在多选的时候每次选中options都会调用一下onSearch方法。

## thinkasany

Onchange的时候调用了一下你props中解构出来的onSearch?.('')呀， 这个onSearch?.('')是你传入的， Onchange嘛不就是监听change，因为他传给antd的select的Onsearch里面做了其他操作，需要在传给antd的select的onchange中做清空处理，

## thinkasany

🤔 我表述的有什么问题嘛，你可以打开那个组件注释一下调试一下，pro-components/packages/field/src/components/Select/SearchSelect/index.tsx，然后通过他的demo修改一下你传入的那个条件

## datoou

就是我希望选中options的时候不掉用我传的onSearch.

## jingxiawl

> 就是我希望选中options的时候不掉用我传的onSearch.

请问这个问题解决了么，这样导致了我输入查询数据有问题

## chenshuai2144

老哥解释的很清楚了，如果你需要避开的话，可以是看这里避开

![1689496297413](https://github.com/ant-design/pro-components/assets/8186664/ed986971-4ec3-4e3b-baae-a2ebb27fd4d4)

## jingxiawl

> 老哥解释的很清楚了，如果你需要避开的话，可以是看这里避开
>
> ![1689496297413](https://user-images.githubusercontent.com/8186664/253793459-ed986971-4ec3-4e3b-baae-a2ebb27fd4d4.png)

不是需要避开，如果你设置了autoClearSearchValue为false导致不会清空输入框，但是不加入的话，我输入了一个搜索value ，渲染出来了下拉选择的数据，但是一选择又调用了onSearch方法，导致我的下拉数据变成空了

例如
![image](https://github.com/ant-design/pro-components/assets/11657532/fd978efc-4f45-4a0e-8782-19f9f1d588aa)
选中的时候也回调用onSearch 导致我的下拉都变成空了，我看了下antd的select组件不会出现调用onsearch的情况

## lizm-21

解决了么

## lizm-21

@thinkasany 解决了么
