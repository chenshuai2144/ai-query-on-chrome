# ğŸ§[é—®é¢˜] ProTable é‡‘é¢(valueType: "money")éœ€è¦åœ¨æœç´¢æ æ¸²æŸ“æˆä¸€ä¸ªèŒƒå›´çš„é—®é¢˜, å’Œ0ä¸è¢«ä¼ å€¼çš„é—®é¢˜

`AI Reply`

### ğŸ§ é—®é¢˜æè¿°

è¡¨æ ¼é‡Œçš„é‡‘é¢æ˜¯ä¸€åˆ—ï¼Œä½†æ˜¯æœç´¢æ ä¸­éœ€è¦æ¸²æŸ“æˆç±»ä¼¼äº dateRange çš„é‚£ç§ï¼Œè¾“å…¥ä¸€ä¸ªèŒƒå›´çš„ã€‚çœ‹äº†ä¸‹[æ‰€æœ‰çš„valueType](https://procomponents.ant.design/components/schema#valuetype)è²Œä¼¼ä¸æ”¯æŒç±»ä¼¼äºdigitRangeçš„typeï¼Ÿ

é‚£æˆ‘ç›®å‰çš„ä¸€ä¸ªworkaroundå°±æ˜¯ï¼Œ1ä¸ªcolumnç”¨äºæ˜¾ç¤ºåœ¨tableï¼Œ2ä¸ªcolumnç”¨äºæ˜¾ç¤ºåœ¨searchæ 

### ğŸ’» ç¤ºä¾‹ä»£ç 

```
        {
            title: "é‡‘é¢",
            dataIndex: "amount",
            valueType: "money",
            sorter: true,
            hideInSearch: true,
        },
        {
            title: "æœ€å°é‡‘é¢",
            dataIndex: "minAmount",
            valueType: "money",
            hideInTable: true,
        },
        {
            title: "æœ€å¤§é‡‘é¢",
            dataIndex: "maxAmount",
            valueType: "money",
            hideInTable: true,
        },
```

æˆ‘çš„é—®é¢˜æ˜¯ï¼š

1. æœ‰æ›´å¥½çš„åŠæ³•å—ï¼Ÿæˆ‘å°è¯•è¿‡ä¸ç”¨åé¢2ä¸ªè™šæ‹Ÿåˆ—ï¼Œç›´æ¥ä½¿ç”¨renderFormItemæ¸²æŸ“ä¸¤ä¸ª`<InputNumber />-<InputNumber />`ï¼Œä½†æ˜¯æ²¡æœ‰å¯¹åº”çš„valueTypeå¯ä»¥ç”¨å¯¼è‡´è¿™ä¹ˆæ¸²æŸ“ï¼Œç‚¹å‡»æŸ¥è¯¢æ˜¯æ‹¿ä¸åˆ°å€¼çš„
2. inputçš„ç±»å‹æ˜¯moneyæˆ–è€…digitçš„æ—¶å€™ï¼Œç”¨æˆ·åœ¨è¾“å…¥æ¡†é‡Œè¾“å…¥0ï¼Œæ˜¯ä¸ä¼šè¢«å–åˆ°å€¼çš„ï¼ˆæˆ‘çœ‹è¯·æ±‚ï¼Œå¦‚æœå¡«0æˆ–è€…ä¸å¡«ï¼Œéƒ½ä¸ä¼šä¼ è¿™ä¸ªå­—æ®µçš„å€¼ï¼‰ã€‚æ€ä¹ˆæ ·æ‰èƒ½å½“è¾“å…¥çš„æ˜¯0çš„æ—¶å€™ï¼Œä¹Ÿèƒ½å¾—åˆ°0å‘¢ï¼Ÿå½“ç„¶è¦ä¿ç•™ä»€ä¹ˆéƒ½ä¸è¾“å…¥è¿˜æ˜¯ä»€ä¹ˆéƒ½ä¸ä¼ ã€‚

## chenshuai2144

> TAutomatically replying with ChatGPT can be attempted, but it cannot be guaranteed to be completely accurate and may not fully address all issues. Please feel free to reply if you have any further questions or concerns.
> æ­¤å›å¤åŸºäº ChatGPT è‡ªåŠ¨ç”Ÿæˆï¼Œå¯ä»¥å°è¯•ä¸‹æ–¹æ¡ˆï¼Œå®˜æ–¹äººå‘˜ä¼šåœ¨ä¸€å®šæ—¶é—´åç»§ç»­ç»§ç»­å¤„ç†ã€‚

### ğŸŒˆ è§£å†³æ–¹æ¡ˆ

1. æ‚¨å¯ä»¥ä½¿ç”¨ `ProForm` å¸¦æœ‰ `RangePicker[money]` æ¥è§£å†³è¯¥é—®é¢˜ï¼Œå®ç°ä»£ç å’Œæ¸²æŸ“æ•ˆæœå¦‚ä¸‹ã€‚

```tsx
import { ProForm, ProFormDatePicker, ProFormText } from '@ant-design/pro-form';

...

<ProForm onFinish={onFinish}>
  <ProForm.Group>
    <ProFormDatePicker.MoneyRangePicker name="amount" />
    <ProFormText name="otherField" />
  </ProForm.Group>
</ProForm>
```

![image](https://user-images.githubusercontent.com/28954298/125194098-ef3c2d80-e28a-11eb-965b-fa98fbf16b43.png)

2. `ProTable` ä¸­çš„ `valueType` å¯ä»¥é€šè¿‡è‡ªå®šä¹‰ `renderFormItem` æ¥å®ç°èŒƒå›´æ£€ç´¢ï¼Œæœ¬ä¾‹ä¸­ `valueType` ä¸º `text`ï¼Œè¯¦è§ä»¥ä¸‹ä»£ç ã€‚

```tsx
const columns = [
  {
    title: 'é‡‘é¢',
    dataIndex: 'amount',
    valueType: 'text',
    renderFormItem: (_, { value, onChange }) => (
      <Input.Group compact>
        <InputNumber
          value={value ? value[0] : undefined}
          onChange={(val) => onChange([val, value[1]])}
          style={{ width: '45%' }}
          min={0}
        />
        <Input
          style={{
            width: '10%',
            borderLeft: 0,
            pointerEvents: 'none',
            backgroundColor: '#fff',
          }}
          placeholder="~"
          disabled
        />
        <InputNumber
          value={value ? value[1] : undefined}
          onChange={(val) => onChange([value[0], val])}
          style={{ width: '45%', borderLeft: 0 }}
          min={0}
        />
      </Input.Group>
    ),
    render: (dom, entity) => formatMoney(entity.amount),
  },
  ...
];

<ProTable
  columns={columns}
  request={async () => {
    // ...
  }}
  search={{
    allowClear: true,
  }}
/>;
```

![image](https://user-images.githubusercontent.com/28954298/125194247-ddd90280-e28b-11eb-8ec8-e879a01a29c7.png)

3. å¦‚æœæ‚¨åšæŒä½¿ç”¨ `RangePicker[digit]`ï¼Œå¯ä»¥å¯¹ç”¨æˆ·è¾“å…¥çš„æ•°å­— `0` è¿›è¡Œæ‹¦æˆªï¼ŒåŠ ä¸Š `0.` (å‘ï¼š0.ã€0.0ã€0.00 ç­‰éƒ½ä¸èƒ½è¯†åˆ«ä¸º `0`)ã€‚
   å®ç°ä»£ç å¦‚ä¸‹ã€‚

```tsx
import { InputNumber } from 'antd';
import React, { useState } from 'react';

...

const handleInput = (val: string) => {
  if (val === '0') {
    // å¦‚æœç”¨æˆ·è¾“å…¥çš„æ˜¯0ï¼Œå¼ºè¡ŒåŠ ä¸Šå°æ•°ç‚¹ï¼Œå˜æˆ0.
    setStrValue('0.');
  } else {
    setStrValue(val);
  }
};

<InputNumber
  min={0}
  formatter={(value) =>
    value ? formatMoney(parseFloat(value.toFixed(2)), currencies[0]) : ''
  }
  parser={(inputValue) =>
    parseFloat(inputValue ? inputValue.replace(/Â¥|,/g, '') : 0)
  }
  maxLength={15}
  style={{ width: '100%' }}
  value={strValue}
  onChange={(val) => setValue(val)}
  onBlur={(e) => handleInput(e.target.value)}
/>
```

### ğŸ“š ç›¸å…³æ–‡æ¡£

- [ProComponents RangePicker](https://procomponents.ant.design/components/range-picker)
- [ProComponents è‡ªå®šä¹‰ filter](https://procomponents.ant.design/components/table#%E7%AD%9B%E9%80%89-filter)

  ## textnumber085

  è¿™AIæ˜¯æ€ä¹ˆæ‰“å‡º`å‘`çš„å“ˆå“ˆå“ˆå“ˆ

> (å‘ï¼š0.ã€0.0ã€0.00 ç­‰éƒ½ä¸èƒ½è¯†åˆ«ä¸º 0)ã€‚

## textnumber085

æ–¹æ³•äºŒï¼Œæ¸²æŸ“å‡º2ä¸ªinputæ˜¯å¯ä»¥çš„ï¼Œä½†æ˜¯ç‚¹å‡»æŸ¥è¯¢æŒ‰çº½åï¼Œå¹¶æ²¡æœ‰åœ¨requestä¸­çœ‹åˆ°æœ‰è¿™ä¸ªå‚æ•°å¸¦ç€

## chenshuai2144

> TAutomatically replying with ChatGPT can be attempted, but it cannot be guaranteed to be completely accurate and may not fully address all issues. Please feel free to reply if you have any further questions or concerns.
> æ­¤å›å¤åŸºäº ChatGPT è‡ªåŠ¨ç”Ÿæˆï¼Œå¯ä»¥å°è¯•ä¸‹æ–¹æ¡ˆï¼Œå®˜æ–¹äººå‘˜ä¼šåœ¨ä¸€å®šæ—¶é—´åç»§ç»­ç»§ç»­å¤„ç†ã€‚

æ£€æŸ¥ä¸€ä¸‹ä»£ç ï¼Œè§‚å¯Ÿæ˜¯å¦å·²ç»å°†æŸ¥è¯¢è¡¨å•çš„å‚æ•°ä¼ é€’ç»™äº† ProTable çš„ request ä¸­çš„å‚æ•°ã€‚

ä¸€èˆ¬æ¥è¯´ï¼Œåœ¨ ProTable ä¸­ï¼Œéœ€è¦å°† search ä¸­çš„æœç´¢å‚æ•°ä¼ å…¥ querystring æˆ–è€…æ˜¯æ”¾åˆ°è¡¨å•æ•°æ®ä¸­å†å‘é€è¯·æ±‚ã€‚å¦å¤–æŸ¥è¯¢å‚æ•°å‘ç”Ÿå˜åŒ–æ—¶ï¼Œè¯·æ±‚ä¹Ÿè¦è·Ÿç€å˜åŒ–ï¼Œæ˜¯åœ¨ childRef é‡Œé¢æ‰§è¡Œçš„ï¼Œåœ¨ ProTable çš„ onSearch äº‹ä»¶ä¸­éœ€è¦æ‹¿åˆ°ä½ çš„ childRefï¼Œç„¶å forceUpdate ä¸€ä¸‹ã€‚

å‚è€ƒä¸€ä¸‹è¯¥ç¤ºä¾‹ä»£ç ï¼š

```tsx
import React, { useRef } from "react";
import { Button, Input } from "antd";
import ProTable from "@ant-design/pro-table";

const { Search } = Input;

const columns = [
  {
    title: "id",
    dataIndex: "id",
  },
  {
    title: "title",
    dataIndex: "title",
  },
];

export default () => {
  const childRef = useRef(null);

  return (
    <div>
      <ProTable
        columns={columns}
        request={(params) => {
          console.log(params);
          return Promise.resolve({ data: [], success: true });
        }}
        rowKey="id"
        search={{
          collapsed: false,
          optionRender: ({ searchText, resetText }, { form }) => (
            <>
              <Search
                placeholder="è¯·è¾“å…¥æ ‡é¢˜"
                value={form.getFieldValue("title")}
                onChange={(event) =>
                  form.setFieldsValue({ title: event.target.value })
                }
                onSearch={() => childRef.current.reload()}
                style={{ width: 200 }}
              />
              <Button onClick={() => console.log(form.getFieldsValue())}>
                æœç´¢
              </Button>
            </>
          ),
        }}
        dateFormatter="string"
        headerTitle="é«˜çº§è¡¨æ ¼"
        toolBarRender={() => [
          <Button onClick={() => console.log(childRef.current.getDataSource())}>
            æ‰“å°è¡¨æ ¼æ•°æ®
          </Button>,
        ]}
        tableAlertRender={({ selectedRowKeys }) => (
          <div>
            å·²é€‰æ‹© <a style={{ fontWeight: 600 }}>{selectedRowKeys.length}</a>{" "}
            é¡¹&nbsp;&nbsp;
            <span>
              æœåŠ¡è°ƒç”¨æ¬¡æ•°æ€»è®¡ {""}
              <span style={{ fontWeight: 600 }}>0</span> æ¬¡
            </span>
          </div>
        )}
        request={(params) => {
          console.log(params);
          return Promise.resolve({
            data: [
              {
                id: "1",
                title: "è¿™æ˜¯ä¸€æ¡æµ‹è¯•æ•°æ®",
                status: "normal",
                created_at: 1613202087000,
                progress: 0,
              },
              {
                id: "2",
                title: "è¿™æ˜¯äºŒæ¡æµ‹è¯•æ•°æ®",
                status: "exception",
                created_at: 1613202087000,
                progress: 0,
              },
              {
                id: "3",
                title: "è¿™æ˜¯ä¸‰æ¡æµ‹è¯•æ•°æ®",
                status: "active",
                created_at: 1613202087000,
                progress: 0,
              },
            ],
            success: true,
            total: 3,
          });
        }}
        pagination={{
          showQuickJumper: true,
        }}
        actionRef={childRef}
      />
    </div>
  );
};
```

- demo åœ¨è¡¨å•ç»„ä»¶ `Search` åŠ ç‚¹å‡»æœç´¢åçš„æŸ¥è¯¢æŒ‰é’®ï¼Œå°†æ•°æ®ä¼ åˆ°äº† `ProTable`
- ä½¿ç”¨ `actionRef` è·å– `childRef.current.getDataSource()`ï¼Œæ‰“å°å½“å‰è¡¨æ ¼çš„æ•°æ®
- æ£€æŸ¥ä¸€ä¸‹ `request` å‡½æ•°æ¥æ”¶åˆ°çš„å‚æ•°ï¼Œæ ¹æ®ä¼ å…¥çš„å‚æ•°è¿”å›æ•°æ®

å¦å¤–ï¼Œè¦æ³¨æ„æ•°æ®æ ¼å¼å’Œå­—æ®µåæ˜¯å¦å’Œ `params` å¯¹è±¡ä¸€è‡´ï¼Œæˆ–è€…åœ¨ä½¿ç”¨ `API` æ—¶å‘é€ `post` è¯·æ±‚æ—¶ï¼Œå‚æ•°æ ¼å¼æ˜¯å¦æ­£ç¡®ã€‚

å¦‚æœå·²ç»æŒ‰ç…§ä»¥ä¸Šæ–¹æ³•å®ç°ï¼Œä½†è¿˜æ˜¯å‡ºç°äº†æŸ¥è¯¢ä¸åˆ°æ•°æ®çš„æƒ…å†µï¼Œè¯·å†æ¬¡æ£€æŸ¥ä¸€ä¸‹ä»£ç ï¼Œæ˜¯å¦æœ‰å…¶ä»–å½±å“è¯·æ±‚å‚æ•°çš„ä»£ç é€»è¾‘ã€‚å¦‚æœé—®é¢˜è¿˜æœªè§£å†³ï¼Œè¯·è´´ä¸Šä½ çš„å®Œæ•´ä»£ç ï¼Œæˆ‘ä»¬å°†ä¼šä¸€èµ·æ¥è§£å†³ã€‚

## textnumber085

è¿™... AIä¸å¤ªæ™ºèƒ½çš„æ ·å­

## lili574

è¯•è¯•valueType: 'digitRange'
@textnumber085

## chenshuai2144

æ¥¼ä¸Šæ­£è§£ï¼Œç”¨ digitRange å§ï¼Œmoney æ²¡æ”¯æŒ range
