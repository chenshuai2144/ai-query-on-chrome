# 🧐[问题]ProTable点击【重置】，对于设有initialValue的QueryFilter如何清空其初始化值？

`AI Reply`

### 🧐 问题描述

在使用ProTable的过程中，因为涉及到页面之间的跳转，携带相关的查询参数；
因此在ProTable的columns定义中，使用了initialValue来进行初始化相关的查询参数的值，如下面截图1；

但后面点击【重置】的过程中，在onReset的回调中使用了ProTable的formRef中的resetFields方法也无法清除默认值。

请问如何正确去清空呢？

### 🚑 其他信息

![image](https://user-images.githubusercontent.com/23149314/232001454-70abae9f-8f64-4714-879c-acf6b5d885ec.png)

## chenshuai2144

> TAutomatically replying with ChatGPT can be attempted, but it cannot be guaranteed to be completely accurate and may not fully address all issues. Please feel free to reply if you have any further questions or concerns.
> 此回复基于 ChatGPT 自动生成，可以尝试下方案，官方人员会在一定时间后继续继续处理。

### 📝 解决方案

在使用initialValues初始化表单的值时，需要额外处理重置按钮的行为，可以在form实例化时，为表单添加onReset的回调函数，在每次重置表单时，我们将initialValues作为参数传递给setFieldsValue方法来重新渲染表单数据。

下面是一个示例代码片段：

```jsx
import React, { useRef } from 'react';
import ProTable, { ProColumns } from '@ant-design/pro-table';
import { Form } from 'antd';

interface User {
  id: number;
  name: string;
  age: number;
}

const TableList: React.FC = () => {
  const formRef = useRef();

  const columns: ProColumns<User>[] = [
    {
      title: 'ID',
      dataIndex: 'id',
      hideInSearch: true,
    },
    {
      title: '姓名',
      dataIndex: 'name',
      initialValue: '张三', // Initial value of the filter
      renderFormItem: (_, { onReset }) => (
        <Form.Item name="name">
          <Input placeholder="请输入姓名" allowClear onBlur={onReset} />
        </Form.Item>
      ),
    },
    {
      title: '年龄',
      dataIndex: 'age',
      initialValue: 18,
      renderFormItem: (_, { onReset }) => (
        <Form.Item name="age">
          <InputNumber placeholder="请输入年龄" onBlur={onReset} />
        </Form.Item>
      ),
    },
  ];

  const handleReset = () => {
    // Set the initial value to clear the filter
    const values = formRef.current.getFieldsValue();
    formRef.current.setFieldsValue({
      name: undefined,
      age: undefined,
    });
  };

  return (
    <ProTable<User>
      columns={columns}
      dataSource={[]}
      formRef={formRef}
      onReset={handleReset}
    />
  );
};

export default TableList;
```

在这个示例中，我们首先需要在formRef中添加一个onReset的回调函数，在这个回调函数中我们可以使用getFieldsValue方法获取到当前表单的数据，然后再使用setFieldsValue清空表单。

另外需要注意的是，初始值被赋值后，如果你强制清空了 `Input` 值，它会再次使用原来的值重置 `Input`。此时，可以绑定 `onBlur` 事件，以免强制清空导致的影响。

## chenshuai2144

`setFieldsValue(null)` 这样呢？onReset 里面执行一下

## hexiaomin496

> ```js
> const formRef = useRef();
> ```

经过试验，setFiledsValue(null)也是不起作用的。
