# pnpm run openapi报错🧐[问题]

`AI Reply`

### 🧐 问题描述

[openAPI]: 💺 将 Swagger 转化为 openAPI
/Users/jiangyichen/Desktop/work/Industrial-Internet/node_modules/.pnpm/swagger2openapi@7.0.8/node_modules/swagger2openapi/index.js:1347
else return reject(new S2OError('(Patchable) info.termsOfService must be a URL'));
^

S2OError: (Patchable) info.termsOfService must be a URL
at fixInfo (/Users/jiangyichen/Desktop/work/Industrial-Internet/node_modules/.pnpm/swagger2openapi@7.0.8/node_modules/swagger2openapi/index.js:1347:32)
at /Users/jiangyichen/Desktop/work/Industrial-Internet/node_modules/.pnpm/swagger2openapi@7.0.8/node_modules/swagger2openapi/index.js:1522:9
at new Promise (<anonymous>)
at Object.convertObj (/Users/jiangyichen/Desktop/work/Industrial-Internet/node_modules/.pnpm/swagger2openapi@7.0.8/node_modules/swagger2openapi/index.js:1384:28)
at /Users/jiangyichen/Desktop/work/Industrial-Internet/node_modules/.pnpm/@umijs+openapi@1.8.2/node_modules/@umijs/openapi/dist/index.js:28:35
at new Promise (<anonymous>)
at converterSwaggerToOpenApi (/Users/jiangyichen/Desktop/work/Industrial-Internet/node_modules/.pnpm/@umijs+openapi@1.8.2/node_modules/@umijs/openapi/dist/index.js:27:12)
at /Users/jiangyichen/Desktop/work/Industrial-Internet/node_modules/.pnpm/@umijs+openapi@1.8.2/node_modules/@umijs/openapi/dist/index.js:63:27
at Generator.next (<anonymous>)
at fulfilled (/Users/jiangyichen/Desktop/work/Industrial-Internet/node_modules/.pnpm/tslib@2.5.0/node_modules/tslib/tslib.js:164:62)
 ELIFECYCLE  Command failed with exit code 1.

### 💻 示例代码

openAPI: [
{
requestLibPath: "import { request } from '@umijs/max'",
// 或者使用在线的版本
// schemaPath: "https://gw.alipayobjects.com/os/antfincdn/M%24jrzTTYJN/oneapi.json"
schemaPath: join(__dirname, 'oneapi.json'),
mock: false,
},
{
requestLibPath: "import { request } from '@umijs/max'",
// schemaPath: 'http://20.20.129.218:8002/internet-web/v2/api-docs?group=group_name',
schemaPath: join(__dirname, 'openapi.json'),
projectName: 'industrial-internet',
mock: false
},
],

openapi.js下的内容
![image](https://github.com/ant-design/pro-components/assets/77370829/41d4f168-f7b8-41e5-a304-3833fa311e69)

## chenshuai2144

> TAutomatically replying with ChatGPT can be attempted, but it cannot be guaranteed to be completely accurate and may not fully address all issues. Please feel free to reply if you have any further questions or concerns.
> 此回复基于 ChatGPT 自动生成，可以尝试下方案，官方人员会在一定时间后继续继续处理。

### 📝 解决方案

根据您提供的错误信息，问题出现在 `swagger2openapi` 的库中，具体是在转换 Swagger 到 openAPI 过程中遇到了问题。

错误信息显示 `info.termsOfService must be a URL`，这意味着在转换过程中，`info` 对象中的 `termsOfService` 字段必须是一个 URL，否则会报错。

您提供了 `openapi.js` 文件的内容，但很抱歉无法直接打开链接查看图片。因此，我将根据您提供的代码和报错信息给出一些可能的解决方案。

1. 确保 `openAPI` 数组中的每个对象中的 `schemaPath` 字段所指向的文件是有效的，并且每个文件中的 `info.termsOfService` 是一个 URL。

   例如：

   - `oneapi.json` 文件中的 `info.termsOfService` 字段是否包含有效的 URL。
   - `openapi.json` 文件中的 `info.termsOfService` 字段是否包含有效的 URL。

2. 如果您的文件中的 `info.termsOfService` 字段已经是一个有效的 URL，但仍然出现错误，请检查 `swagger2openapi` 的版本是否较旧。尝试升级到最新的版本，以便修复已知的 bug。

3. 如果以上解决方案都没有帮助，可能是 `swagger2openapi` 库的一个 bug。您可以尝试在该库的 GitHub 仓库中搜索类似的问题，或者创建一个新的 issue 来寻求帮助。记得按照仓库的规定提供详细的报错信息、代码示例和重现步骤。

希望以上解决方案能够帮助到您！如果您需要进一步的帮助，请随时告诉我。

## chenshuai2144

这个库是社区自维护的，你去那边看看吧
