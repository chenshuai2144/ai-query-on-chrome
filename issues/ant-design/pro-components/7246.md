# 🧐[问题]ProLayout 远程加载菜单时，出现闪烁

提问前先看看：

https://github.com/ryanhanwu/How-To-Ask-Questions-The-Smart-Way/blob/main/README-zh_CN.md

### 🧐 问题描述

<!--
配置远程加载时，先加载了全部的菜单然后再根据远程的数据渲染，导致出现闪烁
-->

### 💻 示例代码

### 🚑 其他信息

这里故意断点，可以看到先加载了全部的菜单
![image](https://github.com/ant-design/pro-components/assets/39617057/25370ef6-992e-4391-bba0-d1cd60b8320d)

执行完的截图：
![image](https://github.com/ant-design/pro-components/assets/39617057/aaf7fbdd-ca4a-494c-b7d2-386c2137c169)

## chenshuai2144

你把 `route` 设置为空

`route={{  routes: []}}`

## Merely-chao

谢谢解答，如果这样设置的话，图标都没了，就会要自己实现一套解析图标的逻辑。我这边的处理逻辑是把所有的路由都在前端配置好，然后根据界面跳转到指定界面，再筛选出针对的路由做菜单。我想的是能不能当配置了request请求方法时，菜单先不渲染到界面上，然后第二个参数还是把所有解析好的照样传进来，以request返回的作为渲染数据，这样的话图标就是默认的已经解析好了。

## Merely-chao

@chenshuai2144

## hyzx86

@Merely-chao 修复图标问题，其实你网上搜下也有

```ts
import React from "react";
import * as aliIcons from "@ant-design/icons";
import { EocMenuDataItem } from "@/types/src/SiteGlobalSettings";
// import { FontAwesomeIcon } from '@fortawesome/react-fontawesome'
// import { treeMap } from './tree';
// FIX从接口获取菜单时icon为string类型
export const fixMenuItemIcon = (
  menus: EocMenuDataItem[],
  iconType = "Outlined",
): EocMenuDataItem[] => {
  menus.forEach((item) => {
    const { icon, routes } = item;
    if (typeof icon === "string") {
      //无法直接加载 fa 图标
      // item.icon = React.createElement(FontAwesomeIcon, { icon: 'fa-calculator' }, null)

      // if (icon.startsWith('fa')) {
      //     //
      //     //<FontAwesomeIcon icon="fa-solid fa-calculator" />
      //     item.icon = React.createElement(FontAwesomeIcon, { icon: 'fa-calculator' }, null)
      //     return
      // }
      const fixIconName =
        icon.slice(0, 1).toLocaleUpperCase() + icon.slice(1) + iconType;

      const iconNode = aliIcons[fixIconName] || aliIcons[icon];
      if (iconNode) {
        item.icon = React.createElement(
          aliIcons[fixIconName] || aliIcons[icon],
        );
      }
    }
    // eslint-disable-next-line @typescript-eslint/no-unused-expressions
    if (routes && (routes as []).length > 0) {
      item.children = fixMenuItemIcon(routes);
    }
  });
  return menus;
};
```
