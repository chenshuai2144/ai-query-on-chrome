# ğŸ›[BUG] QueryFilter ä¸‹ Form.useWatch ä¸ä¼šç”Ÿæ•ˆ

`AI Reply`

```jsx
<QueryFilter
initialValues={{
          channel: [],
          channel__mode: '121',
        }}>
<ChannelSelect label="æ¸ é“" name="channel" />
</QueryFilter>


const ChannelSelect: FC<ProFormSelectProps> = ({ name, fieldProps, placeholder, ...other }) => {
const { initialState } = useModel('@@initialState')
const form = Form.useFormInstance()
const radio = Form.useWatch('channel__mode', form)

console.log('radio', radio) // è¿™é‡Œæ€»æ˜¯ undefined

const onRadioChange = (val: string) => {
  console.log('onRadioChange', val)

  form.setFieldsValue({
    channel__mode: val,
  })
}

return  null
}
```

antd ç‰ˆæœ¬ 4.22

## chenshuai2144

> TAutomatically replying with ChatGPT can be attempted, but it cannot be guaranteed to be completely accurate and may not fully address all issues. Please feel free to reply if you have any further questions or concerns.
> æ­¤å›å¤åŸºäº ChatGPT è‡ªåŠ¨ç”Ÿæˆï¼Œå¯ä»¥å°è¯•ä¸‹æ–¹æ¡ˆï¼Œå®˜æ–¹äººå‘˜ä¼šåœ¨ä¸€å®šæ—¶é—´åç»§ç»­ç»§ç»­å¤„ç†ã€‚

æ ¹æ®ä½ æä¾›çš„ä»£ç ï¼Œæˆ‘ä»¬æ³¨æ„åˆ°åœ¨`ChannelSelect`ç»„ä»¶ä¸­ï¼Œä½ ä½¿ç”¨äº†`Form.useWatch`æ¥ç›‘è§†`channel__mode`å­—æ®µçš„å€¼ã€‚ç„¶è€Œï¼Œä½ ä¹Ÿæåˆ°æ— è®ºå¦‚ä½•è¯¥å€¼æ€»æ˜¯è¢«è®¤ä¸ºæ˜¯`undefined`ã€‚

è¿™ä¸ªé—®é¢˜å¯èƒ½æ˜¯ç”±äºä»¥ä¸‹å‡ ä¸ªåŸå› å¼•èµ·çš„ï¼š

1. å½“å‰ç‰ˆæœ¬çš„`Form`ç»„ä»¶å¯èƒ½å­˜åœ¨ä¸€äº›é—®é¢˜æˆ–è€…é™åˆ¶ï¼Œå°è¯•æ›´æ–°`antd`ç‰ˆæœ¬åˆ°æœ€æ–°ç‰ˆæœ¬ï¼Œä»¥æŸ¥çœ‹é—®é¢˜æ˜¯å¦å·²ç»ä¿®å¤ã€‚
2. ç¡®ä¿ä½ æ­£ç¡®åœ°å°†`Form`å®ä¾‹ä¼ é€’ç»™`ChannelSelect`ç»„ä»¶ã€‚å¯ä»¥ä½¿ç”¨`Form.useForm()`æ¥è·å–ä¸€ä¸ª`form`å¯¹è±¡ï¼Œå¹¶å°†å…¶ä¼ é€’ç»™`ChannelSelect`ç»„ä»¶ã€‚

åœ¨è§£å†³è¿™ä¸ªé—®é¢˜ä¹‹å‰ï¼Œè¯·å‚è€ƒä»¥ä¸‹ä»£ç ç¤ºä¾‹å’Œæ–‡æ¡£ï¼Œä»¥ç¡®ä¿ä½ æ­£ç¡®åœ°é…ç½®äº†`QueryFilter`å’Œ`ChannelSelect`ç»„ä»¶ï¼š

```jsx
import { Form } from 'antd';
import { useModel } from 'umi';

const { QueryFilter } = AntdComponent; // æ›¿æ¢ä¸ºä½ ä½¿ç”¨çš„ QueryFilter ç»„ä»¶

const YourComponent = () => {
  const { initialState } = useModel('@@initialState');
  const [form] = Form.useForm(); // è·å–ä¸€ä¸ª form å®ä¾‹

  return (
    <QueryFilter form={form} initialValues={{ channel: [], channel__mode: '121' }}>
      <ChannelSelect label="æ¸ é“" name="channel" form={form} />
    </QueryFilter>
  );
};

const ChannelSelect: FC<ProFormSelectProps> = ({ name, form, fieldProps, placeholder, ...other }) => {
  const radio = Form.useWatch('channel__mode', form);

  console.log('radio', radio);

  const onRadioChange = (val: string) => {
    console.log('onRadioChange', val);

    form.setFieldsValue({
      channel__mode: val,
    });
  };

  return null;
};

export default YourComponent;
```

æ­¤å¤–ï¼Œç¡®ä¿æ‚¨çš„ç»„ä»¶ä½¿ç”¨äº†æ­£ç¡®çš„`import`è¯­å¥æ¥å¼•å…¥æ‰€éœ€çš„æ¨¡å—ã€‚è¯·æŸ¥é˜…`antd`æ–‡æ¡£å’Œä½ ä½¿ç”¨çš„å…¶ä»–ç»„ä»¶çš„ç›¸å…³æ–‡æ¡£ï¼Œä»¥ç¡®ä¿ä½ ä½¿ç”¨äº†æ­£ç¡®çš„ç‰ˆæœ¬å’Œé…ç½®ã€‚

## chenshuai2144

ä¼°è®¡æ˜¯antd çš„ç‰ˆæœ¬ä¸¤ä»½äº†ï¼Œä½ æ’æŸ¥ä¸€ä¸‹
