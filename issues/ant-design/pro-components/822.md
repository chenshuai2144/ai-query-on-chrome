# 🐛[BUG]defaultOpenKeys 配置默认展开子菜单不生效

`layout`

### 🐛 bug 描述

配置了 defaultOpenKeys，但是对应的子菜单并没有展开

<!--
详细地描述 bug，让大家都能理解
-->

### 📷 复现步骤

最小可复现仓库：https://github.com/yingzhiji/pro-layout-bug.git

<!--
清晰描述复现步骤，让别人也能看到问题
-->

### 🏞 期望结果

展开对应的子菜单

<!--
描述你原本期望看到的结果
-->

## jiyingzhi

这个目前有解决办法吗

## chenshuai2144

试了一下，要把 openKeys 设置为 undefined ，然后才能配置，但是自动选中的功能就没了，需要慎重使用

## jiyingzhi

是因为使用了受控属性的原因吗

## chenshuai2144

嗯 ，受控了会覆盖了 defaultOpenKeys

## jiyingzhi

请问这个打算修复吗？受控组件应该是通过 openKeys 来设置初始值的，但是我设置了 openKeys 之后就导致点击菜单无法收起和展开了

## chenshuai2144

不是问题，设计就是这样的，你受控了自然要完全自己控制展开收起和选中。不可能一会受控一会不受控

openKeys 要和 onOpenChange 一起用，不能使用 layout 自己的逻辑了

## purgeyao

defaultOpenKeys 不生效 和楼上讲的一样 而且设置openKeys 后有的就不可以打开了 @chenshuai2144

## chenshuai2144

只有第一个渲染有用的

## jiyingzhi

受控的写法怎么在 umi-plugin-layout 里用

## calmchang

在menuProps里配置 openKeys 和 onOpenChange 来解决吧
我的菜单通过 menuDataRender 动态渲染的，用上面的方法解决的
