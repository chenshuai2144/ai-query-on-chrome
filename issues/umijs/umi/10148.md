# [Bug]patchClientRoutes实现动态路由后渲染组件时候没有渲染全局布局

`Need Reproduce`

## What happens?

```
// 运行时配置

// 全局初始化数据配置，用于 Layout 用户信息和权限初始化
// 更多信息见文档：https://next.umijs.org/docs/api/runtime-config#getinitialstate

import {RunTimeLayoutConfig} from "@@/plugin-layout/types";
import {IconMap} from "antd/lib/result";
import Right from "@/layouts/rightRender";
import React, {lazy} from "react";

import Loadable from 'react-loadable';
import rou from '../config/router'
import Home from './pages/Home'

let extraRoutes;
let newRoutes :[] = [];

const lazyLoad = (moduleName: string) => {
    const Module = Loadable({
        loader: ()=>import(`${moduleName}`),
        loading({error}) {
            if (error) {
                console.log(error);
                return <div>Error!</div>;
            } else {
                return <div>Loading...</div>;
            }
    }
    });

    console.log("加载完成")
    return <Module />;
};

const menuToRoute = (menu,parentName)=>{

    if(menu.component){
        let route={
            name:menu.name,
            path: menu.path,
            meta:{
                parentName: parentName
            },
            redirect: menu.redirect,
            element: lazyLoad("./pages/"+menu.component),
            layout: menu.layout?false:true,
        }
        return route;
    }

}
export const patchClientRoutes = ({routes}) => {
    extraRoutes = JSON.parse(sessionStorage.getItem("menuList") as string);

    rou.map(m=>{
        if(m.component){
            let  route = menuToRoute(m,null);
            newRoutes.push(route);
        }

    })

    if(extraRoutes){
        extraRoutes.forEach(menu =>{
            console.log(menu.children);
            if(menu.children){
                menu.children.map((m)=>{
                    let  route = menuToRoute(m,menu.name);
                    newRoutes.push(route);

                })
            }
        })

        Object.assign(routes,newRoutes);
        console.log(routes);
    }

};



//菜单转成路由


export async function getInitialState(): Promise<{ name: string }> {
  return { name: '尘落' };
}

export const layout :RunTimeLayoutConfig = ( initialState ) =>  {
  return {
      rightRender: ()=>{
          return <Right />
      },
    logo: 'https://img.alicdn.com/tfs/TB1YHEpwUT1gK0jSZFhXXaAtVXa-28-27.svg',
    menu: {
      locale: false,
        request: () => {
            let paths: any;
            paths = JSON.parse(sessionStorage.getItem('menuList') as string);

            if(paths){
                return paths.map((item: any) => ({
                    name: item.name,
                    icon: item.icon && IconMap[item.icon as string],
                    path: item.path,
                    routes: item.children,
                }));
            }
            return [];

        },
    },

      avatarProps:{
          src: '../public/images/7g.jpeg',
          title: '七妮妮',
          size: 'small',
      },

      layout:"mix" ,
      menuFooterRender:()=>{
          return "© 2021 Made with love";
      }
      ,
      route: { newRoutes }

  };
};
```

patchClientRoutes实现动态路由后渲染组件时候没有渲染全局布局
![image](https://user-images.githubusercontent.com/76896357/209425242-307ba58a-3ae9-4b2e-a822-7c9029deb67a.png)

## Mini Showcase Repository(REQUIRED)

https://github.com/echo-machile/-

## How To Reproduce

**Steps to reproduce the behavior:** 1. 2. 所有的布局消失，只剩下文件对应的组件

**Expected behavior**
应该出现AntdLayout布局

```

```

## Context

- **Umi Version**:"@umijs/max": "^4.0.39"
- **Node Version**:19
- **Platform**:Macos

## fz6m

这个仓库的代码复现不了，给一个真正能复现问题的最小复现看看。

## Qinsuyan

找到带有layout的路由：
const layoutRoute = routes.find(i => i.id === "ant-design-pro-layout")
往这个路由里面插入：
if(!layoutRoute.children){
layoutRoute.children = []
}
layoutRoute.children.push(myRoute)

向着星辰与深渊！
