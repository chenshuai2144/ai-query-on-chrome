# [Bug] 组件里使用useModel 在lexical编辑器里调用会出现TypeError: Cannot read properties of null (reading 'dispatcher')

`Need Reproduce`

自定义了个上传组件，里面使用了 max 的 useModel ，然后在lexical里使用上传组件 会报错
<img width="702" alt="截屏2023-01-27 15 19 01" src="https://user-images.githubusercontent.com/183884/215030241-3ce6221a-0586-49fc-a4a6-dfb708f6b0c6.png">

## WuJiY

这关闭的也太快了😂😂😂

## yijinc

我也碰到这样的问题，在app.tsx 使用 报错，在其它组件使用正常

## fz6m

`app.tsx` 里函数的运行时机更早，不在 react 组件内，无法使用 `useXXX` 的 hooks 。

## yijinc

>

app.tsx 我使用 React.useXXX 是没有问题的。 useModel 便报错。

那如何在app.jsx 使用 全局状态呢？ 现在有个 configProvider 需要在最外层使用，数据不能用 useModal 难道只能使用其它数据流了嘛

## fz6m

可以使用 [`valtio`](https://umijs.org/docs/max/valtio) ，支持在任意地方使用，或者把全局数据的操作和使用放到 layout 去处理。

## BurnhamZhang

> 可以使用 [`valtio`](https://umijs.org/docs/max/valtio) ，支持在任意地方使用，或者把全局数据的操作和使用放到 layout 去处理。

layout 里面使用useModel也报相同的错误

## fz6m

需要给一个最小复现。
