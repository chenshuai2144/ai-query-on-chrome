# Umi x ChatGPT（1）

## 任务

- 完善 Command 的 Prompt 内容，控制在 3800 TOKEN 以内，功能覆盖命令行、配置（基于 umi config 命令）、环境变量
- 添加常用语句的测试用例，直接调 OpenAI 做测试
- 处理 openai timeout 报错，明确提示是 timeout 类的错误（现在只给了网络错误，同时 timeout 感觉有点频繁）

## FAQ

### 如何跑起来？

启动 dev。

```bash
$ pnpm run copilot:dev
```

Bash 里加个 alias（可选）。

```bash
alias "umi?"=/path/to/copilot/bin/umi-copilot.js
```

Bash 里加 OPENAI_API_KEY 环境变量。

```bash
export OPENAI_API_KEY=xxx
```

然后找个空项目。

```bash
$ umi g page index
$ umi? start dev server with port 8888
```

如果你的命令行掉不通 openai 的 server？那可能需要先做下命令行翻墙。

参考：  
[https://umijs.org/docs/api/commands](https://umijs.org/docs/api/commands)  
[https://umijs.org/docs/guides/env-variables](https://umijs.org/docs/guides/env-variables)  
[https://umijs.org/docs/api/config](https://umijs.org/docs/api/config)

## xyuanbuilds

#10853

- 目前命令行代理的方式无法获取请求结果，适配该代理方式
- 处理 openai timeout 报错，明确提示是 timeout 类的错误，并推荐传递 proxyUrl 用代理服务器访问
