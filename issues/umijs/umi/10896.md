# [Feature Request] umi4动态加载glb文件，经常失败

## Background

umi4动态加载glb文件，经常失败

umi4 里，动态加载glb文件，经常加载失败，文件8m，umi dev模式下，只能加载到1.7m，

![a79d8391ba13b551d7429f200b3400a](https://user-images.githubusercontent.com/5111701/229670529-3249c6b4-75b9-4ba9-848c-442380f0849b.png)
![4d4e70864525961a1f67ad7c18d3176](https://user-images.githubusercontent.com/5111701/229670554-ed19ae61-1676-41e6-8322-bd4e8878e8c4.png)

而且 文件加载总进度 total 值一直是0，
![image](https://user-images.githubusercontent.com/5111701/229670656-305c4aac-1783-41d3-8658-66cd7aa7b1ed.png)
![image](https://user-images.githubusercontent.com/5111701/229670741-42886060-c4db-4012-9caa-e38e2121fcd9.png)

## Proposal

Describe the solution you'd like, better to provide some pseudo code.

## Additional context

Add any other context or screenshots about the feature request here.

## pxim

我用了这个帖子里的解决方案，https://www.cnblogs.com/kevinN/p/16600312.html ，还是不行

## fz6m

[怎么自定义 loader](https://umijs.org/docs/introduce/faq#%E6%80%8E%E4%B9%88%E8%87%AA%E5%AE%9A%E4%B9%89-loader)

## pxim

> [怎么自定义 loader](https://umijs.org/docs/introduce/faq#%E6%80%8E%E4%B9%88%E8%87%AA%E5%AE%9A%E4%B9%89-loader)

配置，还不能解决问题，应该不是这个原因

## pxim

如果不是为了mpa，真不想升级4，一堆bug

## fz6m

需要给一个最小复现

## pxim

> 需要给一个最小复现

这个是复现仓库 https://github.com/pxim/umi4-mpa-bug.git

这个bug，已经极度影响开发了

dev模式下，打开 https://localhost:8000/webxr-demo.html 这个页面后，kira.glb，default.glb 模型，偶发性，经常性 的加载失败（如果没出bug，多f5刷新几次这个页面，就有bug了）
![image](https://user-images.githubusercontent.com/5111701/234189396-453bfe91-5931-4489-a339-0549f62815aa.png)

build模式下，永远是正常，正确的，所以必定是dev有bug
http://127.0.0.1:5500/build/webxr-demo/index.html
![image](https://user-images.githubusercontent.com/5111701/234189686-e65d0892-79c0-43e1-be94-8a16168c4b36.png)

## fz6m

应该是已知的一个问题，参考 [`https`](https://umijs.org/docs/api/config#https) 关闭 http2 解决。

## pxim

> 应该是已知的一个问题，参考 [`https`](https://umijs.org/docs/api/config#https) 关闭 http2 解决。

升级umi到最新版本，然后关了http2，测了下，好像是没这个问题了，等我用一段时间再看看
谢谢了
