# ä¸ºä»€ä¹ˆ initialState.settings.title ä¼šä¸¢å¤±ï¼Ÿ

`Need Reproduce`

æˆ‘å¸Œæœ›å¯ä»¥é€šè¿‡æœåŠ¡ç«¯è®¾ç½®ç«™ç‚¹åç§°
åœ¨ getInitalState æ–¹æ³•é‡Œ è¿”å›äº†settings
å¹¶æ ¹æ®æœåŠ¡ç«¯é…ç½® ä¿®æ”¹äº† settings ä¸­çš„ ä¸»é¢˜é…ç½® ç­‰ runtimeConfig ä¿¡æ¯

AntdPro ä»£ç ç¤ºä¾‹
![image](https://user-images.githubusercontent.com/15613121/233819934-62a340f1-23d2-46c9-a994-919a504d5a98.png)

åœ¨ app.tsx ä¸­å¦‚ä¸‹ä½ç½® è¾“å‡º initialState

```
// ProLayout æ”¯æŒçš„api https://procomponents.ant.design/components/layout
export const layout: RunTimeLayoutConfig = ({ initialState, setInitialState }) => {
  console.log('layout_initialState: ', initialState);
  return {
    //å¤„ç†title ä¸¢å¤±é—®é¢˜
    title: initialState.settings.serverTitle,
```

è¾“å‡ºäº†5æ¬¡ï¼Œæœ€åä¸€æ¬¡è¾“å‡º çš„æ—¶å€™ titleå±æ€§æ²¡äº†~~ è¯·é—®è¿™æ˜¯ä»€ä¹ˆåŸå› ï¼Ÿæˆ‘åœ¨æºç é‡Œé¢æ‰¾ä¹Ÿæ²¡æ‰¾åˆ°æ€ä¹ˆå›äº‹~~

![image](https://user-images.githubusercontent.com/15613121/233820045-3b943f89-c16f-4818-a708-0453ffc3fb34.png)

æœ€å°å¤ç°ï¼š https://github.com/ant-design/ant-design-pro/compare/master...hyzx86:ant-design-pro:titleLost

## fz6m

ç»™ä¸€ä¸ªä¼šä¸¢å¤±çš„æœ€å°å¤ç°çœ‹çœ‹ã€‚

## hyzx86

å¤ç°æˆ‘åœ¨åšã€‚ã€‚ä½†æ˜¯ç¼–è¯‘ä¸è¿‡å»-- åœ¨ antdPro é¡¹ç›®ä¸Šåšçš„

```ts
async function getSettings(): Promise<Partial<LayoutSettings>> {
  return {
    ...defaultSettings,
    title: "å¼ ä¸‰æå››ç‹éº»å­",
  } as Partial<LayoutSettings>;
}

/**
 * @see  https://umijs.org/zh-CN/plugins/plugin-initial-state
 * */
export async function getInitialState(): Promise<{
  settings?: Partial<LayoutSettings>;
  currentUser?: API.CurrentUser;
  loading?: boolean;
  fetchUserInfo?: () => Promise<API.CurrentUser | undefined>;
}> {
  const fetchUserInfo = async () => {
    try {
      const msg = await queryCurrentUser({
        skipErrorHandler: true,
      });
      return msg.data;
    } catch (error) {
      history.push(loginPath);
    }
    return undefined;
  };
  // å¦‚æœä¸æ˜¯ç™»å½•é¡µé¢ï¼Œæ‰§è¡Œ
  const { location } = history;
  if (location.pathname !== loginPath) {
    const currentUser = await fetchUserInfo();
    return {
      fetchUserInfo,
      currentUser,
      settings: await getSettings(),
    };
  }
  return {
    fetchUserInfo,
    settings: await getSettings(),
  };
}
```

## hyzx86

æœ€å°å¤ç°ï¼š https://github.com/ant-design/ant-design-pro/compare/master...hyzx86:ant-design-pro:titleLost

## fz6m

```tsx
// app.tsx

    childrenRender: (children) => {
      // if (initialState?.loading) return <PageLoading />;
      return (
        <>
          {children}
          {isDev && (
            <SettingDrawer
              disableUrlParams
              enableDarkTheme
              settings={initialState?.settings}
              onSettingChange={(settings) => {
                // ğŸŸ¡ æ·»åŠ å®Œ title ä¹‹åï¼Œsettings å˜äº†ï¼Œè§¦å‘äº† on change äº‹ä»¶ï¼Œæ¥ä¸‹æ–‡
                setInitialState((preInitialState) => ({
                  ...preInitialState,
                  settings,
                }));
              }}
            />
          )}
        </>
      );
    },
```

è¿™é‡ŒæŠŠ `title` æ¸…äº†ï¼šhttps://github.com/ant-design/pro-components/blob/b141035a6c7bd6cf83561b5d32f8e078a1f5675d/packages/layout/src/components/SettingDrawer/index.tsx#L130

## hyzx86

æ„Ÿè°¢ï¼
