# 如何启用全局加载[Bug] say something

#### 在第一次获取用户信息时，如果请求较慢会导致页面白屏，但我不知道如何开启全局加载，当在getInitialState中获取用户信息后，关闭全局加载

![image](https://github.com/umijs/umi/assets/28668830/99561a39-bf7f-4ad5-9a39-e569a3e2491d)

下面是我的app.tsx代码

```

/**
 * 初始化数据
 * @returns
 */
export async function getInitialState(): Promise<{
  currentUser?: CurrentUserResponse;
  fetchUserInfo: () => Promise<CurrentUserResponse | null>;
  loading?: boolean;
}> {
  const fetchUserInfo: () => Promise<CurrentUserResponse | null> = async () => {
    try {
      const { data, status } = await getCurrentUser();
      if (status === 200) {
        return data.data;
      }
    } catch (error) {
      history.push('/login');
      return null;
    }
    return null;
  };

  const data = await fetchUserInfo();
  const result = { fetchUserInfo, loading: true };
  return data ? { ...result, currentUser: data } : result;
}

export const layout = () => {
  return {
    logo,
    menu: {
      locale: false,
    },
    siderWidth: 150,
    layout: 'mix',
    title: '元器件信息系统管理平台',
    rightRender: () => {
      return <Avatar />;
    },
  };
};
```

## Context

- **Umi Version**:4.0.66
- **Node Version**:18.15.0
- **Platform**:macos13

  ## fz6m

  全局加载组件在 `src/loading.tsx` 编写，`getInitialState` 执行完毕后会自动关闭加载。

  ## xyovo

  > loading

谢谢您的回答~，但`src/loading.tsx`对我来说没有效果

## MistFrontendDeveloper

> > loading
>
> 谢谢您的回答~，但`src/loading.tsx`对我来说没有效果

我也是！

## MistFrontendDeveloper

> > loading
>
> 谢谢您的回答~，但`src/loading.tsx`对我来说没有效果

解决全局加载时配置 src/loading.tsx
解决 getInitialState 白屏时使用 config.ts 的 initialState.loading

```js
  initialState: {
    loading: '@/common/components/Loading',
  },
```

## xyovo

>

谢谢，成功解决了~
