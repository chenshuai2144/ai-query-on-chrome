# [Bug] 使用Umi提供的接口生成能力,文档 json 数据没有 Schemas 时抛出异常

辛苦了!
我是第一次使用你们的 Umi 产品,我创建了一个很简单的后端项目,项目中就只有一个测试接口,该接口不存在任何 Model 参数.在使用 umi 提供的文档生成功能的时候抛出一个异常,具体可查看下图的信息:

<img width="1454" alt="image" src="https://github.com/umijs/umi/assets/50982977/97b3c667-a0a0-4a51-9a66-4f8d3e352b9c">

我后端就这有这么一个接口,他没有任何 Model 参数

```java
  @Operation(summary = "测试", description = "需要登录后访问")
  @RequestMapping("/test")
  public String test(@Parameter(name = "name", description = "测试") String name) {
      return "hello world";
  }
```

当我尝试给接口添加上一个 Model,它可以正常工作:

```java
// model
@Schema(name = "UserLoginRequest", title = "用户登录")
@Data
public class UserLoginRequest implements Serializable {

    @Serial
    private static final long serialVersionUID = 7716678547495664955L;

    /**
     * 账号
     */
    @Schema(title = "账号", name = "userAccount")
    private String userAccount;

    /**
     * 密码
     */
    @Schema(title = "密码", name = "userPassword")
    private String userPassword;

}

// api
@Operation(summary = "测试", description = "需要登录后访问")
@RequestMapping("/test")
public String test(UserLoginRequest request) {
    return "hello world";
}
```

<img width="583" alt="image" src="https://github.com/umijs/umi/assets/50982977/f2a164ca-cfa4-49eb-b845-fa24fe83aa72">
<img width="1792" alt="image" src="https://github.com/umijs/umi/assets/50982977/6a55d484-72c0-493d-9516-74345992df49">

造成这个问题的代码在 `node_modules/.pnpm/@umijs+openapi@1.8.2/node_modules/@umijs/openapi/dist/serviceGenerator.js:540` ,没有对 `components.schemas` 进行判断导致的:

```js
    getInterfaceTP() {
        const { components } = this.openAPIData;
        const data = components &&
            // 这儿
            [components.schemas].map((defines) => {
                ......
            });
        // 强行替换掉请求参数params的类型，生成方法对应的 xxxxParams 类型
        ....
        // ---- 生成 xxxparams 类型 end---------
        return data && data.reduce((p, c) => p && c && p.concat(c), [])
            // 排序下，要不每次git都乱了
            .sort((a, b) => a.typeName.localeCompare(b.typeName));
    }
```

## fz6m

这个是 ant pro 里的 openai 插件问题，到 [ant-pro](https://github.com/ant-design/ant-design-pro) 反馈吧。
