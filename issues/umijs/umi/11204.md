# [Bug] umi创建新项目，build后发现没有tree-shaking

复现步骤：
`# yarn create umi` 创建新项目，版本目前最新，4.0.69

```ts
// 新增 src/utils.ts
export function aaa(s: string) {
  return s + "aabbcc";
}

export function bbb(s: string) {
  return s + "ddeeff";
}
```

```ts
// 修改 src/pages/index.tsx
import { aaa } from "../utils";

export default function HomePage() {
  aaa('c') // 主要是多了这一行
  ...
  return ()
}
```

```shell
yarn build
grep ddeeff dist/p__index.async.js
```

发现有bbb函数的代码`ddeeff`：

```js
"use strict";
(self.webpackChunk = self.webpackChunk || []).push([
  [866],
  {
    2772: function (f, o, r) {
      r.r(o),
        r.d(o, {
          default: function () {
            return l;
          },
        });
      var c = r.p + "static/yay.7d162f31.jpg";
      function i(s) {
        return s + "aabbcc";
      }
      function p(s) {
        return s + "ddeeff";
      }
      var t = r(5893);
      function l() {
        return (
          i("c"),
          (0, t.jsxs)("div", {
            children: [
              (0, t.jsx)("h2", { children: "Yay! Welcome to umi!" }),
              (0, t.jsx)("p", {
                children: (0, t.jsx)("img", { src: c, width: "388" }),
              }),
              (0, t.jsxs)("p", {
                children: [
                  "To get started, edit ",
                  (0, t.jsx)("code", { children: "pages/index.tsx" }),
                  " and save to reload.",
                ],
              }),
            ],
          })
        );
      }
    },
    5251: function (f, o, r) {
      var c;
      var i = r(7294),
        p = Symbol.for("react.element"),
        t = Symbol.for("react.fragment"),
        l = Object.prototype.hasOwnProperty,
        s =
          i.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED
            .ReactCurrentOwner,
        m = { key: !0, ref: !0, __self: !0, __source: !0 };
      function y(u, e, _) {
        var n,
          d = {},
          a = null,
          h = null;
        _ !== void 0 && (a = "" + _),
          e.key !== void 0 && (a = "" + e.key),
          e.ref !== void 0 && (h = e.ref);
        for (n in e) l.call(e, n) && !m.hasOwnProperty(n) && (d[n] = e[n]);
        if (u && u.defaultProps)
          for (n in ((e = u.defaultProps), e)) d[n] === void 0 && (d[n] = e[n]);
        return {
          $$typeof: p,
          type: u,
          key: a,
          ref: h,
          props: d,
          _owner: s.current,
        };
      }
      (c = t), (o.jsx = y), (o.jsxs = y);
    },
    5893: function (f, o, r) {
      f.exports = r(5251);
    },
  },
]);
```

============================
==== 以下为修改前，可忽略========

问题如题，umi 版本目前最新 （4.0.69），复现步骤：

`# yarn create umi` 创建新项目

```ts
// src/utils.ts
export function aaa(s: string) {
  return s + "aabbcc";
}

export function bbb(s: string) {
  return s + "ddeeff";
}
```

```ts
// src/cnt.ts
import { aaa } from "./utils";

aaa("c");
```

```ts
// .umirc.ts
...
  chainWebpack(memo, args) {
    memo.entry("cnt").add("./src/cnt.ts");
  }
...
```

`# yarn build`

```js
// dist/cnt.js
(function () {
  "use strict";
  var t = {};
  function n(c) {
    return c + "aabbcc";
  }
  function a(c) {
    return c + "ddeeff";
  }
  n("c");
})();
```

build之后的cnt.js文件里还是有bbb函数的代码`ddeeff`，并没有被“摇”掉

## fz6m

目前不支持自定义 entry 。
