# [Bug] 配置了runtimePublicPath: {}，异步加载的文件路径不是window.publicPath

  <!--
感谢您向我们反馈问题，为了高效的解决问题，我们期望你能提供以下信息：
-->

## What happens?

<!-- A clear and concise description of what the bug is. -->
<!-- 清晰的描述下遇到的问题。-->

Config.ts文件 配置了生产环境下runtimePublicPath: {},项目打包使用默认的异步加载，打包部署后只有index.html 文件引用的文件调用路径正常，前缀为 window.publicPath，异步加载的静态文件请求路径没有更新为window.publicPath，使用的依然是window.location 的地址

## Mini Showcase Repository(REQUIRED)

<!-- 为节约大家的时间，无复现步骤的 ISUE 会被关闭，提供之后再 REOPEN -->
<!-- YOUR_REPOSITORY_URL on github or stackbliz -->

![e24f77d573bfd6f894a372dc6c1b16c](https://github.com/umijs/umi/assets/37927327/d20629b0-0663-44e9-b885-39fb3f34438a)

举例如下：
打印的window.publicPath：https://baidu.com/
js的请求路径：https://baidu.com/umi.js
_.async.js的请求路径为：https://**\*\***.com/_.async.js (**\*\***为项目环境host)

## How To Reproduce

<!-- 请提供复现链接/步骤，错误日志以及相关配置 -->

config.ts文件

`import { defineConfig } from 'umi';
export default defineConfig({
  publicPath:'https://baidu.com/',
  runtimePublicPath: {}
})
`

global.tsx 文件

`if(预发){
window.publicPath=‘https://dev.baidu.com/’
}else if(正式){
window.publicPath=‘https://baidu.com/’
 }
`

## Context

- **Umi Version**:4.0.71
- **Node Version**:14.15.0
- **Platform**:

  ## fz6m

  `global.ts` 的时机已经是 webpack 启动代码之后，umi 应用启动之前了，需要更早的时机全局设定 `publicPath` ，放在 `headScripts` 里：

```ts
  runtimePublicPath: {},
  headScripts: [
    'window.publicPath = "http://domain.com/"',
  ]
```
