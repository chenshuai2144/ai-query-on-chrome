# umi v4.0.81开启MPA后使用request报TypeError: Cannot read properties of null (reading 'applyPlugins')错误

`Need Reproduce`

<!--
感谢您向我们反馈问题，为了高效的解决问题，我们期望你能提供以下信息：
-->

## What happens?

umi v4.0.81开启MPA后使用request报TypeError: Cannot read properties of null (reading 'applyPlugins')错误

<!-- A clear and concise description of what the bug is. -->
<!-- 清晰的描述下遇到的问题。-->

## Mini Showcase Repository(REQUIRED)

// import { request, useRequest } from 'umi';
import {request } from '@umijs/max';
import { message } from 'antd';
import { useEffect } from 'react';

import styles from './index.less';

const Share = () => {
const getTicketDetail = () => {
let token = '';

        try {
            const url = new URL(location.href);
            const searchParams = url?.searchParams;
            token = searchParams?.get('token') || '';
            if (!token) {
                message.error('分享链接错误，请重新分享');
            }
        } catch (e) {}

        request(`/cs/ts/api/ticket_share/detail?token=${token}`);
    };

    useEffect(() => {
        getTicketDetail();
    }, []);

    return (
        <div className={styles['page']}>
        </div>
    );

};

export default Share;

> Please provide a [minimal reproduction](https://stackoverflow.com/help/minimal-reproducible-example) then upload to your GitHub. 请提供 [最小重现](https://stackoverflow.com/help/minimal-reproducible-example)，并上传到你的 GitHub 仓库

<!-- 为节约大家的时间，无复现步骤的 ISSUE 会被关闭，提供之后再 REOPEN -->
<!-- YOUR_REPOSITORY_URL on github or stackbliz -->

## How To Reproduce

**Steps to reproduce the behavior:** 1. 2.

**Expected behavior** 1. 2.
通过npx create-umi@latest命令新创建一个项目，.umirc.ts增加两个配置项，request: {},和 mpa: {
entry: {
share: { title: '工单详情' },
},
},
pages目录下增加share目录，内部代码使用import {request, useRequest } from '@umijs/max';通过request发送请求，即报上面的错误
mf-dep\_**\_vendor.4fc148fa.js:240755 TypeError: Cannot read properties of null (reading 'applyPlugins')
at getConfig (request.ts:135:1)
at getRequestInstance (request.ts:145:1)
at request (request.ts:188:1)
at getTicketDetail (src_pages_share_index_tsx.async.js:536:49)
at mf-dep\_\_**vendor.4fc148fa.js:4493:27
at new Promise (<anonymous>)
at promiseService (mf-dep\_**\_vendor.4fc148fa.js:4492:16)
at Fetch.service (mf-dep\_\_**vendor.4fc148fa.js:5714:20)
at Fetch.\_run (mf-dep\_**\_vendor.4fc148fa.js:4708:25)
at Fetch.run (mf-dep\_\_**vendor.4fc148fa.js:4795:22)
at mf-dep\_\_\_\_vendor.4fc148fa.js:4998:29
at src_pages_share_index_tsx.async.js:545:5

<!-- 请提供复现链接/步骤，错误日志以及相关配置 -->

## Context

- **Umi Version**:4.0.81
- **Node Version**:v16.20.1
- **Platform**:macos

## fz6m

给一个最小复现看看
