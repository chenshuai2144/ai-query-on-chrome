# antd proå‡çº§åˆ°umi3.0åæ‰“åŒ…å¤±è´¥/ä½“ç§¯è¿‡å¤§

ä¸å¼€å¯æŒ‰éœ€åŠ è½½çš„è¯ï¼Œç›´æ¥æ‰“åŒ…ä¼šæç¤ºå†…å­˜ä¸è¶³
Ineffective mark-compacts near heap limit Allocation failed - JavaScript heap out of memory
å¼€å¯`dynamicImport: {}`åï¼Œå‡çº§å‰æ‰“åŒ…å‡ºçš„æ–‡ä»¶7MBï¼Œ3.0åæ‰“åŒ…å‡ºçš„æ–‡ä»¶29MBï¼Œç¿»äº†ä¸‹æ–‡æ¡£`dynamicImport`çš„é…ç½®ä¼¼ä¹ä¹Ÿå–æ¶ˆäº†ï¼Œè¯·é—®è¿™ä¸ªæ‰“åŒ…ä½“ç§¯æœ‰åŠæ³•æ§åˆ¶å›å»å—

- **Umi ç‰ˆæœ¬**ï¼š3.0.18
- **Node ç‰ˆæœ¬**ï¼š10.15.3
- **æ“ä½œç³»ç»Ÿ**ï¼šwindows

  ## whatthehan

  æˆ‘ä¹Ÿæ˜¯...CICDç›´æ¥æŒ‚äº†...
  ![æˆªå±2020-04-08 ä¸‹åˆ4 50 25](https://user-images.githubusercontent.com/29910482/78764434-1cf5c180-79b9-11ea-9762-f4a0fd0934e6.png)

  ## phoema

  æˆ‘ä¹ŸæŒ‚æ‰äº†

FATAL ERROR: Ineffective mark-compacts near heap limit Allocation failed - JavaScript heap out of memory

æˆ‘å‘ç°ä¹‹å‰é…ç½®çš„
dynamicImport: {
loadingComponent: './components/PageLoading/index',
webpackChunkName: true,
level: 3,
},

        å±æ€§webpackChunkName: true,
        level: 3,

åœ¨æ–°ç‰ˆä¸­æ²¡æœ‰å±æ€§å®šä¹‰äº†ã€‚

## linfengluo

åŒæ ·ï¼Œç›´æ¥æŒ‚äº†

**FATAL ERROR: Ineffective mark-compacts near heap limit Allocation failed - JavaScript heap out of memory**

## Dddota

å…·ä½“æ˜¯terserPluginè¿™ä¸ªæ’ä»¶è¿™é‡ŒæŠ¥å†…å­˜æº¢å‡º
æˆ‘ç°åœ¨çš„åšæ³•æ˜¯ï¼Œå¸è½½äº†terser å’Œ terser-webpack-plugin
npm uninstall terser å’Œnpm uninstall terser-webpack-plugin
ç„¶åä¿®æ”¹webpack å’Œumi å»é™¤äº†å¯¹terser-webpack-plugin çš„ä¾èµ–
å…·ä½“ä¿®æ”¹çš„åœ°æ–¹ï¼š
/feit/tools/jenkins/workspace/hcip-web-develop/node_modules/webpack/lib/WebpackOptionsDefaulter.js
vi /feit/tools/jenkins/workspace/hcip-web-develop/node_modules/@umijs/bundler-webpack/lib/getConfig/getConfig.js
vi /feit/tools/jenkins/workspace/hcip-web-develop/node_modules/webpack/package.json
æœç´¢å…³é”®å­— terser ï¼Œç›¸å…³çš„ä»£ç è¡Œï¼Œå…¨éƒ¨æ³¨é‡Šæ‰äº†

## zhangyu1818

æˆ‘ä¹Ÿé‡åˆ°è¿™ä¸ªé—®é¢˜äº†ï¼Œæœ¬åœ°æ²¡äº‹ï¼Œåœ¨æœåŠ¡å™¨æ‰“åŒ…å°±å‡ºé—®é¢˜äº†ï¼ŒæœåŠ¡å™¨4gå†…å­˜ä¸å¤Ÿå—ï¼Œè®¾ç½®äº†--max_old_space_size=4096å¥½åƒä¹Ÿæ²¡æœ‰ç”¨orz

## yzStrive

@xiaohuoni è¿™ä¸ªissueå…³é—­äº†æœ‰è§£å†³æ–¹æ¡ˆå— æˆ‘ä»¬è¿™è¾¹ä¹Ÿå‡ºç°è¿™ä¸ªé—®é¢˜äº† æœåŠ¡å™¨ä¸Šå†…å­˜æº¢å‡ºäº†

## xiaohuoni

@yzStrive æˆ‘è§‰å¾—æœåŠ¡å™¨æœ¬èº«å†…å­˜å°±å°çš„æƒ…å†µï¼Œå› ä¸ºæˆ‘ä»¬çš„æ˜¯æ­£å¸¸çš„ï¼Œå¦‚æœè¿˜æœ‰å…¶ä»–ç–‘é—®ï¼Œå¯ä»¥å» pro é‚£è¾¹æäº¤é—®é¢˜ã€‚

## zhangyu1818

æˆ‘ä¹‹å‰4gå†…å­˜ä¸å¤Ÿç”¨ï¼Œç°åœ¨æ¢äº†ä¸ª48gçš„æ‰“åŒ…2ä¸ªé¡¹ç›®éƒ½æ²¡é—®é¢˜ğŸ˜‚

## phoema

æˆ‘ç«Ÿæ— è¨€ä»¥å¯¹

> @yzStrive æˆ‘è§‰å¾—æœåŠ¡å™¨æœ¬èº«å†…å­˜å°±å°çš„æƒ…å†µï¼Œå› ä¸ºæˆ‘ä»¬çš„æ˜¯æ­£å¸¸çš„ï¼Œå¦‚æœè¿˜æœ‰å…¶ä»–ç–‘é—®ï¼Œå¯ä»¥å» pro é‚£è¾¹æäº¤é—®é¢˜ã€‚

## xiaohuoni

æˆ‘åªæ˜¯çŒœçš„ï¼Œå¦‚æœä½ å¯ä»¥å®šä½é—®é¢˜çš„è¯ï¼Œå€’æ˜¯å¯ä»¥è¿›ä¸€æ­¥çš„è·Ÿè¿›ã€‚ä»ç°åœ¨çš„ä¿¡æ¯ï¼Œçœ‹ä¸å‡ºæ¥ä¸ºå•¥ã€‚ï¼ˆæ‚è„¸ï¼‰

## Mh2336393

æˆ‘ä¹Ÿæ˜¯åŒæ ·å¾—é—®é¢˜ æœ‰è§£å†³æ–¹æ¡ˆæ²¡~å‘¢å•Šå¾—

## phoema

> æˆ‘ä¹Ÿæ˜¯åŒæ ·å¾—é—®é¢˜ æœ‰è§£å†³æ–¹æ¡ˆæ²¡~å‘¢å•Šå¾—

å»ºè®®å¼€æ–°Issueå•Šï¼Œè¿™ä¸ªè¢«å…³é—­äº†ï¼Œè™½ç„¶æˆ‘ä¹Ÿæ²¡è§£å†³é—®é¢˜ã€‚

## Mh2336393

umi build å‰é¢å¯ä»¥åŠ  --max-old-space-size=4096 ä¸è¿‡æˆ‘ä»¬æœåŠ¡å™¨å†…å­˜åªæœ‰1Gå¯ç”¨ ä¸çŸ¥é“å¥½ä¸å¥½ä½¿ æ˜å„¿è®©æµ‹è¯•è¯•ä¸€ä¸‹

## zhoushaobo1015

è¿™ä¸ªé—®é¢˜çš„æœ¬è´¨å…¶å®æ˜¯é¡¹ç›®è¿‡å¤§å¯¼è‡´çš„ï¼Œä½†ä¹Ÿæ˜¯æ²¡æœ‰åŠæ³•çš„ï¼Œè§£å†³æ–¹å¼

1. å°†dynamicImportæ³¨é‡Š
2. å¼€å¯dynamicImportçš„åŒæ—¶ä¹Ÿè¦å¯ç”¨chainWebpackåšè·¯ç”±åˆ‡ç‰‡
   æ¨èç¬¬2ç§è·¯ç”±ç¢ç‰‡è¯å¯¹é¡¹ç›®æ˜¯ä¸€ä¸ªå¾ˆå¤§çš„ä¼˜åŒ–
   å‚è€ƒåœ°å€: https://mp.csdn.net/mp_blog/creation/editor/107906243

## phoema

> æ‚¨è¿™ä¸ªç½‘å€æ— æ³•è·³è½¬åˆ°è¯¦æƒ…é¡µé¢

## sinianzhiren

https://blog.csdn.net/weixin_40228604/article/details/107906243 æ–‡ç« åœ°å€
