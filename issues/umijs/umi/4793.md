# How to use PWA on umi 3.0

## Requirements

- Node.js >= 10.15.1
- npm >= 6.4.1
- Umi >= 3.0.0

## Step 1: Install the necessary dependencies

```bash
npm install workbox-webpack-plugin
```

## Step 2: Configure the PWA in `umirc.js`

```javascript
import { InjectManifest } from "workbox-webpack-plugin";

export default {
  // ...
  copy: ["/pwa/${manifestName}"],
  links: [
    {
      rel: "manifest",
      href: `/console/${manifestName}`,
    },
  ],
  chainWebpack: (config) => {
    config.plugin("workbox").use(InjectManifest, [
      {
        swSrc: "./pwa/service-worker.js",
        swDest: "sw.js",
        exclude: [/\.map$/, /favicon\.ico$/, /^manifest.*\.js?$/],
      },
    ]);
  },
  // ...
};
```

## Step 3: Create the service worker file

```javascript
// register-service-worker.js
import { register } from "register-service-worker";

function registerServiceWorker() {
  if (process.env.NODE_ENV === "production") {
    register("/console/sw.js", {
      updated: () => {
        console.log("Service worker updated");
      },
      offline: () => {
        console.log("Service worker offline");
      },
    });
  }
}

registerServiceWorker();
```

## Step 4: Add the service worker to your app

```javascript
// global.js
import "./register-service-worker";
```

## Step 5: Verify the PWA

- Open your app in a browser.
- Check the browser's developer tools to see if the service worker is registered and active.
- Check the service worker's console for any error messages.
- Check the service worker's logs for any updates or offline events.

## Conclusion

With these steps, you should be able to use PWA on your Umi 3.0 app. If you encounter any issues, feel free to ask for help in the comments.
