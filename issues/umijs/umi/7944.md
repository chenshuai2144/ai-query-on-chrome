# [Bug]build后可能导致CSS样式失效（start时是正常的）

## What happens?

假设有如下CSS代码:

```css
.grayscale-1 {
  --tw-grayscale: grayscale(100%);
  filter: var(--tw-grayscale);
}

.grayscale-2 {
  --tw-xxx:  ;
  --tw-grayscale: grayscale(100%);
  filter: var(--tw-xxx) var(--tw-grayscale);
}
```

开发（npm run start）时，以上两个class`grayscale-1`和`grayscale-2`均生效，但是构建部署后只有`grayscale-1`会生效，`grayscale-2`中由于变量`--tw-xxx`是空值导致整个`filter`样式不生效。
如图所示: ![示例](https://github.com/laeni/issues-umi-build-css/blob/master/doc/Snipaste.png?raw=true)

## Mini Showcase Repository(REQUIRED)

<https://github.com/laeni/issues-umi-build-css>

## How To Reproduce

直接`npm run start`和`npm run build`即可，预期显示效果相同，但实际上不同。

## Context

- **Umi Version**: 3.5.21
- **Node Version**: 16.14.0
- **Platform**: Linux and Windows

  ## laeni

  ![image](https://user-images.githubusercontent.com/37047577/163783946-cf928f00-dc47-4073-9796-642b27381c87.png)
  原因是构建后，这种没有值的css会被删除，而start时并没有删除。

  ## zhjgh

  我也遇到这个问题，Button组件添加danger属性，本地跑是正常的，打包发布到线上就有问题了

  ## fz6m

  可以用 umi4 ，一键启动 tailwind 。

https://umijs.org/docs/guides/styling#%E4%BD%BF%E7%94%A8-tailwindcss

## laeni

> 可以用 umi4 ，一键启动 tailwind 。
>
> https://umijs.org/docs/guides/styling#%E4%BD%BF%E7%94%A8-tailwindcss

没注意，都发展到4版本了。
不过这个问题并不是 tailwind 的问题，在较新的3版本中，就算是自己写的css，只要有空变量就会出现这个问题。

## laeni

umi4已经没有该问题，如果无法升级umi4的情况，可以将受影响的css独立出来单独引入可以解决。

## cdx111

> umi4已经没有该问题，如果无法升级umi4的情况，可以将受影响的css独立出来单独引入可以解决。单独引入也是没有效果的，问题出现在config中的cssnano，discardEmpty sets to false就可以

## cdx111

> 我也遇到这个问题，Button组件添加danger属性，本地跑是正常的，打包发布到线上就有问题了
> 问题出现在config中的cssnano，discardEmpty sets to false就可以
