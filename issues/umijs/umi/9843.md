# [Bug] yarn test Error

<!--
æ„Ÿè°¢æ‚¨å‘æˆ‘ä»¬åé¦ˆé—®é¢˜ï¼Œä¸ºäº†é«˜æ•ˆçš„è§£å†³é—®é¢˜ï¼Œæˆ‘ä»¬æœŸæœ›ä½ èƒ½æä¾›ä»¥ä¸‹ä¿¡æ¯ï¼š
-->

## What happens?

æ‰§è¡Œ test Â æŠ¥é”™

```base
yarn run v1.22.10
warning ../../package.json: No license field
$ jest
Error: Jest: Failed to parse the TypeScript config file /Users/gxz/Desktop/umi4test/jest.config.ts
  AssertionError [ERR_ASSERTION]: Invalid config keys: antd, access, model, initialState, request, layout
    at readConfigFileAndSetRootDir (/Users/gxz/Desktop/umi4test/node_modules/jest-config/build/readConfigFileAndSetRootDir.js:136:13)
    at processTicksAndRejections (node:internal/process/task_queues:96:5)
    at async readConfig (/Users/gxz/Desktop/umi4test/node_modules/jest-config/build/index.js:233:18)
    at async readConfigs (/Users/gxz/Desktop/umi4test/node_modules/jest-config/build/index.js:420:26)
    at async runCLI (/Users/gxz/Desktop/umi4test/node_modules/@jest/core/build/cli/index.js:132:59)
    at async Object.run (/Users/gxz/Desktop/umi4test/node_modules/jest-cli/build/cli/index.js:155:37)
error Command failed with exit code 1.
info Visit https://yarnpkg.com/en/docs/cli/run for documentation about this command.
```

<!-- A clear and concise description of what the bug is. -->
<!-- æ¸…æ™°çš„æè¿°ä¸‹é‡åˆ°çš„é—®é¢˜ã€‚-->

## Mini Showcase Repository(REQUIRED)

> Please provide a [minimal reproduction](https://stackoverflow.com/help/minimal-reproducible-example) then upload to your GitHub. è¯·æä¾› [æœ€å°é‡ç°](https://stackoverflow.com/help/minimal-reproducible-example)ï¼Œå¹¶ä¸Šä¼ åˆ°ä½ çš„ GitHub ä»“åº“

<!-- ä¸ºèŠ‚çº¦å¤§å®¶çš„æ—¶é—´ï¼Œæ— å¤ç°æ­¥éª¤çš„ ISSUE ä¼šè¢«å…³é—­ï¼Œæä¾›ä¹‹åå† REOPEN -->
<!-- YOUR_REPOSITORY_URL on github or stackbliz -->

[review code](https://github.com/f2egxz/umi4test.git)

## How To Reproduce

ä¸‹è½½ä»£ç ï¼Œ

```base
yarn
yarn test
```

**Steps to reproduce the behavior:**

1.  æŒ‰ç…§[å®˜æ–¹æ–‡æ¡£](https://umijs.org/docs/tutorials/getting-started) åˆå§‹åŒ–æ–°é¡¹ç›®

```base
âœ  umi4test yarn create umi
yarn create v1.22.10
warning package.json: No license field
warning package-lock.json found. Your project contains lock files generated by tools other than Yarn. It is advised not to mix package managers in order to avoid resolution inconsistencies caused by unsynchronized lock files. To clear this warning, remove package-lock.json.
[1/4] ğŸ”  Resolving packages...
[2/4] ğŸšš  Fetching packages...
[3/4] ğŸ”—  Linking dependencies...
[4/4] ğŸ”¨  Building fresh packages...

success Installed "create-umi@4.0.32" with binaries:
      - create-umi
[#####################################################################] 254/254?
âœ” Pick Umi App Template â€º Ant Design Pro
âœ” Pick Npm Client â€º yarn
âœ” Pick Npm Registry â€º taobao
...
```

3. ç´§æ¥ç€

```base
npx umi g jest

info  - [ä½ çŸ¥é“å—ï¼Ÿ] umi g tsconfig å¯ä¸€é”®å®Œæˆé¡¹ç›®çš„ TypeScript é…ç½®ã€‚
âœ” Will you use @testing-library/react for UI testing?! â€¦ yes
info  - Update package.json for devDependencies
info  - Update package.json for scripts
info  - Write jest-setup.ts
info  - Write jest.config.ts
yarn install v1.22.10
```

æ·»åŠ  jest æµ‹è¯•

4. æ‰§è¡Œæµ‹è¯•å‘½ä»¤ï¼ŒæŠ¥é”™

**Expected behavior**

1. å¯ä»¥æ­£å¸¸è¿è¡Œ æµ‹è¯•

<!-- è¯·æä¾›å¤ç°é“¾æ¥/æ­¥éª¤ï¼Œé”™è¯¯æ—¥å¿—ä»¥åŠç›¸å…³é…ç½® -->

## Context

- **Umi Version**: "@umijs/max": "^4.0.32",
- **Node Version**: v16.18.1
- **Platform**: mac

## fz6m

max é¡¹ç›®ä½¿ç”¨å¾®ç”Ÿæˆå™¨æ—¶ï¼Œéœ€è¦ä½¿ç”¨ `max g *` ï¼Œæ•…éœ€è¦åšå¦‚ä¸‹è°ƒæ•´ï¼š

```diff
// jest.config.ts
-import { Config, configUmiAlias, createConfig } from 'umi/test';
+import { Config, configUmiAlias, createConfig } from '@umijs/max/test';
```

## Yyunfan

@fz6m æ”¹æˆmax/test ä¹Ÿè¿˜æ˜¯ä¼šæŠ¥ Error: Jest: Failed to parse the TypeScript config file

## fz6m

å¦‚æœ‰é—®é¢˜ï¼Œéœ€è¦ç»™ä¸€ä¸ªæœ€å°å¤ç°ã€‚
