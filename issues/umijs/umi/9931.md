# [Bug] build error（Transform failed with 1 error( Terser plugin )）

<!--
感谢您向我们反馈问题，为了高效的解决问题，我们期望你能提供以下信息：
-->

## What happens?

build app error. the error log is:
umi.js:250294:1: ERROR: Transforming async generator functions to the configured target environment ("chrome80", "es2015") is not supported yet
Error: Transform failed with 1 error:
umi.js:250294:1: ERROR: Transforming async generator functions to the configured target environment ("chrome80", "es2015") is not supported yet
at failureErrorWithLog (E:\workspaces\max-cesium-platform\node_modules\esbuild\lib\main.js:1566:15)
at E:\workspaces\max-cesium-platform\node_modules\esbuild\lib\main.js:805:29
at responseCallbacks.<computed> (E:\workspaces\max-cesium-platform\node_modules\esbuild\lib\main.js:671:9)
at handleIncomingPacket (E:\workspaces\max-cesium-platform\node_modules\esbuild\lib\main.js:726:9)
at Socket.readFromStdout (E:\workspaces\max-cesium-platform\node_modules\esbuild\lib\main.js:647:7)
at Socket.emit (node:events:513:28)
at addChunk (node:internal/streams/readable:315:12)
at readableAddChunk (node:internal/streams/readable:289:9)
at Socket.Readable.push (node:internal/streams/readable:228:10)
at Pipe.onStreamRead (node:internal/stream_base_commons:190:23)

<!-- A clear and concise description of what the bug is. -->
<!-- 清晰的描述下遇到的问题。-->

`umi.js:250294:1: ERROR: Transforming async generator functions to the configured target environment ("chrome80", "es2015") is not supported yet
Error: Transform failed with 1 error:
umi.js:250294:1: ERROR: Transforming async generator functions to the configured target environment ("chrome80", "es2015") is not supported yet
    at failureErrorWithLog (E:\workspaces\max-cesium-platform\node_modules\esbuild\lib\main.js:1566:15)
    at E:\workspaces\max-cesium-platform\node_modules\esbuild\lib\main.js:805:29
    at responseCallbacks.<computed> (E:\workspaces\max-cesium-platform\node_modules\esbuild\lib\main.js:671:9)
    at handleIncomingPacket (E:\workspaces\max-cesium-platform\node_modules\esbuild\lib\main.js:726:9)
    at Socket.readFromStdout (E:\workspaces\max-cesium-platform\node_modules\esbuild\lib\main.js:647:7)
    at Socket.emit (node:events:513:28)
    at addChunk (node:internal/streams/readable:315:12)
    at readableAddChunk (node:internal/streams/readable:289:9)
    at Socket.Readable.push (node:internal/streams/readable:228:10)
    at Pipe.onStreamRead (node:internal/stream_base_commons:190:23)`

## Mini Showcase Repository(REQUIRED)

> Please provide a [minimal reproduction](https://stackoverflow.com/help/minimal-reproducible-example) then upload to your GitHub. 请提供 [最小重现](https://stackoverflow.com/help/minimal-reproducible-example)，并上传到你的 GitHub 仓库

<!-- 为节约大家的时间，无复现步骤的 ISSUE 会被关闭，提供之后再 REOPEN -->
<!-- YOUR_REPOSITORY_URL on github or stackbliz -->

## How To Reproduce

**Steps to reproduce the behavior:** 1. 2.

**Expected behavior** 1. 2.

<!-- 请提供复现链接/步骤，错误日志以及相关配置 -->

## Context

- **Umi Version**:
- **Node Version**:
- **Platform**:

## fz6m

Transforming async generator functions to the configured target environment ("chrome80", "es2015")

## KrishnaPG

Getting the same error even with chrome 108. How to configure it to use `esNext` and not `es2015`? It seems to have been hardcoded in the code https://github.com/umijs/umi/blob/c2326c104141c00ca99db0a6d60d70069323550d/packages/bundler-webpack/src/config/compressPlugin.ts#L39-L41

## fz6m

```ts
// .umirc.ts

export default {
  jsMinifier: "terser", // or 'swc'
};
```

FYI ：

- https://umijs.org/docs/api/config#jsminifier-webpack

## fz6m

We don't know what code throw the error

Please provide a [minimal reproduction](https://stackoverflow.com/help/minimal-reproducible-example) then upload to your GitHub.

## stormslowly

@enzozyx @KrishnaPG

could you plz try these steps to identify which npm package cause the build problem。

use this config

```
  jsMinifier: 'esbuild',
  codeSplitting: {
    jsStrategy: 'depPerChunk',  // remember to delete it after  debug
  },
```

then run the build `npx umi build`

the problematic package name will appear in the error log.

the last step is to add the package to `extraBabelIncludes`, eg:

```
     extraBabelIncludes: ["@zip.js/zip.js"],  <-- replace with the problematic npm package name
```

try build again, see if it works

## choi2k

I am using ant design pro and getting the same error with `nats.ws` package.

minimal reproduction.
https://github.com/choi2k/umi-build-error

@fz6m @stormslowly not sure whether this minimal reproduction help or not. I init this repo by

1. create the project using cli commnet `pro create test-ant`
2. add `nat.ws` to the project.
3. import the package

```js
import { connect } from 'nats.ws';

....
connecT()
```

## fz6m

See https://umijs.org/blog/legacy-browser 。

You can try ：

```ts
// .umirc.ts

export default {
  jsMinifier: "terser",
  cssMinifier: "cssnano",
};
```

## choi2k

>

it works. Thanks. (y)
